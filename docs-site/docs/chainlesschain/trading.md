# 交易辅助

ChainlessChain 的去中心化交易辅助功能，让你无需依赖第三方平台，也能安全地进行交易。

## 核心特性

- 🤖 **AI智能匹配**: 自动匹配买卖双方需求
- 📝 **智能合约托管**: 区块链保障交易安全
- ⭐ **去中心化信誉**: 链上评价，防作弊
- ⚖️ **社区仲裁**: 公平解决交易纠纷
- 🔒 **隐私保护**: 必要信息才公开

## 发布交易需求

### 交易类型

支持多种交易类型：

1. **商品买卖**: 实物商品交易
2. **服务交易**: 技能服务交换
3. **租赁**: 物品/房屋租赁
4. **合作**: 项目合作、技能交换

### 发布商品

```
1. 点击"发布交易"
2. 选择"出售商品"
3. 填写商品信息:
   - 标题（必填）
   - 描述（AI可帮助优化）
   - 价格
   - 交付方式
   - 图片（最多9张）
4. 发布
```

### AI辅助撰写

让AI帮你优化商品描述：

```
原始输入:
"MacBook Pro 16寸 用了2年 95新 卖掉"

AI优化后:
【标题】
MacBook Pro 16英寸 2021款 M1 Pro 16GB 512GB 95成新

【描述】
▪ 型号: MacBook Pro 16" 2021
▪ 处理器: Apple M1 Pro 10核CPU
▪ 内存: 16GB
▪ 存储: 512GB SSD
▪ 成色: 95成新，屏幕完美无划痕
▪ 配件: 原装充电器、原包装盒
▪ 保修: 官方保修剩余3个月

【价格建议】
根据市场行情，建议价格: ¥12,000 - ¥13,500

【注意事项】
- 支持当面验机
- 可提供购买发票
- 成都同城优先
```

### 定价建议

AI会根据历史交易数据给出定价建议：

```typescript
interface PriceSuggestion {
  suggestedMin: number    // 建议最低价
  suggestedMax: number    // 建议最高价
  averagePrice: number    // 平均成交价
  similarListings: []     // 相似商品
  confidence: number      // 建议可信度 0-1
}
```

## 需求匹配

### 浏览市场

```
[市场广场]
├─ 全部分类
│  ├─ 数码产品
│  ├─ 生活用品
│  ├─ 服务技能
│  └─ 其他
├─ 筛选条件
│  ├─ 价格区间
│  ├─ 地理位置
│  └─ 信誉评分
└─ 排序方式
   ├─ 最新发布
   ├─ 价格由低到高
   └─ AI推荐（个性化）
```

### AI智能推荐

系统会根据你的兴趣推荐相关商品：

```python
# 推荐算法
def recommend_listings(user_profile, query):
    # 1. 向量化用户查询
    query_embedding = embed(query)

    # 2. 检索相似商品
    similar_items = vector_search(query_embedding, top_k=50)

    # 3. 过滤：价格、位置、信誉
    filtered = filter(similar_items, user_preferences)

    # 4. AI重排序
    ranked = rerank(filtered, user_history)

    return ranked[:10]
```

### 搜索功能

强大的搜索功能：

```
搜索: "二手 MacBook M1 成都"

结果:
✓ 关键词匹配: MacBook, M1
✓ 地理位置: 成都
✓ 语义理解: 二手 → 成色 < 全新
```

## 交易流程

### 1. 意向沟通

```
买家发现感兴趣的商品
    ↓
点击"联系卖家"
    ↓
进入加密聊天（Signal协议）
    ↓
双方协商细节:
  - 价格
  - 交付方式
  - 验货条件
  - 售后服务
```

### 2. 创建合约

达成一致后，创建智能合约：

```
1. 选择合约模板:
   ○ 一手交钱一手交货（当面）
   ● 款到发货（邮寄）
   ○ 分期付款
   ○ 自定义合约

2. 填写合约条款:
   - 商品描述
   - 成交价格
   - 交付时间
   - 质量保证
   - 退换货政策

3. 双方审阅签名:
   买家签名: [U盾/SIMKey]
   卖家签名: [U盾/SIMKey]

4. 合约生效
```

### 3. 资金托管

#### 加密货币托管

```solidity
// 智能合约自动托管
contract EscrowContract {
    address buyer;
    address seller;
    uint256 amount;

    // 买家支付到合约
    function deposit() public payable {
        require(msg.sender == buyer);
        amount = msg.value;
    }

    // 买家确认收货，释放给卖家
    function release() public {
        require(msg.sender == buyer);
        payable(seller).transfer(amount);
    }

    // 发起争议，冻结资金
    function dispute() public {
        require(msg.sender == buyer || msg.sender == seller);
        // 进入仲裁流程
    }
}
```

#### 支持的加密货币

| 货币 | 链 | 手续费 | 到账时间 |
|------|-----|--------|----------|
| ETH | Ethereum | ~$5 | 1-5分钟 |
| USDT | Polygon | ~$0.01 | 10秒 |
| USDC | Polygon | ~$0.01 | 10秒 |
| BTC | Bitcoin | ~$1 | 10-60分钟 |

#### 法币托管（可选）

如果双方都信任某个第三方：

```
1. 选择受信任的托管服务
2. 买家转账到托管账户
3. 卖家发货
4. 买家确认后，托管方放款
```

### 4. 交付与验收

#### 物流跟踪

```
卖家上传发货凭证:
  - 快递单号
  - 包裹照片
  - 物流公司

系统自动追踪:
  - 查询物流状态
  - 异常自动提醒
  - 到货通知

买家验货:
  - 拍照记录
  - 测试功能
  - 确认无误后释放资金
```

#### 当面交易

```
1. 双方约定见面地点和时间
2. 见面验货
3. 买家扫码确认收货
4. 智能合约自动释放资金
5. 双方评价
```

### 5. 评价

交易完成后互相评价：

```
评价维度:
⭐ 商品描述相符度 (1-5星)
⭐ 卖家服务态度 (1-5星)
⭐ 物流速度 (1-5星)
⭐ 包装质量 (1-5星)

文字评价: (可选)
标签: #靠谱 #快速 #如实描述
```

评价会记录在区块链上，不可篡改。

## 风险控制

### AI风险评估

每笔交易前，AI会评估风险：

```typescript
interface RiskAssessment {
  riskLevel: 'low' | 'medium' | 'high'
  riskScore: number  // 0-1
  factors: string[]  // 风险因素
  recommendations: string[]  // 建议
}

// 示例
{
  riskLevel: 'medium',
  riskScore: 0.45,
  factors: [
    '对方信誉评分较低 (3.2/5.0)',
    '账号注册时间较短 (15天)',
    '交易金额较大 (¥8,500)'
  ],
  recommendations: [
    '建议选择当面交易',
    '建议使用加密货币托管',
    '建议要求提供更多商品照片',
    '可以要求对方先发货'
  ]
}
```

### 信誉系统

用户信誉由多个维度计算：

```python
def calculate_reputation(user):
    score = 0

    # 1. 交易历史 (40%)
    score += 0.4 * (
        user.completed_transactions / max(user.total_transactions, 1)
    )

    # 2. 评价得分 (30%)
    score += 0.3 * (user.average_rating / 5.0)

    # 3. 账号年龄 (10%)
    score += 0.1 * min(user.account_age_days / 365, 1)

    # 4. 社交信任 (10%)
    score += 0.1 * user.social_trust_score

    # 5. 争议记录 (10% 负向)
    score -= 0.1 * (user.dispute_count / max(user.total_transactions, 1))

    return max(0, min(1, score))  # 限制在 0-1
```

### 欺诈检测

AI实时监测可疑行为：

```
⚠️ 异常检测:
- 短时间内大量发布商品
- 价格明显低于市场价
- 描述中包含可疑关键词
- 要求私下交易（跳过托管）
- 催促快速付款

→ 自动降低推荐优先级
→ 添加风险提示
→ 严重者暂停交易权限
```

## 争议解决

### 发起争议

如果交易出现问题：

```
1. 点击订单详情
2. 点击"发起争议"
3. 选择争议原因:
   ○ 未收到货
   ● 货不对板
   ○ 商品损坏
   ○ 其他

4. 上传证据:
   - 聊天记录
   - 商品照片
   - 物流信息
   - 其他凭证

5. 提交
```

### 仲裁流程

```
争议提交
    ↓
系统冻结托管资金
    ↓
从仲裁员池随机选择 3 名仲裁员
    ↓
双方各有 1 次挑战权（更换仲裁员）
    ↓
仲裁员查看证据
    ├─ 聊天记录
    ├─ 交易合约
    ├─ 照片视频
    └─ AI分析报告
    ↓
仲裁员独立投票
    ├─ 支持买家: 全额退款
    ├─ 支持卖家: 款项释放
    └─ 折中方案: 部分退款
    ↓
按多数票执行判决
    ↓
智能合约自动分配资金
    ↓
败诉方信誉扣分
```

### 仲裁员

任何人都可以申请成为仲裁员：

```
要求:
✓ 账号注册满 90 天
✓ 完成至少 10 笔交易
✓ 信誉评分 ≥ 4.5
✓ 无争议败诉记录
✓ 质押一定金额（防止恶意仲裁）

收益:
✓ 每次仲裁获得仲裁费（从败诉方扣除）
✓ 提升社区地位
✓ 解锁高级功能

责任:
✗ 公正仲裁，不得偏袒
✗ 仲裁错误会扣除质押金
✗ 恶意仲裁永久禁止
```

### AI辅助仲裁

AI会为仲裁员提供参考：

```markdown
## AI分析报告

### 案件基本信息
- 交易金额: ¥1,200
- 争议类型: 货不对板
- 买家信誉: 4.8/5.0 (98笔交易)
- 卖家信誉: 3.2/5.0 (12笔交易)

### 证据分析
✓ 买家提供了 5 张商品照片
✓ 卖家提供了发货前照片
✗ 两组照片中的序列号不一致 ← 关键证据

### 相似案例
找到 3 个相似判例:
1. 案例#1234: 支持买家，全额退款
2. 案例#5678: 支持买家，部分退款 (70%)
3. 案例#9012: 支持卖家

### 建议判决
建议支持买家，理由:
- 序列号不符是有力证据
- 卖家信誉较低
- 相似案例多数支持买家

置信度: 78%
```

## 交易类型

### 商品交易

#### 二手商品

```
适用场景:
- 电子产品
- 图书
- 家具
- 衣物
- 其他

注意事项:
✓ 提供详细照片
✓ 说明使用时长和成色
✓ 标注所有瑕疵
✓ 保留原始发票（如有）
```

#### 全新商品

```
适用场景:
- 代购
- 批发
- 闲置全新商品

注意事项:
✓ 提供正品凭证
✓ 支持验货
✓ 承诺售后
```

### 服务交易

#### 技能服务

```
类型:
- 编程开发
- 设计创作
- 文案写作
- 翻译服务
- 咨询顾问
- 教学培训

计价方式:
○ 按小时计费
○ 按项目计费
● 阶段性付款（推荐）
```

#### 里程碑付款

```
示例: 网站开发项目，总价 ¥10,000

里程碑 1: 需求确认 (20%)
  ├─ 交付物: 需求文档
  └─ 付款: ¥2,000

里程碑 2: 设计稿 (30%)
  ├─ 交付物: UI设计图
  └─ 付款: ¥3,000

里程碑 3: 开发完成 (40%)
  ├─ 交付物: 可运行的网站
  └─ 付款: ¥4,000

里程碑 4: 验收通过 (10%)
  ├─ 交付物: 最终版本 + 文档
  └─ 付款: ¥1,000
```

### 租赁交易

```
适用场景:
- 房屋租赁
- 设备租赁
- 车辆租赁

智能合约设置:
- 押金托管
- 按月自动扣费
- 到期自动退还押金
- 损坏扣除押金
```

### 合作交易

```
适用场景:
- 技能交换
- 项目合作
- 资源共享

无货币交易:
- 基于信任
- 记录贡献值
- 互相评价
```

## 统计和分析

### 我的交易

```
[交易统计]
总交易额: ¥45,230
交易次数: 27 笔
  ├─ 买入: 15 笔
  └─ 卖出: 12 笔

成交率: 68%
平均评分: 4.9 ⭐
信誉等级: 金牌卖家 🏅

[月度趋势]
(图表显示每月交易额和数量)
```

### 市场分析

```
[热门分类]
1. 数码产品 (32%)
2. 生活用品 (24%)
3. 服务技能 (18%)
4. 图书文具 (12%)
5. 其他 (14%)

[价格分布]
0-100元: 45%
100-500元: 30%
500-2000元: 18%
2000元以上: 7%
```

## 最佳实践

### 卖家指南

1. ✅ **详细描述**: 越详细越能吸引买家
2. ✅ **清晰照片**: 多角度拍摄，包含细节和瑕疵
3. ✅ **合理定价**: 参考AI建议和市场行情
4. ✅ **快速响应**: 及时回复买家咨询
5. ✅ **诚信为本**: 如实描述，不夸大不隐瞒

### 买家指南

1. ✅ **仔细阅读**: 认真阅读商品描述和图片
2. ✅ **查看信誉**: 优先选择高信誉卖家
3. ✅ **多问多看**: 主动询问不清楚的地方
4. ✅ **保留证据**: 聊天记录、照片、视频
5. ✅ **及时评价**: 收货后及时评价，帮助其他买家

### 安全建议

1. ✅ **使用托管**: 不要私下交易跳过托管
2. ✅ **当面验货**: 贵重物品优先选择当面交易
3. ✅ **保护隐私**: 不要泄露过多个人信息
4. ✅ **警惕欺诈**: 遇到可疑情况及时举报
5. ✅ **备份证据**: 重要交易保存完整证据链

## 常见问题

### 如何提高信誉?

```
方法:
1. 完成更多交易
2. 提供优质服务获得好评
3. 获得好友的信任背书
4. 参与社区建设（如成为仲裁员）
5. 避免争议和投诉
```

### 交易费用是多少?

```
平台费用: 0% (完全免费)

实际成本:
- 区块链Gas费 (~$0.01-$5，取决于网络)
- 仲裁费 (仅争议时收取，从败诉方扣除)

示例:
  交易金额: ¥1,000
  使用 Polygon USDT
  Gas费: ~$0.01 (¥0.07)
  实际成本: < 0.01%
```

### 支持哪些支付方式?

```
✓ 加密货币 (ETH, USDT, USDC, BTC)
✓ 当面现金
✓ 第三方托管 (自选)
✗ 直接银行转账 (不推荐，无托管保护)
```

### 如何防止买家恶意退货?

```
建议:
1. 在合约中明确退货条件
2. 要求买家提供退货原因和证据
3. 使用智能合约限制退货期限
4. 收到退货后检查商品状态
5. 如有争议提交仲裁
```

## 未来功能

- [ ] 拍卖功能
- [ ] 团购/拼单
- [ ] 分期付款支持
- [ ] 信用借贷（基于信誉）
- [ ] 保险服务
- [ ] 更多支付方式（闪电网络、稳定币）
