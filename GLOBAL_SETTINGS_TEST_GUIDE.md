# 全局设置向导功能测试指南

**测试日期**: 2025-12-31
**测试人员**: [待填写]
**应用版本**: v0.16.0

---

## 🎯 测试目标

验证全局设置向导的所有功能是否正常工作,包括:
- 首次启动流程
- 配置导入导出
- 路径迁移
- 企业版服务器连接测试
- 边界情况处理

---

## 📋 测试前准备

### 1. 备份现有数据

**重要**: 测试前请备份以下文件/文件夹:

```bash
# 备份配置文件
copy "%USERPROFILE%\AppData\Roaming\chainlesschain-desktop-vue\*.json" backup\

# 备份数据库
copy "C:\code\chainlesschain\data\*.db" backup\
```

### 2. 重置初始设置状态

为了测试首次启动流程,需要删除初始设置配置文件:

```bash
# 删除初始设置配置
del "%USERPROFILE%\AppData\Roaming\chainlesschain-desktop-vue\initial-setup-config.json"
```

---

## ✅ 功能测试清单

### 测试1: 首次启动显示全局设置向导

**前置条件**:
- 已删除 `initial-setup-config.json`
- 应用已重启

**测试步骤**:
1. ✅ 启动应用
2. ✅ 验证: 应该自动显示"欢迎使用ChainlessChain"向导
3. ✅ 验证: 无法跳过或关闭向导(没有×按钮)
4. ✅ 验证: 显示6步进度条(欢迎→版本选择→项目路径→数据库路径→LLM配置→完成)

**预期结果**:
- [ ] 向导自动弹出
- [ ] 无法关闭向导
- [ ] 步骤指示器正常显示

**实际结果**:
```
[待填写测试结果]
```

---

### 测试2: 版本选择步骤

**测试步骤**:
1. ✅ 点击"下一步"进入版本选择
2. ✅ 验证: 显示"个人版"和"企业版"两个选项
3. ✅ 选择"个人版"
4. ✅ 验证: 不显示企业版配置字段
5. ✅ 返回并选择"企业版"
6. ✅ 验证: 显示服务器URL、API密钥、租户ID字段
7. ✅ 点击"测试连接"按钮(先不填写)
8. ✅ 验证: 按钮禁用(需要先填写所有字段)

**预期结果**:
- [ ] 版本切换正常
- [ ] 企业版字段显示/隐藏正常
- [ ] 测试连接按钮状态正确

**实际结果**:
```
[待填写测试结果]
```

---

### 测试3: 企业版服务器连接测试 - 成功场景

**前置条件**:
- 有可用的企业版服务器(或模拟服务器)

**测试步骤**:
1. ✅ 填写服务器URL: `http://localhost:9090` (或实际地址)
2. ✅ 填写API密钥: `test-api-key`
3. ✅ 填写租户ID: `tenant-001`
4. ✅ 点击"测试连接"
5. ✅ 验证: 显示加载状态
6. ✅ 验证: 显示绿色成功提示
7. ✅ 验证: 显示延迟时间(如: "延迟: 45ms")

**预期结果**:
- [ ] 连接测试成功
- [ ] 显示延迟时间
- [ ] UI反馈清晰

**实际结果**:
```
[待填写测试结果]
```

---

### 测试4: 企业版服务器连接测试 - 失败场景

**测试步骤**:

#### 4.1 超时测试
1. ✅ 填写不可达的服务器URL: `http://192.0.2.1:9999`
2. ✅ 点击"测试连接"
3. ✅ 验证: 10秒后显示超时错误
4. ✅ 验证: 显示红色错误提示"连接超时"
5. ✅ 验证: 显示排查建议列表

**预期结果**:
- [ ] 10秒后显示超时
- [ ] 错误提示清晰
- [ ] 排查建议有帮助

**实际结果**:
```
[待填写测试结果]
```

#### 4.2 认证失败测试
1. ✅ 填写正确的服务器URL
2. ✅ 填写错误的API密钥: `invalid-key`
3. ✅ 点击"测试连接"
4. ✅ 验证: 显示"认证失败"错误
5. ✅ 验证: 提示检查API密钥和租户ID

**预期结果**:
- [ ] 显示认证失败错误
- [ ] 错误提示准确

**实际结果**:
```
[待填写测试结果]
```

---

### 测试5: 路径选择步骤

**测试步骤**:
1. ✅ 点击"下一步"进入项目路径选择
2. ✅ 点击"选择文件夹"
3. ✅ 选择一个有效路径(如: `C:\Users\用户名\ChainlessChain\Projects`)
4. ✅ 验证: 路径显示在输入框中
5. ✅ 点击"下一步"进入数据库路径选择
6. ✅ 选择数据库路径
7. ✅ 点击"下一步"

**预期结果**:
- [ ] 文件夹选择对话框正常
- [ ] 路径正确显示
- [ ] 路径验证正常

**实际结果**:
```
[待填写测试结果]
```

---

### 测试6: LLM配置步骤

**测试步骤**:

#### 6.1 简化模式
1. ✅ 选择"简化配置"
2. ✅ 选择提供商: "Ollama (本地)"
3. ✅ 填写模型名称: `qwen2:7b`
4. ✅ 点击"下一步"

**预期结果**:
- [ ] 简化模式显示最少字段
- [ ] 配置保存正确

#### 6.2 高级模式
1. ✅ 返回上一步
2. ✅ 选择"高级配置"
3. ✅ 验证: 显示所有配置选项(服务器URL、温度、top_p等)
4. ✅ 修改温度: `0.8`
5. ✅ 修改最大令牌数: `4096`
6. ✅ 点击"下一步"

**预期结果**:
- [ ] 高级模式显示所有字段
- [ ] 参数验证正常
- [ ] 配置保存正确

**实际结果**:
```
[待填写测试结果]
```

---

### 测试7: 完成向导

**测试步骤**:
1. ✅ 查看配置摘要
2. ✅ 验证: 显示所有已配置的选项
3. ✅ 点击"完成"
4. ✅ 验证: 配置被应用
5. ✅ 验证: 进入下一个流程(加密设置或登录页面)

**预期结果**:
- [ ] 摘要信息完整
- [ ] 配置成功应用
- [ ] 流程衔接正常

**实际结果**:
```
[待填写测试结果]
```

---

### 测试8: 登录页面设置按钮

**前置条件**:
- 已完成初始设置向导
- 应用停留在登录页面

**测试步骤**:
1. ✅ 在登录页面右上角找到齿轮图标
2. ✅ 点击齿轮图标
3. ✅ 验证: 打开全局设置向导
4. ✅ 验证: 可以修改之前的配置
5. ✅ 修改一些设置并保存
6. ✅ 验证: 配置更新成功

**预期结果**:
- [ ] 设置按钮可见
- [ ] 点击后打开向导
- [ ] 可以修改配置

**实际结果**:
```
[待填写测试结果]
```

---

### 测试9: 托盘菜单全局设置入口

**前置条件**:
- 应用正在运行

**测试步骤**:
1. ✅ 在Windows系统托盘找到ChainlessChain图标
2. ✅ 右键点击托盘图标
3. ✅ 验证: 菜单显示"全局设置"选项
4. ✅ 点击"全局设置"
5. ✅ 验证: 打开全局设置向导

**预期结果**:
- [ ] 托盘图标正常显示
- [ ] 菜单项存在
- [ ] 点击后打开向导

**实际结果**:
```
[待填写测试结果]
```

---

### 测试10: 配置导出功能

**测试步骤**:
1. ✅ 打开全局设置向导(通过任意入口)
2. ✅ 在某一步点击"导出配置"按钮
3. ✅ 验证: 打开文件保存对话框
4. ✅ 选择保存位置(如: `C:\Users\用户名\Downloads\chainlesschain-config.json`)
5. ✅ 点击保存
6. ✅ 验证: 显示成功提示
7. ✅ 打开保存的JSON文件
8. ✅ 验证: 文件内容完整
9. ✅ 验证: API密钥等敏感信息已被移除

**预期结果**:
- [ ] 导出对话框正常
- [ ] 文件保存成功
- [ ] 敏感信息已过滤
- [ ] JSON格式正确

**实际结果**:
```
[待填写测试结果]
```

---

### 测试11: 配置导入功能

**前置条件**:
- 已有导出的配置文件

**测试步骤**:
1. ✅ 打开全局设置向导
2. ✅ 点击"导入配置"按钮
3. ✅ 选择之前导出的配置文件
4. ✅ 验证: 显示成功提示
5. ✅ 验证: 各步骤的配置已自动填充
6. ✅ 检查: 版本选择、路径、LLM配置等

**预期结果**:
- [ ] 导入对话框正常
- [ ] 配置正确导入
- [ ] 字段自动填充

**实际结果**:
```
[待填写测试结果]
```

---

### 测试12: 路径迁移向导

**测试步骤**:
1. ✅ 进入系统设置页面
2. ✅ 找到"路径迁移向导"入口
3. ✅ 点击打开迁移向导
4. ✅ 选择迁移类型: "项目文件迁移"
5. ✅ 设置新的项目路径
6. ✅ 点击"下一步"查看确认页
7. ✅ 验证: 显示迁移警告和建议
8. ✅ 点击"开始迁移"
9. ✅ 验证: 显示迁移进度
10. ✅ 验证: 迁移完成后提示重启

**预期结果**:
- [ ] 向导流程清晰
- [ ] 警告提示明显
- [ ] 进度显示准确
- [ ] 迁移成功

**实际结果**:
```
[待填写测试结果]
```

---

## 🔥 边界情况测试

### 测试13: 导入无效JSON文件

**测试步骤**:
1. ✅ 创建一个无效的JSON文件(格式错误)
2. ✅ 尝试导入该文件
3. ✅ 验证: 显示错误提示"配置文件格式无效"
4. ✅ 验证: 不会覆盖现有配置

**预期结果**:
- [ ] 错误处理正确
- [ ] 不影响现有配置

**实际结果**:
```
[待填写测试结果]
```

---

### 测试14: 迁移到无权限路径

**测试步骤**:
1. ✅ 打开路径迁移向导
2. ✅ 选择系统保护路径(如: `C:\Windows\System32`)
3. ✅ 尝试迁移
4. ✅ 验证: 显示权限错误
5. ✅ 验证: 迁移未执行

**预期结果**:
- [ ] 路径验证正确
- [ ] 错误提示清晰
- [ ] 数据安全

**实际结果**:
```
[待填写测试结果]
```

---

### 测试15: 取消操作

**测试步骤**:
1. ✅ 开始导出配置
2. ✅ 在文件保存对话框点击"取消"
3. ✅ 验证: 操作正常取消,无错误
4. ✅ 开始导入配置
5. ✅ 在文件选择对话框点击"取消"
6. ✅ 验证: 操作正常取消,无错误

**预期结果**:
- [ ] 取消操作正常
- [ ] 无异常或错误

**实际结果**:
```
[待填写测试结果]
```

---

## 📊 测试结果统计

### 功能测试

| 测试项 | 状态 | 备注 |
|-------|------|------|
| 首次启动向导 | ⬜ 待测试 | |
| 版本选择 | ⬜ 待测试 | |
| 企业版连接测试(成功) | ⬜ 待测试 | |
| 企业版连接测试(失败) | ⬜ 待测试 | |
| 路径选择 | ⬜ 待测试 | |
| LLM配置 | ⬜ 待测试 | |
| 完成向导 | ⬜ 待测试 | |
| 登录页设置按钮 | ⬜ 待测试 | |
| 托盘菜单入口 | ⬜ 待测试 | |
| 配置导出 | ⬜ 待测试 | |
| 配置导入 | ⬜ 待测试 | |
| 路径迁移向导 | ⬜ 待测试 | |

### 边界测试

| 测试项 | 状态 | 备注 |
|-------|------|------|
| 无效JSON导入 | ⬜ 待测试 | |
| 无权限路径迁移 | ⬜ 待测试 | |
| 取消操作 | ⬜ 待测试 | |

### 总体统计

- **总测试项**: 15
- **通过**: 0
- **失败**: 0
- **待测试**: 15
- **通过率**: 0%

---

## 🐛 发现的问题

### 问题列表

| 问题ID | 严重程度 | 问题描述 | 复现步骤 | 状态 |
|--------|---------|---------|---------|------|
| [示例] BUG-001 | 高 | [问题描述] | [复现步骤] | 待修复 |

---

## 📝 测试备注

### 测试环境

- **操作系统**: Windows 11
- **Node.js版本**: v23.11.1
- **Electron版本**: 39.2.6
- **应用版本**: v0.16.0

### 测试建议

1. 测试前请仔细阅读每个测试步骤
2. 如发现问题,请详细记录复现步骤
3. 截图保存关键操作和错误提示
4. 测试完成后更新测试结果统计

---

**测试完成日期**: [待填写]
**测试人员签名**: [待填写]
