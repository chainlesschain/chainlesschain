# 🎯 ChainlessChain v0.26.2 最终测试指南

**应用状态**: ✅ 运行中
**Vite服务器**: ✅ http://127.0.0.1:5173
**完成时间**: 2026-01-26 15:24

---

## 🚀 立即开始测试（5分钟快速验证）

### 方法1: 自动化脚本测试（推荐⭐）

在**应用内**打开开发工具（按 F12），在 Console 中粘贴并运行：

```javascript
// 自动测试所有14个菜单页面（每3秒切换一次）
const routes = [
  '/llm/performance',        // 1. LLM性能监控
  '/database/performance',   // 2. 数据库性能监控
  '/error/monitor',          // 3. 错误监控
  '/sessions',               // 4. 会话管理
  '/memory',                 // 5. 内存仪表板
  '/tags',                   // 6. 标签管理
  '/settings?tab=mcp',       // 7. MCP服务器
  '/settings?tab=token-usage', // 8. Token使用统计
  '/p2p/device-pairing',     // 9. 设备配对
  '/p2p/device-management',  // 10. 设备管理
  '/p2p/file-transfer',      // 11. 文件传输
  '/p2p/safety-numbers',     // 12. 安全号码验证
  '/p2p/session-fingerprint', // 13. 会话指纹
  '/p2p/message-queue'       // 14. 消息队列
];

let index = 0;
const testRoute = () => {
  if (index >= routes.length) {
    console.log('%c✅ 测试完成！所有14个页面已遍历', 'color: #52c41a; font-size: 16px; font-weight: bold;');
    return;
  }
  console.log(`%c[${index + 1}/14] 正在测试: ${routes[index]}`, 'color: #1890ff; font-size: 14px;');
  window.location.hash = '#' + routes[index];
  index++;
  setTimeout(testRoute, 3000);
};

console.log('%c🚀 开始自动测试菜单集成...', 'color: #722ed1; font-size: 16px; font-weight: bold;');
testRoute();
```

**观察要点**:
- ✅ 每个页面能正常加载（不是白屏）
- ✅ 页面标题和图标正确
- ✅ 页面布局完整（数据为空是正常的）
- ✅ Console 无严重错误（红色error）

---

### 方法2: 手动点击验证

#### 第一组：监控与诊断（6项）

1. 打开应用，确保已登录
2. 点击左侧菜单 **"系统设置"**
3. 找到 **"监控与诊断"** 组
4. 逐个点击测试：
   - [ ] LLM性能监控 （带"新"标签）
   - [ ] 数据库性能监控
   - [ ] 错误监控 （带"AI"标签）
   - [ ] 会话管理 （带"新"标签）
   - [ ] 内存仪表板
   - [ ] 标签管理

#### 第二组：MCP和AI配置（2项）

1. 点击左侧菜单 **"系统设置"**
2. 找到 **"AI配置"** 组
3. 逐个点击测试：
   - [ ] MCP服务器 → 应跳转到设置页的MCP标签
   - [ ] Token使用统计 → 应跳转到设置页的Token标签

#### 第三组：P2P高级功能（6项）

1. 点击左侧菜单 **"社交网络"**
2. **展开子菜单**
3. 逐个点击测试：
   - [ ] 设备配对
   - [ ] 设备管理
   - [ ] 文件传输
   - [ ] 安全号码验证
   - [ ] 会话指纹
   - [ ] 消息队列

---

## 🔧 测试 MCP 服务器修复（关键功能）

### 测试步骤

**1. 访问 MCP 设置页面**

在应用中访问（选择其一）：
- 点击：系统设置 → AI配置 → MCP服务器
- 或在浏览器地址栏输入：`http://127.0.0.1:5173/#/settings?tab=mcp`

**2. 启用 MCP 系统**

- 找到"启用MCP系统"开关
- 将开关切换为 **ON**

**3. 验证重启提示（核心改进⭐）**

应该立即看到：

```
┌─────────────────────────────────────────────┐
│  ℹ️  ✨ MCP系统已启用                        │
│                                             │
│  请重启应用以加载 MCP 服务器功能。          │
│  重启后即可连接和使用 MCP 服务器。          │
│                                             │
│  [🔄 立即重启应用]  [稍后重启]              │
└─────────────────────────────────────────────┘
```

✅ **验证点**:
- [ ] 蓝色警告框显示明显
- [ ] 包含"立即重启应用"按钮
- [ ] 可以点击右上角 X 关闭提示

**4. 点击"立即重启应用"**

- 点击**"🔄 立即重启应用"**按钮
- 应用应该自动关闭
- 应用应该自动重新打开

**5. 重新访问 MCP 页面**

重启完成后：
- 重新打开应用
- 再次访问 MCP 设置页面
- 确认"启用MCP系统"开关仍然是 ON

**6. 连接 MCP 服务器**

- 在服务器列表中找到 **"filesystem"** 服务器
- 点击**"连接"**按钮（不应该是灰色禁用状态）
- 等待连接完成（5-10秒）

**7. 验证连接成功**

✅ **成功标志**:
- 服务器状态变为**"✓ 已连接"**（绿色）
- 工具列显示数字，如**"5 个工具"**
- 点击**"工具"**按钮可以查看工具列表

---

## 📊 测试结果记录

### 菜单集成测试

```
监控与诊断（6项）:
□ LLM性能监控         - 状态: ___  备注: ___
□ 数据库性能监控       - 状态: ___  备注: ___
□ 错误监控            - 状态: ___  备注: ___
□ 会话管理            - 状态: ___  备注: ___
□ 内存仪表板          - 状态: ___  备注: ___
□ 标签管理            - 状态: ___  备注: ___

MCP和AI配置（2项）:
□ MCP服务器           - 状态: ___  备注: ___
□ Token使用统计       - 状态: ___  备注: ___

P2P高级功能（6项）:
□ 设备配对            - 状态: ___  备注: ___
□ 设备管理            - 状态: ___  备注: ___
□ 文件传输            - 状态: ___  备注: ___
□ 安全号码验证        - 状态: ___  备注: ___
□ 会话指纹            - 状态: ___  备注: ___
□ 消息队列            - 状态: ___  备注: ___

成功数量: ___/14
```

### MCP服务修复测试

```
□ MCP启用开关工作     - 状态: ___
□ 重启提示框显示      - 状态: ___
□ 立即重启按钮工作    - 状态: ___
□ 应用成功重启        - 状态: ___
□ 重启后配置保留      - 状态: ___
□ 可以连接服务器      - 状态: ___
□ 服务器显示已连接    - 状态: ___

成功数量: ___/7
```

---

## 🐛 常见问题处理

### 问题1: 页面显示空白

**可能原因**: 组件加载失败
**解决方法**:
1. 按 F12 打开开发工具
2. 查看 Console 标签是否有红色错误
3. 按 Ctrl+R 刷新页面
4. 如果问题持续，在 Console 执行: `window.location.reload()`

### 问题2: "立即重启应用"按钮无响应

**可能原因**: IPC 通道未注册
**解决方法**:
1. 打开 DevTools Console
2. 执行测试命令: `await window.electronAPI.invoke('system:restart')`
3. 如果报错 "No handler"，手动重启应用

### 问题3: 重启后仍无法连接MCP服务器

**可能原因**: 配置未保存
**解决方法**:
1. 在 Console 执行: `await window.electronAPI.invoke('mcp:get-config')`
2. 确认返回的 config.enabled 为 true
3. 如果是 false，重新启用并确保看到成功提示

### 问题4: 菜单项找不到

**可能原因**: 菜单未展开
**解决方法**:
- 监控与诊断：需要先点击"系统设置"才能看到
- P2P功能：需要先点击"社交网络"并**展开**子菜单

---

## 📸 截图参考

### MCP重启提示（预期效果）

应该看到类似这样的提示框：

```
╭──────────────────────────────────────────────╮
│ ℹ️  ✨ MCP系统已启用                    ✖️ │
├──────────────────────────────────────────────┤
│                                              │
│  请重启应用以加载 MCP 服务器功能。           │
│  重启后即可连接和使用 MCP 服务器。           │
│                                              │
│  ┌──────────────────┐  ┌──────────┐        │
│  │ 🔄 立即重启应用  │  │ 稍后重启 │        │
│  └──────────────────┘  └──────────┘        │
│                                              │
╰──────────────────────────────────────────────╯
```

### 菜单位置参考

**监控与诊断**:
```
左侧菜单
├── 🏠 首页
├── 📊 项目
├── 📚 知识库
├── 💬 AI对话
├── ⚙️ 系统设置 ← 点击展开
│   ├── 基本设置
│   ├── 📊 监控与诊断 ← 新增组
│   │   ├── 📈 LLM性能监控 🆕
│   │   ├── 💾 数据库性能监控
│   │   ├── 🐛 错误监控 🤖
│   │   ├── 🕒 会话管理 🆕
│   │   ├── 🗄️ 内存仪表板
│   │   └── 🏷️ 标签管理
│   └── 🤖 AI配置
│       ├── ⚙️ MCP服务器 ← 新增
│       └── 📈 Token使用统计 ← 新增
```

**P2P功能**:
```
左侧菜单
├── 👥 社交网络 ← 点击展开
│   ├── P2P聊天
│   ├── 社交论坛
│   ├── 🔗 设备配对 ← 新增
│   ├── 📱 设备管理 ← 新增
│   ├── 📤 文件传输 ← 新增
│   ├── 🔑 安全号码验证 ← 新增
│   ├── 🔍 会话指纹 ← 新增
│   └── 📋 消息队列 ← 新增
```

---

## ✅ 通过标准

### 菜单集成

- ✅ **至少 13/14** 个菜单项可访问
- ✅ 所有页面能正常加载（不是白屏）
- ✅ 布局完整（数据为空是正常的）
- ⚠️ 允许 P2P 功能显示"需要配对设备"

### MCP服务修复

- ✅ 重启提示框明显可见
- ✅ "立即重启应用"按钮可点击
- ✅ 应用能成功重启
- ✅ 重启后可以连接服务器
- ✅ 服务器状态显示"已连接"

---

## 🎉 测试完成后

请将测试结果反馈给我，包括：

1. **成功访问的菜单数量**: ___/14
2. **MCP重启功能是否正常**: 是 / 否
3. **遇到的问题**（如有）: ___
4. **截图**（可选）: ___

---

## 📚 相关文档

- **完整报告**: `MENU_AND_MCP_INTEGRATION_COMPLETE.md`
- **MCP修复详情**: `MCP_SERVER_FIX.md`
- **验证清单**: `MENU_INTEGRATION_CHECKLIST.md`
- **测试工具**: `public/menu-test-helper.html`

---

## 🚀 快速命令

```bash
# 查看应用状态
curl http://127.0.0.1:5173 | head -5

# 运行诊断工具
cd desktop-app-vue
node scripts/test-routes.js

# 重新启动应用（如需要）
cd desktop-app-vue
npm run dev
```

---

**准备好了吗？现在就开始测试吧！** 🎯

⏱️ **预计时间**: 5-10分钟
🎁 **测试奖励**: 完整功能的 ChainlessChain v0.26.2！

---

**文档版本**: 1.0
**创建时间**: 2026-01-26 15:24
**应用版本**: ChainlessChain v0.26.2
