# ChainlessChain 功能详解

本文档详细介绍 ChainlessChain 的所有核心功能和特性。

## 目录

- [核心特性](#核心特性)
- [知识库管理](#知识库管理)
- [去中心化社交](#去中心化社交)
- [去中心化交易](#去中心化交易)
- [企业版功能](#企业版功能)
- [AI模板系统](#ai模板系统)
- [MCP集成](#mcp集成)
- [性能优化](#性能优化)

---

## 核心特性

### 🔐 军事级安全

**数据库加密**:

- SQLCipher AES-256 加密
- 50+ 张表完整加密
- 硬件级密钥保护

**硬件密钥支持**:

- U盾集成（Windows平台，5个品牌）
- SIMKey支持（移动端，规划中）
- 跨平台 PKCS#11 支持

**端到端加密**:

- Signal Protocol 实现
- 完整的 E2E 加密通信
- 密钥轮换机制

### 📊 统一日志系统 ⭐最新

**核心功能**:

- 集中式 logger 管理
- 日志级别控制（DEBUG/INFO/WARN/ERROR）
- 结构化日志输出
- 生产环境调试支持

**技术实现**:

- `logger-ipc.js` (120行) - IPC日志接口
- `logger.js` (245行) - 日志管理器
- 700+ console 调用迁移完成

**使用示例**:

```javascript
import { getLogger } from "./logger";
const logger = getLogger("MyModule");

logger.debug("Debug message");
logger.info("Info message");
logger.warn("Warning message");
logger.error("Error message", error);
```

### 🌐 完全去中心化

**P2P网络**:

- libp2p 3.1.2 协议栈
- Kademlia DHT 分布式哈希表
- mDNS 本地设备发现
- 无需中心服务器

**本地数据存储**:

- 所有数据本地加密存储
- 无云依赖
- 用户完全掌控数据

### 🧠 AI原生

**LLM支持**:

- 14+ 云LLM提供商
- Ollama 本地部署
- 自定义模型接入

**RAG增强检索**:

- ChromaDB/Qdrant 向量存储
- 混合搜索（向量+关键词+FTS5）
- 3种重排序算法
- 查询重写优化

### 📱 跨设备协作

**Git同步**:

- isomorphic-git 纯JS实现
- AI自动生成提交消息
- 可视化冲突解决

**移动端同步**:

- 桌面-移动端双向同步
- 群聊实时同步
- 增量同步机制
- 离线队列管理

---

## 知识库管理

### 数据库系统

**核心特性**:

- SQL.js + SQLCipher AES-256加密
- 50+ 张表（基础+企业版+区块链+优化）
- 软删除机制
- 自动保存
- 事务支持

**数据库同步**:

- SQLite ↔ PostgreSQL 双向同步
- 4个核心模块
- 冲突解决机制

### 知识图谱可视化 ⭐

**8个图分析算法**:

1. **PageRank** - Google网页排名算法
2. **度中心性** - 识别连接最多的节点
3. **接近中心性** - 识别距离其他节点最近的节点
4. **中介中心性** - 识别路径上最重要的节点
5. **Louvain社区检测** - 自动发现节点群组
6. **K-means聚类** - 基于特征的节点聚类
7. **关键节点识别** - 综合多指标找出重要节点
8. **图谱统计分析** - 计算密度、聚类系数等

**5种可视化方式**:

1. **2D可视化** - 力导向/环形/层级布局
   - LOD优化
   - 节点聚合
   - 渐进渲染

2. **3D可视化** - WebGL渲染
   - 自动旋转
   - 多视角切换

3. **时间轴可视化** - 时间序列展示
   - 按天/周/月/年分组

4. **热力图可视化**
   - 关系强度热力图
   - 活跃度热力图
   - 相似度热力图

5. **分析面板** - 综合分析工具
   - 中心性分析
   - 社区发现
   - 路径探索
   - 邻居探索

**智能实体提取**:

- 9种实体类型（人名、组织、地点、日期、时间、概念、技术、产品、事件）
- 8种关系类型（提及、相关、部分、因果、位于、工作于、创建者、使用）
- 基于规则 + LLM 双模式
- 关键词提取（TF-IDF）
- Wiki链接识别

**6种导出格式**:

- JSON - 标准数据交换格式
- GraphML - Gephi兼容格式
- GEXF - Gephi原生格式
- DOT - Graphviz格式
- CSV - Excel兼容（分别导出节点和边）
- HTML - 交互式网页，可直接分享

### AI增强检索（RAG）

**向量存储**:

- ChromaDB/Qdrant 支持
- 混合搜索（向量+关键词+FTS5全文索引）

**重排序算法**:

1. **LLM重排序** - 使用LLM重新排序结果
2. **CrossEncoder** - 交叉编码器重排序
3. **混合重排序** - 结合多种策略

**查询重写**:

1. **多查询生成** - 生成多个相关查询
2. **HyDE** - 假设文档嵌入
3. **逐步回溯** - 递进式查询优化

### 文件处理

**多格式导入**:

- Markdown
- PDF
- Word (DOCX)
- TXT
- 图片（支持OCR）

**OCR识别**:

- Tesseract.js 引擎
- 支持中英文
- 图片压缩和优化

**图片处理**:

- Sharp 压缩
- 缩略图生成
- 格式转换

### 专业编辑器

1. **Code Editor** - 代码编辑
2. **Markdown Editor** - Markdown编辑
3. **Excel Editor** - 表格编辑
4. **PPT Editor** - 演示文稿
5. **RichText Editor** - 富文本
6. **WebDev Editor** - Web开发

---

## 去中心化社交

### DID身份系统

**标准支持**:

- W3C DID Core 标准
- did:chainlesschain:<identifier> 格式
- 组织DID支持

**密钥对**:

- Ed25519 签名密钥对
- X25519 加密密钥对
- 多身份支持
- 助记词导出

### 可验证凭证（VC）

**5种凭证类型**:

1. **自我声明** - 个人信息声明
2. **技能证书** - 技能认证
3. **信任背书** - 第三方背书
4. **教育凭证** - 学历证明
5. **工作经历** - 工作证明

**功能特性**:

- W3C VC标准签名和验证
- 凭证生命周期管理
- 撤销机制

### P2P网络

**核心技术**:

- libp2p 3.1.2 节点管理
- TCP传输 + Noise加密
- Kademlia DHT
- mDNS本地发现

**Signal Protocol E2E加密**:

- 完整的端到端加密实现
- 密钥轮换
- 前向保密
- 后向保密

**WebRTC语音/视频通话** ⭐:

- 完整的语音通话实现
- 视频通话支持
- 屏幕共享（desktopCapturer集成）
- MediaStream桥接

### P2P文件传输 ⭐

**核心特性**:

- 64KB 分块传输
- 断点续传
- 实时进度跟踪
- SHA-256 完整性校验
- 并发传输控制（最多3个并发）
- 智能重试机制（最多3次）

**使用场景**:

- 聊天中发送/接收文件
- 知识库文件同步
- 项目文件协作

### 社交功能

**好友管理**:

- 好友请求/接受/拒绝
- 在线状态显示
- 好友分组
- 备注管理

**社交动态**:

- 发布动态
- 点赞和评论
- 动态分享
- 图片支持

**群聊功能**:

- 创建群聊
- 成员管理（添加/移除/角色管理）
- 端到端加密群消息
- 群设置（邀请权限/公告）
- @提及功能
- #话题标签

**语音消息系统** ⭐:

- 实时语音录制
- 暂停/恢复控制
- 时长显示（MM:SS格式）
- 音频波形可视化
- 播放/暂停控制
- 自动资源清理

---

## 去中心化交易

### 数字资产管理

**4种资产类型**:

1. **Token** - 代币资产
2. **NFT** - 非同质化代币
3. **知识产品** - 知识付费产品
4. **服务凭证** - 服务凭证

**核心功能**:

- 资产创建和铸造
- 资产转账（单笔/批量）
- 余额管理
- 转账历史
- NFT链上转账（ERC-721标准）

### 智能合约引擎

**5种合约类型**:

1. **简单交易** - 基础买卖合约
2. **订阅合约** - 周期性订阅
3. **悬赏合约** - 任务悬赏
4. **技能交换** - 技能互换
5. **自定义合约** - 自定义逻辑

**4种托管类型**:

1. **简单托管** - 基础托管
2. **多签托管** - 多方签名
3. **时间锁托管** - 时间锁定
4. **条件托管** - 条件触发

**高级特性**:

- 40+ 条件类型支持
- 串行/并行任务执行
- Webhook通知集成
- 多方签名
- 仲裁系统

### 交易分析引擎 ⭐

**核心功能**:

- 交易概览统计
- 盈亏分析（收入/支出/净利润/利润率）
- 资产表现分析
- 风险评估（集中度/流动性/交易对手风险）
- 市场趋势分析
- 智能投资建议

### 实时交易引擎 ⭐

**核心功能**:

- 订单簿管理（买单/卖单分离）
- 自动订单匹配（价格优先/时间优先）
- 多种订单类型（市价单/限价单/止损单/止损限价单）
- 实时价格源
- 订单管理（提交/取消/查询）
- 自动交易执行
- 智能重试机制

### 信用评分系统

**6维度评分**:

1. **完成率** - 订单完成比例
2. **交易量** - 总交易金额
3. **好评率** - 好评占比
4. **响应速度** - 平均响应时间
5. **纠纷率** - 纠纷发生率
6. **退款率** - 退款比例

**5级等级系统**:

- 新手 (0-199分)
- 青铜 (200-499分)
- 白银 (500-999分)
- 黄金 (1000-1999分)
- 钻石 (2000+分)

**等级权益**:

- 手续费折扣
- 优先展示
- VIP客服支持

### 评价系统

**功能特性**:

- 5星评分 + 文字评价
- 图片附件支持
- 双向评价（买家/卖家）
- 回复系统
- 有用/无用标记
- 举报滥用机制

---

## 企业版功能

### 知识库协作 ⭐完成

**实时协作编辑**:

- Yjs CRDT 无冲突协同编辑
- 在线状态显示（用户名/头像/颜色标识）
- 光标位置同步
- P2P实时同步（基于libp2p）
- 离线支持（离线编辑，上线后自动同步）
- 协作通知（用户加入/离开）

**版本历史管理**:

- 完整版本历史记录
- 版本恢复（一键恢复到任意历史版本）
- 版本对比（可视化差异对比）
- 版本标签（为重要版本添加标签）
- 贡献者追踪
- Git/IPFS集成

**评论与讨论**:

- 内联评论（精确到字符位置）
- 线程讨论（支持评论回复）
- @提及功能（自动发送通知）
- 评论解决标记
- 评论统计
- 评论通知

**权限与安全**:

- 细粒度权限（私有/团队/组织/公开）
- 角色权限（Owner/Admin/Member/Viewer）
- E2E加密（基于Signal Protocol）
- 操作审计日志
- 访问控制（特定成员/过期时间）

### 多身份架构

**核心特性**:

- 一个用户DID可拥有个人身份 + 多个组织身份
- 每个身份对应独立数据库文件
- 数据完全隔离
- 动态切换

**组织DID**:

- 支持组织级DID创建
- did:chainlesschain:org:xxxx 格式
- 组织成员管理
- 组织权限控制

### RBAC权限系统

**4个内置角色**:

1. **Owner** - 所有权限
2. **Admin** - 管理权限
3. **Member** - 读写权限
4. **Viewer** - 只读权限

**权限粒度**:

- org.manage - 组织管理
- member.manage - 成员管理
- knowledge.\* - 知识库权限
- project.\* - 项目权限
- invitation.create - 邀请创建

**高级特性**:

- 权限通配符
- 自定义角色
- 权限继承

### DID邀请链接系统 ⭐

**核心功能**:

- 安全令牌生成（32字节随机，base64url编码）
- 灵活使用控制（单次/多次/无限制）
- 过期时间管理（默认7天，可自定义）
- 权限控制（基于角色邀请）
- 使用记录追踪（记录DID/时间/IP/User Agent）
- 统计分析（链接总数/活跃/过期/撤销/使用率）

**IPC接口**:

- 创建/验证/接受邀请
- 列表/详情查询
- 撤销/删除操作
- 统计分析
- 链接复制

---

## AI模板系统

### 系统概况

**核心数据**:

- 178个AI模板
- 32个分类体系
- 100% 配置覆盖
- 智能引擎分配

### 模板分类

**办公文档类** (12个分类):

- writing, creative-writing - 创意写作
- education, learning - 教育培训
- legal, health - 法律文书、健康管理
- career, resume - 职业规划、简历制作
- cooking, gaming, lifestyle - 生活方式
- productivity, tech-docs - 生产力工具、技术文档

**办公套件类** (3个分类):

- ppt - 演示文稿制作（6个模板）
- excel - 数据分析、财务管理（12个模板）
- word - 专业文档编辑（8个模板）

**开发类** (3个分类):

- web - Web开发项目（5个模板）
- code-project - 代码项目结构（7个模板）
- data-science - 数据科学、机器学习（6个模板）

**设计媒体类** (5个分类):

- design - UI/UX设计（6个模板）
- photography - 摄影创作
- video - 视频制作（29个模板）
- podcast - 播客制作
- music - 音乐创作（5个模板）

**营销类** (4个分类):

- marketing - 营销策划（8个模板）
- marketing-pro - 专业营销（6个模板）
- social-media - 社交媒体运营（6个模板）
- ecommerce - 电商运营（6个模板）

### 执行引擎分布

```
document引擎  : 95个 (46.3%)
video引擎     : 29个 (14.1%)
default引擎   : 26个 (12.7%)
excel引擎     : 12个 (5.9%)
word引擎      : 8个  (3.9%)
code引擎      : 7个  (3.4%)
其他引擎      : 31个 (15.1%)
```

### 配置完整性

- 文件系统: 178/178 (100%)
- 数据库: 203/203 (100%)
- Skills配置: 100%
- Tools配置: 100%
- Engine配置: 100%

---

## MCP集成

### 什么是MCP

**核心概念**:

- Model Context Protocol - 标准化协议
- 让AI助手连接外部工具和数据源
- 扩展AI能力的开放标准

### 支持的MCP服务器

| 服务器         | 功能                         | 安全级别 | 状态 |
| -------------- | ---------------------------- | -------- | ---- |
| **Filesystem** | 文件读写、搜索、目录管理     | 中       | ✅   |
| **PostgreSQL** | 数据库查询、表管理           | 高       | ✅   |
| **SQLite**     | 本地数据库访问               | 中       | ✅   |
| **Git**        | 仓库状态、提交历史、差异查看 | 中       | ✅   |
| **Fetch**      | HTTP请求、API调用            | 中       | ✅   |

### 核心特性

**UI管理界面**:

- 设置页面可视化管理
- 服务器状态监控
- 配置编辑

**多重安全防护**:

- 服务器白名单机制
- 路径/表访问控制
- 用户同意流程
- 进程隔离
- 审计日志

**性能监控**:

- 连接时间
- 调用延迟
- 错误率
- 内存使用

### 安全边界

**永久禁止访问**:

- chainlesschain.db（加密数据库）
- ukey/（硬件密钥）
- did/private-keys/（DID私钥）
- p2p/keys/（P2P加密密钥）

**白名单路径**:

- notes/
- imports/
- exports/
- projects/

---

## 性能优化

### Manus AI优化系统 ⭐

**核心技术**:

- Context Engineering - KV-Cache优化
- Tool Masking - 智能工具选择
- TaskTrackerFile - todo.md机制
- 可恢复压缩

**性能提升**:

- 理论Token成本降低 50-90%
- 感知延迟降低 93%
- LLM调用减少 58%

### Multi-Agent系统

**核心组件**:

- Agent协调器
- 3个专用Agent（代码生成/数据分析/文档处理）
- 并行执行
- 链式执行
- Agent间通信

**性能提升**:

- 复杂任务完成时间降低 30%

### 深度性能优化

**18个优化工具类**:

- 智能图片优化
- 实时性能监控
- 代码分割
- 组件懒加载
- 智能预取
- 请求批处理
- 乐观更新
- 数据压缩
- 增量同步
- 内存优化
- 动画控制
- 资源提示
- Content Visibility API
- 无障碍功能
- 性能基准测试

**4个专用组件**:

- AsyncComponent.vue
- LazyImage.vue
- PerformanceMonitor.vue
- VirtualMessageList.vue

---

## 相关文档

- [返回主文档](../README.md)
- [安装指南](./INSTALLATION.md)
- [架构文档](./ARCHITECTURE.md)
- [开发指南](./DEVELOPMENT.md)
- [版本历史](./CHANGELOG.md)
- [区块链文档](./BLOCKCHAIN.md)
