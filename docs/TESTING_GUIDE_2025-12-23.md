# ChainlessChain 新功能测试指南

**测试日期**: 2025-12-23
**测试范围**: 新增的Excel编辑器、PPT编辑器、语音输入功能

---

## 📋 测试前准备

### 1. 安装依赖（可选）

```bash
cd desktop-app-vue

# PPT拖拽功能（必需）
npm install vue-draggable-plus

# Excel编辑器（可选，有降级方案）
npm install jspreadsheet-ce
```

### 2. 启动应用

```bash
# 如果修改了主进程，先构建
npm run build:main

# 启动开发模式
npm run dev
```

---

## 🧪 测试清单

### 测试 1: Excel编辑器

#### 测试步骤

1. **创建Excel文件**
   - [ ] 打开项目页面
   - [ ] 创建新项目或打开现有项目
   - [ ] 创建新的Excel文件

2. **基本编辑**
   - [ ] 单元格可以编辑
   - [ ] 输入数字、文本
   - [ ] 单元格高亮选中

3. **工具栏功能**
   - [ ] 点击"开始"标签页
   - [ ] 测试粗体、斜体、下划线按钮
   - [ ] 修改字体大小
   - [ ] 测试对齐方式（左对齐、居中、右对齐）

4. **插入功能**
   - [ ] 点击"插入"标签页
   - [ ] 点击"插入行"按钮，验证新行添加
   - [ ] 点击"插入列"按钮，验证新列添加

5. **保存和下载**
   - [ ] 编辑内容后，点击"保存"按钮
   - [ ] 验证"未保存"标签消失
   - [ ] 点击"下载"按钮，下载CSV文件
   - [ ] 用Excel或文本编辑器打开CSV文件，验证内容正确

6. **快捷键**
   - [ ] 编辑内容
   - [ ] 按 Ctrl+S 保存
   - [ ] 验证保存成功

#### 预期结果

- ✅ 所有单元格可编辑
- ✅ 工具栏按钮响应正常
- ✅ 保存功能正常
- ✅ 下载CSV文件正确

---

### 测试 2: PPT编辑器

#### 测试步骤

1. **创建PPT文件**
   - [ ] 创建新的PPT文件

2. **幻灯片管理**
   - [ ] 左侧显示幻灯片缩略图
   - [ ] 点击"+"按钮，添加新幻灯片
   - [ ] 验证新幻灯片出现在列表中
   - [ ] 点击幻灯片缩略图，切换当前编辑的幻灯片

3. **拖拽排序**
   - [ ] 拖拽幻灯片缩略图
   - [ ] 验证幻灯片顺序改变
   - [ ] 检查幻灯片编号更新

4. **内容编辑**
   - [ ] 在中央编辑区点击，开始编辑
   - [ ] 输入文本内容
   - [ ] 修改文本格式

5. **工具栏功能**
   - [ ] 测试"设计"标签页：选择主题
   - [ ] 测试"插入"标签页：点击插入按钮
   - [ ] 测试"动画"标签页：选择动画效果

6. **属性面板**
   - [ ] 右侧属性面板显示
   - [ ] 修改背景颜色
   - [ ] 修改文本大小和颜色

7. **保存功能**
   - [ ] 编辑后点击保存
   - [ ] 关闭并重新打开文件
   - [ ] 验证内容保留

8. **幻灯片操作**
   - [ ] 点击幻灯片的"..."菜单
   - [ ] 选择"复制"，验证幻灯片被复制
   - [ ] 选择"删除"，验证幻灯片被删除（至少保留1张）

9. **缩放功能**
   - [ ] 点击缩放按钮（+ 和 -）
   - [ ] 验证幻灯片缩放
   - [ ] 测试50%-200%缩放范围

#### 预期结果

- ✅ 幻灯片可以拖拽排序
- ✅ 内容可以编辑
- ✅ 工具栏功能响应
- ✅ 保存和加载正常

---

### 测试 3: 语音输入功能

#### 测试步骤

1. **检查浏览器支持**
   - [ ] 使用Chrome或Edge浏览器
   - [ ] 确保麦克风权限已授权

2. **启动语音输入**
   - [ ] 在项目页面找到对话输入框
   - [ ] 点击麦克风图标按钮
   - [ ] 验证弹出录音模态框

3. **录音过程**
   - [ ] 对着麦克风说话（中文）
   - [ ] 观察波纹动画效果
   - [ ] 观察录音计时器（MM:SS）
   - [ ] 查看"识别中"状态和临时文本

4. **完成录音**
   - [ ] 点击"完成"按钮
   - [ ] 验证识别的文本出现在输入框中
   - [ ] 验证文本可以继续编辑

5. **取消录音**
   - [ ] 再次点击麦克风按钮
   - [ ] 说话
   - [ ] 点击"取消"按钮
   - [ ] 验证输入框内容不变

6. **错误处理**
   - [ ] 静音测试：点击录音但不说话
   - [ ] 验证"未检测到语音"错误提示
   - [ ] 权限测试：拒绝麦克风权限
   - [ ] 验证"请允许麦克风权限"提示

#### 预期结果

- ✅ Chrome/Edge浏览器正常工作
- ✅ 语音识别准确（中文）
- ✅ 结果自动追加到输入框
- ✅ 错误提示友好

---

### 测试 4: 对话输入框UI

#### 测试步骤

1. **工具栏验证**
   - [ ] 验证"@"按钮存在
   - [ ] 验证"附件"按钮存在
   - [ ] 验证"麦克风"按钮存在（新增）
   - [ ] 验证"发送"按钮存在

2. **@ 提及功能**
   - [ ] 在输入框输入"@"
   - [ ] 验证弹出提及建议列表
   - [ ] 选择一个选项（知识库/文件/工具）
   - [ ] 验证选项插入到输入框

3. **附件上传**
   - [ ] 点击附件按钮
   - [ ] 选择文件上传
   - [ ] 验证文件标签出现在工具栏下方
   - [ ] 点击标签的"x"按钮，移除附件

4. **粘贴图片**
   - [ ] 复制一张图片
   - [ ] 在输入框内粘贴（Ctrl+V）
   - [ ] 验证图片作为附件添加

5. **快捷键**
   - [ ] 输入文本
   - [ ] 按 Ctrl+Enter
   - [ ] 验证消息发送

6. **字符计数**
   - [ ] 输入文本
   - [ ] 观察右下角字符计数更新
   - [ ] 验证显示"X / 5000"格式

#### 预期结果

- ✅ 所有按钮正常显示和工作
- ✅ @ 提及功能正常
- ✅ 附件上传和管理正常
- ✅ 快捷键支持

---

## 🐛 已知问题和限制

### Excel编辑器

- ⚠️ 如果未安装 jspreadsheet-ce，将使用基本HTML表格（功能受限）
- ⚠️ 下载格式为CSV，不支持真正的.xlsx格式（待优化）
- ⚠️ 图表功能尚未实现

### PPT编辑器

- ⚠️ 下载功能提示"开发中"，不支持真正的.pptx格式（待优化）
- ⚠️ 演示模式功能基础实现（待完善）
- ⚠️ 动画效果仅配置，未实际播放

### 语音输入

- ⚠️ Firefox浏览器不支持Web Speech API
- ⚠️ 需要网络连接（使用Google语音识别服务）
- ⚠️ 识别准确度依赖于发音清晰度和环境噪音

---

## ✅ 测试通过标准

### 基本功能测试

- [ ] Excel编辑器可以创建和编辑表格
- [ ] PPT编辑器可以管理幻灯片
- [ ] 语音输入可以识别中文
- [ ] 对话输入框所有按钮工作正常

### 保存和加载

- [ ] Excel文件可以保存和重新打开
- [ ] PPT文件可以保存和重新打开
- [ ] 语音识别结果正确追加到输入框

### 用户体验

- [ ] UI界面美观，符合参考资料
- [ ] 操作流畅，无明显卡顿
- [ ] 错误提示友好
- [ ] 快捷键支持完善

---

## 📊 测试报告模板

### 测试人员信息

- **测试人员**: [姓名]
- **测试日期**: [日期]
- **测试环境**:
  - 操作系统: [Windows/Mac/Linux]
  - 浏览器: [Chrome/Edge/Safari]
  - 浏览器版本: [版本号]

### 测试结果

| 功能 | 测试状态 | 备注 |
|------|---------|------|
| Excel编辑器 | ☑️ 通过 / ☐ 失败 | |
| PPT编辑器 | ☑️ 通过 / ☐ 失败 | |
| 语音输入 | ☑️ 通过 / ☐ 失败 | |
| 对话输入框 | ☑️ 通过 / ☐ 失败 | |

### 发现的问题

| 问题编号 | 问题描述 | 严重程度 | 复现步骤 |
|---------|---------|---------|---------|
| #1 | | 高/中/低 | |
| #2 | | 高/中/低 | |

### 建议和反馈

[在此填写测试建议和反馈]

---

## 🚀 快速测试命令

### 检查依赖

```bash
cd desktop-app-vue
npm list vue-draggable-plus
npm list jspreadsheet-ce
```

### 启动开发环境

```bash
# 完整启动
npm run dev

# 仅构建主进程
npm run build:main

# 仅构建渲染进程
npm run build:renderer
```

### 查看日志

打开开发者工具（F12）查看控制台日志：
- 错误信息：红色
- 警告信息：黄色
- 调试信息：灰色

---

## 📞 支持和反馈

如果在测试过程中遇到问题，请：

1. 检查控制台错误信息
2. 确认依赖已正确安装
3. 验证浏览器版本和兼容性
4. 记录复现步骤
5. 提交Issue到项目仓库

---

**测试指南版本**: 1.0
**最后更新**: 2025-12-23
