# Android LLM功能 - 用户使用指南

## 📱 功能概览

Android端现在拥有完整的LLM管理功能，支持12种主流AI提供商，包括：

- 本地模型（Ollama - 免费）
- 国际模型（OpenAI、Claude、Gemini）
- 国内模型（DeepSeek、豆包、通义千问、文心一言、智谱AI、月之暗面、讯飞星火）
- 自定义模型

## 🚀 快速开始

### 1. 访问LLM设置

**路径**: 主页 → 设置 → LLM配置

**快捷入口**:

- 从对话列表点击设置图标
- 从新建对话页面点击配置按钮

### 2. 配置提供商

#### 选择提供商

1. 打开LLM设置页面
2. 点击提供商选择器
3. 选择您要使用的AI提供商
4. 配置相应的参数

#### 配置项说明

**Ollama（本地 - 推荐新手）**

- 服务器地址: `http://localhost:11434` 或 `http://192.168.x.x:11434`
- 模型名称: `qwen2:7b`, `llama3:8b`, `deepseek-coder` 等
- 嵌入模型: `nomic-embed-text`
- 优点: 完全免费，数据私密
- 缺点: 需要本地运行Ollama服务

**OpenAI**

- API Key: 从 https://platform.openai.com 获取
- Base URL: `https://api.openai.com/v1`
- 模型: `gpt-4o-mini`, `gpt-4`, `gpt-3.5-turbo`
- 价格: $$$ 较贵

**DeepSeek（推荐）**

- API Key: 从 https://platform.deepseek.com 获取
- Base URL: `https://api.deepseek.com/v1`
- 模型: `deepseek-chat`, `deepseek-coder`
- 价格: $ 极便宜（性价比最高）
- 特点: 中文友好，编程能力强

**豆包（火山引擎）**

- API Key: 从火山引擎控制台获取
- Base URL: 提供商指定
- 模型: `doubao-pro`, `doubao-lite`
- 价格: $$ 中等
- 特点: 字节跳动出品，中文优秀

**其他提供商**

- 通义千问（阿里云）
- 文心一言（百度）
- 智谱AI（GLM）
- 月之暗面（Kimi）
- 讯飞星火
- Gemini（Google）
- Claude（Anthropic）

### 3. 测试连接

配置完成后：

1. 点击 "测试连接" 按钮
2. 等待测试结果
3. ✓ 成功：显示"连接成功！[提供商]服务正常"
4. ✗ 失败：显示具体错误信息

**常见错误**:

- "请先配置API Key" - 需要填写API密钥
- "连接失败：服务不可用" - 检查网络或API地址
- "401 Unauthorized" - API Key错误
- "连接超时" - 网络问题或服务器不可达

### 4. 调整参数

#### Temperature（温度）

- 范围: 0.0 - 2.0
- 推荐值: 0.7
- 说明:
  - 低值（0.1-0.5）：更确定、一致的回答
  - 中值（0.6-0.8）：平衡创造力和准确性
  - 高值（0.9-2.0）：更有创意、随机的回答

#### Top-P（核采样）

- 范围: 0.0 - 1.0
- 推荐值: 0.9
- 说明: 控制输出的多样性

#### Top-K（候选数量）

- 范围: 1 - 100
- 推荐值: 40
- 说明: 限制每步的候选token数量

#### Max Tokens（最大令牌数）

- 范围: 256 - 32768
- 推荐值: 4096
- 说明: 单次对话的最大长度限制

## 🎯 智能推荐功能

### 使用场景

点击顶部的 💡 图标，打开智能推荐对话框：

#### 使用场景选择

**免费优先**

- 推荐: Ollama
- 说明: 完全免费，适合学习和测试

**性价比优先**

- 推荐: DeepSeek
- 说明: 价格极低，性能优秀

**质量优先**

- 推荐: Claude, GPT-4
- 说明: 最高质量，适合重要任务

**编程任务**

- 推荐: DeepSeek-Coder, Claude
- 说明: 代码生成和理解能力强

**写作任务**

- 推荐: GPT-4, Claude
- 说明: 创意写作和内容生成

**中文优化**

- 推荐: 通义千问, DeepSeek, 豆包
- 说明: 中文理解和生成能力优秀

**翻译任务**

- 推荐: GPT-4, DeepSeek
- 说明: 多语言翻译准确

**摘要任务**

- 推荐: 通义千问, GPT-4
- 说明: 快速提取关键信息

**对话任务**

- 推荐: GPT-3.5, 豆包
- 说明: 自然对话，响应快速

**分析任务**

- 推荐: Claude, GPT-4
- 说明: 深度分析和推理

**通用场景**

- 推荐: GPT-4o-mini, DeepSeek
- 说明: 平衡性能和成本

#### 预算选择

**低预算（< $5/月）**

- 推荐免费或极低价格的模型
- Ollama（免费）, DeepSeek（$0.14/1M tokens）

**中预算（$5-50/月）**

- 平衡价格和性能
- GPT-3.5, 豆包, 通义千问

**高预算（$50-200/月）**

- 使用高质量模型
- GPT-4, Claude

**不限预算**

- 最佳性能，不考虑成本
- Claude Opus, GPT-4

### 应用推荐

选择场景和预算后：

1. 查看前5个推荐结果
2. 每个推荐显示：
   - 提供商名称
   - 匹配分数（0-100分）
   - 推荐理由
3. 点击 "应用此推荐" 立即切换

## 📊 使用统计功能

### 查看统计

点击顶部的 📊 图标，打开使用统计页面：

#### 总览卡片

显示所有提供商的汇总数据：

- **总Tokens**: 输入+输出的总token数
- **总成本**: 累计使用成本（美元）
- **总请求**: 总API调用次数

#### 单个提供商卡片

每个使用过的提供商显示独立卡片：

- 输入Token数量
- 输出Token数量
- 总计Token
- 请求次数
- 预估成本

#### 成本计算

自动根据官方定价计算：

- OpenAI gpt-4o-mini: $0.15/1M (输入) + $0.60/1M (输出)
- DeepSeek: $0.00014/1M (输入) + $0.00028/1M (输出)
- Ollama: 免费
- [其他提供商价格参见完整列表]

### 管理统计

**刷新数据**

- 点击顶部刷新图标
- 实时更新统计数据

**清除统计**

- 点击顶部删除图标 - 清除所有统计
- 点击单个提供商卡片上的删除 - 清除该提供商统计
- 需要确认操作，不可撤销

## 🔄 配置导入/导出

### 导出配置

点击顶部的 🔄 图标，打开导入导出对话框：

#### 完整导出

- 包含所有配置和API密钥
- 文件名: `llm-config-full.json`
- 用途: 备份或迁移到其他设备
- ⚠️ 注意: 包含敏感信息，请妥善保管

#### 安全导出

- 不包含API密钥等敏感信息
- 文件名: `llm-config-safe.json`
- 用途: 分享配置模板给他人
- ✓ 安全: 可以公开分享

### 导入配置

#### 从文件导入

1. 点击 "从文件导入" 按钮
2. 选择JSON配置文件
3. 自动导入所有配置
4. 页面自动刷新

#### 支持格式

- Android端导出的配置文件
- 桌面端导出的配置文件
- 手动编辑的JSON文件（需符合格式）

#### 注意事项

- 导入会覆盖现有配置
- 建议先备份当前配置
- API密钥在安全导出中会被清空

## 🔐 安全性

### 数据加密

- API密钥使用AES-256-GCM加密存储
- 使用Android EncryptedSharedPreferences
- 密钥存储在Android Keystore中

### 隐私保护

- 所有配置存储在本地
- 不会上传到任何服务器
- 安全导出模式移除敏感信息

### 权限要求

- 存储权限: 用于导入导出配置文件
- 网络权限: 用于连接AI服务

## 💡 最佳实践

### 新手推荐配置

**方案一：免费本地（最安全）**

```
提供商: Ollama
模型: qwen2:7b
优点: 完全免费，数据私密
缺点: 需要安装Ollama
```

**方案二：性价比（推荐）**

```
提供商: DeepSeek
模型: deepseek-chat
成本: ~$0.001 每千次对话
优点: 极低成本，中文友好
缺点: 需要网络
```

**方案三：高质量**

```
提供商: Claude
模型: claude-3-5-sonnet
成本: ~$0.05 每千次对话
优点: 最佳质量，推理能力强
缺点: 价格较高
```

### 多提供商策略

建议配置多个提供商：

1. **主力**: DeepSeek（日常使用）
2. **备用**: Ollama（离线或隐私任务）
3. **高端**: Claude（重要任务）

根据任务选择：

- 简单问答 → DeepSeek
- 代码生成 → DeepSeek-Coder
- 创意写作 → Claude
- 数据分析 → GPT-4

### 成本控制

**监控使用量**

- 定期查看使用统计
- 关注高成本提供商的使用
- 设置心理预算上限

**优化策略**

- 简单任务用便宜模型
- 重要任务用高质量模型
- 利用免费模型（Ollama）测试

**预算参考**

- 轻度使用: < $5/月（DeepSeek）
- 中度使用: $10-30/月（混合使用）
- 重度使用: $50-100/月（高质量模型）

## 🔧 故障排除

### 常见问题

**问题1: 无法连接Ollama**

- 检查Ollama服务是否运行
- 检查IP地址和端口
- Android设备和Ollama服务器在同一网络
- 防火墙是否允许11434端口

**问题2: API Key无效**

- 确认API Key正确复制
- 检查Key是否过期
- 确认账户有可用余额
- 重新生成新的API Key

**问题3: 连接超时**

- 检查网络连接
- 尝试更换网络（WiFi/移动数据）
- 检查VPN设置
- Base URL是否正确

**问题4: 成本统计不准确**

- Token估算基于字符数/4的近似值
- 实际成本可能略有差异
- 以官方账单为准
- 定期清除旧统计重新开始

**问题5: 配置导入失败**

- 确认文件格式为JSON
- 检查文件是否损坏
- 确认文件来源可信
- 尝试重新导出

### 重置配置

如果遇到严重问题：

1. 打开LLM设置
2. 点击右上角 ⋮ (更多菜单)
3. 选择 "重置为默认配置"
4. 确认操作
5. 重新配置所需提供商

## 📚 进阶使用

### 自定义提供商

选择 "自定义" 提供商，可以连接：

- 私有部署的模型
- 兼容OpenAI API的服务
- 本地模型服务（如LocalAI）

配置方法：

```
API Key: your-custom-key
Base URL: http://your-server:port/v1
Model: your-model-name
```

### 模型选择建议

**小模型（7B-13B）**

- 优点: 快速，低成本
- 适合: 简单对话，快速反馈
- 例子: qwen2:7b, llama3:8b

**中模型（30B-70B）**

- 优点: 平衡性能和速度
- 适合: 一般任务，日常使用
- 例子: deepseek-chat, gpt-3.5

**大模型（70B+）**

- 优点: 最佳性能，强大推理
- 适合: 复杂任务，重要工作
- 例子: gpt-4, claude-3-opus

### 参数调优

**创意写作**

```
Temperature: 0.9-1.2
Top-P: 0.95
Top-K: 50
Max Tokens: 4096
```

**技术文档**

```
Temperature: 0.3-0.5
Top-P: 0.85
Top-K: 30
Max Tokens: 8192
```

**代码生成**

```
Temperature: 0.2-0.4
Top-P: 0.9
Top-K: 40
Max Tokens: 4096
```

## 🎓 学习资源

### 官方文档

- OpenAI: https://platform.openai.com/docs
- DeepSeek: https://platform.deepseek.com/docs
- Anthropic: https://docs.anthropic.com
- Ollama: https://ollama.ai/docs

### 社区资源

- LLM排行榜: https://chat.lmsys.org
- 模型对比: https://artificialanalysis.ai
- Prompt工程: https://learnprompting.org

### 定价信息

- OpenAI定价: https://openai.com/pricing
- 国内模型定价对比: 各平台官网

## 📞 获取帮助

### 反馈渠道

- GitHub Issues: [项目地址]
- 邮件支持: [联系邮箱]
- 社区论坛: [论坛链接]

### 贡献

欢迎提交：

- Bug报告
- 功能建议
- 代码贡献
- 文档改进

---

**版本**: v1.0.0
**更新日期**: 2026-01-25
**适用平台**: Android 8.0+
