# Android App TODO å®ç°è¿›åº¦

**æ›´æ–°æ—¶é—´**: 2026-02-05
**å®æ–½çŠ¶æ€**: è¿›è¡Œä¸­

---

## âœ… ä»»åŠ¡ #1: å®ç° WebRTC WebSocket è¿æ¥æ ¸å¿ƒ (å·²å®Œæˆ)

### å®ç°å†…å®¹

1. **WebSocketSignalClient å®Œæ•´å®ç°** âœ…
   - ä½¿ç”¨ OkHttp WebSocket å®ç°ä¿¡ä»¤é€šä¿¡
   - è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼ˆæœ€å¤š5æ¬¡ï¼ŒæŒ‡æ•°é€€é¿ï¼‰
   - ä¿¡ä»¤æ¶ˆæ¯è§£æï¼ˆoffer/answer/ICE candidateï¼‰
   - è¿æ¥çŠ¶æ€ç®¡ç†å’Œé”™è¯¯å¤„ç†

2. **ä¿¡ä»¤é…ç½®ç®¡ç†** âœ…
   - åˆ›å»º `SignalingConfig.kt` é…ç½®ç±»
   - æ”¯æŒç¯å¢ƒå˜é‡ `SIGNALING_SERVER_URL`
   - é»˜è®¤å€¼ï¼š`ws://10.0.2.2:9001`ï¼ˆAndroidæ¨¡æ‹Ÿå™¨è®¿é—®å®¿ä¸»æœºï¼‰
   - å¯é…ç½®è¶…æ—¶ã€é‡è¿å»¶è¿Ÿã€å¿ƒè·³é—´éš”ç­‰å‚æ•°

3. **ä¾èµ–æ³¨å…¥é…ç½®** âœ…
   - æ›´æ–° `RemoteModule.kt` æä¾› OkHttpClient
   - WebSocket é…ç½®ï¼š10sè¿æ¥è¶…æ—¶ï¼Œ30sè¯»å†™è¶…æ—¶ï¼Œ20så¿ƒè·³
   - ç»‘å®š SignalClient æ¥å£åˆ° WebSocketSignalClient å®ç°

### åˆ›å»ºçš„æ–‡ä»¶

| æ–‡ä»¶è·¯å¾„                                                                           | è¡Œæ•° | è¯´æ˜           |
| ---------------------------------------------------------------------------------- | ---- | -------------- |
| `app/src/main/java/com/chainlesschain/android/remote/config/SignalingConfig.kt`    | 65   | ä¿¡ä»¤æœåŠ¡å™¨é…ç½® |
| æ›´æ–°ï¼š`app/src/main/java/com/chainlesschain/android/remote/di/RemoteModule.kt`     | +25  | DIé…ç½®         |
| æ›´æ–°ï¼š`app/src/main/java/com/chainlesschain/android/remote/webrtc/WebRTCClient.kt` | ~200 | WebSocketå®ç°  |

### æ ¸å¿ƒç‰¹æ€§

**1. ä¿¡ä»¤æ¶ˆæ¯æ ¼å¼**ï¼ˆJSONï¼‰:

```json
// Offer
{
  "type": "offer",
  "peerId": "pc-id-123",
  "sdp": "v=0..."
}

// Answer
{
  "type": "answer",
  "sdp": "v=0..."
}

// ICE Candidate
{
  "type": "ice-candidate",
  "peerId": "pc-id-123",
  "sdpMid": "0",
  "sdpMLineIndex": 0,
  "candidate": "candidate:..."
}
```

**2. è‡ªåŠ¨é‡è¿é€»è¾‘**:

- è¿æ¥å¤±è´¥åå»¶è¿Ÿ 3ç§’ è‡ªåŠ¨é‡è¿
- æœ€å¤šé‡è¯• 5æ¬¡
- æˆåŠŸè¿æ¥åé‡ç½®é‡è¿è®¡æ•°
- è¾¾åˆ°æœ€å¤§æ¬¡æ•°ååœæ­¢é‡è¿å¹¶è®°å½•é”™è¯¯

**3. è¿æ¥è¶…æ—¶å¤„ç†**:

- ç­‰å¾…è¿æ¥å»ºç«‹æœ€å¤š 10ç§’
- æ¯ 100ms æ£€æŸ¥ä¸€æ¬¡è¿æ¥çŠ¶æ€
- è¶…æ—¶è¿”å› `Result.failure(Exception("è¿æ¥è¶…æ—¶"))`

### å¾…ä¼˜åŒ–é¡¹

1. âœ… **ç¼–è¯‘é”™è¯¯ä¿®å¤** - WebRTC ç±»å‹å·²æ­£ç¡®ä½¿ç”¨ `org.webrtc.*` å‰ç¼€ï¼ŒRemoteModule å·²æ·»åŠ  OkHttpClient æä¾›æ–¹æ³•
2. â³ **TLSæ”¯æŒ** - ç”Ÿäº§ç¯å¢ƒéœ€è¦ä½¿ç”¨ `wss://`ï¼ˆWebSocket Secureï¼‰
3. â³ **å¿ƒè·³æœºåˆ¶** - å®ç°åº”ç”¨å±‚å¿ƒè·³æ£€æµ‹ï¼ˆå½“å‰ä»…ä¾èµ– OkHttp pingIntervalï¼‰
4. â³ **æ¶ˆæ¯é˜Ÿåˆ—** - å®ç°ç¦»çº¿æ¶ˆæ¯ç¼“å­˜ï¼ˆåœ¨æœªè¿æ¥æ—¶æš‚å­˜æ¶ˆæ¯ï¼‰

---

## ğŸ”„ å½“å‰çŠ¶æ€

**ä»»åŠ¡ #1 çŠ¶æ€**: âœ… å®Œæˆ
**ä¸‹ä¸€æ­¥**: ç»§ç»­ä»»åŠ¡ #2

---

## ğŸ“ å®æ–½è®°å½•

### 2026-02-05 å®æ–½ç»†èŠ‚

**1. WebSocket è¿æ¥æµç¨‹**:

```kotlin
// 1. è¿æ¥åˆ°ä¿¡ä»¤æœåŠ¡å™¨
val result = signalClient.connect()

// 2. å‘é€ offer
signalClient.sendOffer(peerId, offer)

// 3. ç­‰å¾… answer
val answer = signalClient.waitForAnswer(peerId, timeout = 10000)

// 4. å‘é€ ICE candidates
signalClient.sendIceCandidate(peerId, candidate)
```

**2. é”™è¯¯å¤„ç†**:

- ç½‘ç»œé”™è¯¯ â†’ è‡ªåŠ¨é‡è¿
- è¶…æ—¶é”™è¯¯ â†’ è¿”å› `Result.failure`
- è§£æé”™è¯¯ â†’ è®°å½•æ—¥å¿—ï¼Œä¸¢å¼ƒæ¶ˆæ¯
- æœªçŸ¥æ¶ˆæ¯ç±»å‹ â†’ è®°å½•è­¦å‘Š

**3. é…ç½®ä¼˜å…ˆçº§**:

1. ç¯å¢ƒå˜é‡ `SIGNALING_SERVER_URL`
2. `BuildConfig.SIGNALING_URL`ï¼ˆå¦‚æœé…ç½®ï¼‰
3. é»˜è®¤å€¼ `ws://10.0.2.2:9001`

---

## ğŸ¯ ä¸‹ä¸€æ­¥ä»»åŠ¡

- [x] ä¿®å¤ WebRTC ç±»å‹å¼•ç”¨ç¼–è¯‘é”™è¯¯ âœ… (2026-02-06)
- [ ] ä»»åŠ¡ #2: å®Œå–„ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—ç®¡ç†åŠŸèƒ½
- [ ] ä»»åŠ¡ #3: é…ç½®ç”Ÿäº§ç¯å¢ƒç­¾åè¯ä¹¦
- [ ] ä»»åŠ¡ #4: å®ç°ç¤¾äº¤åŠŸèƒ½ - ç‚¹èµ/æ”¶è—/åˆ†äº«
- [ ] ä»»åŠ¡ #5: å®ç° AI æ–‡ä»¶æ™ºèƒ½æ‘˜è¦åŠŸèƒ½
- [ ] ä»»åŠ¡ #6: é…ç½® CI/CD è‡ªåŠ¨åŒ–æµæ°´çº¿
