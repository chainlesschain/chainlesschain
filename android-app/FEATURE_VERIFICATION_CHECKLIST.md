# ChainlessChain Android v0.30.0 功能验证清单

本文档提供系统化的功能验证步骤，确保所有新功能正常工作。

**验证环境要求**:
- Android 设备/模拟器 (API 26+)
- 网络连接（用于测试同步、图片上传等）
- 至少 2 个测试账号（用于测试社交功能）

---

## 📋 验证进度跟踪

- [ ] Phase 1: 社交 UI 屏幕 (4/4)
- [ ] Phase 2: 功能增强 (5/5)
- [ ] Phase 3: E2E 测试 (42/42)

**总进度**: ___/51 项

---

## 🎯 Phase 1: 社交 UI 屏幕验证

### 1. AddFriendScreen - 添加好友页面

#### 验证步骤：

- [ ] **1.1 导航验证**
  1. 打开应用，导航到「社交」→「好友」
  2. 点击「添加好友」按钮
  3. ✅ 验证：进入添加好友页面，显示搜索框

- [ ] **1.2 DID 搜索**
  1. 在搜索框输入测试 DID（如 `did:test:friend:123`）
  2. 等待 300ms 防抖后自动搜索
  3. ✅ 验证：显示搜索结果或「未找到」提示

- [ ] **1.3 附近的人**
  1. 滚动到「附近的人」区域
  2. ✅ 验证：显示附近设备列表（如果有）或空状态

- [ ] **1.4 好友推荐**
  1. 滚动到「推荐好友」区域
  2. ✅ 验证：显示推荐列表或空状态

- [ ] **1.5 发送好友请求**
  1. 点击搜索结果中的「添加」按钮
  2. 输入验证消息
  3. 点击「发送」
  4. ✅ 验证：显示「好友请求已发送」提示

- [ ] **1.6 二维码扫描**
  1. 点击二维码扫描按钮
  2. ✅ 验证：打开扫描界面（占位实现）

**截图位置**: `screenshots/add-friend-screen.png`

---

### 2. FriendDetailScreen - 好友详情页面

#### 验证步骤：

- [ ] **2.1 导航验证**
  1. 从好友列表点击任意好友
  2. ✅ 验证：进入好友详情页面

- [ ] **2.2 个人资料显示**
  1. 检查页面显示内容
  2. ✅ 验证：显示头像、昵称、DID、个人简介

- [ ] **2.3 在线状态**
  1. 查看头像右下角
  2. ✅ 验证：显示绿色圆点（在线）或灰色（离线）

- [ ] **2.4 最后活跃时间**
  1. 查看简介下方
  2. ✅ 验证：显示「刚刚在线」/「5分钟前在线」等格式化时间

- [ ] **2.5 快捷操作**
  1. 点击「发消息」按钮
  2. ✅ 验证：跳转到聊天界面
  3. 返回，点击「语音」按钮
  4. ✅ 验证：显示语音通话界面（占位）
  5. 返回，点击「视频」按钮
  6. ✅ 验证：显示视频通话界面（占位）

- [ ] **2.6 好友动态**
  1. 滚动到动态列表
  2. ✅ 验证：显示该好友发布的动态（如果有）

- [ ] **2.7 备注名编辑**
  1. 点击右上角「更多」菜单
  2. 选择「设置备注」
  3. 输入备注名（如「我的好友」）
  4. 点击「保存」
  5. ✅ 验证：显示「备注名已更新」，页面标题变为备注名

- [ ] **2.8 删除/屏蔽**
  1. 点击「更多」→「删除好友」
  2. 确认删除
  3. ✅ 验证：返回好友列表，该好友已移除

**截图位置**: `screenshots/friend-detail-screen.png`

---

### 3. UserProfileScreen - 用户资料页面

#### 验证步骤：

- [ ] **3.1 陌生人状态**
  1. 从动态点击陌生人头像
  2. ✅ 验证：显示「添加好友」按钮

- [ ] **3.2 好友状态**
  1. 点击已是好友的用户头像
  2. ✅ 验证：显示「发消息」按钮

- [ ] **3.3 待处理状态**
  1. 点击已发送好友请求的用户头像
  2. ✅ 验证：显示「待接受」状态

- [ ] **3.4 已屏蔽状态**
  1. 点击已屏蔽的用户头像
  2. ✅ 验证：显示「解除屏蔽」按钮

- [ ] **3.5 用户动态**
  1. 滚动查看用户动态
  2. ✅ 验证：显示该用户的公开动态

- [ ] **3.6 TabRow 切换**
  1. 点击「动态」Tab
  2. ✅ 验证：显示动态列表
  3. 点击「点赞」Tab
  4. ✅ 验证：显示该用户点赞的动态

**截图位置**: `screenshots/user-profile-screen.png`

---

### 4. CommentDetailScreen - 评论详情页面

#### 验证步骤：

- [ ] **4.1 导航验证**
  1. 打开任意动态的评论列表
  2. 点击某条评论
  3. ✅ 验证：进入评论详情页面

- [ ] **4.2 主评论显示**
  1. 查看页面顶部
  2. ✅ 验证：显示主评论内容、作者、时间

- [ ] **4.3 回复列表**
  1. 滚动查看回复
  2. ✅ 验证：显示所有回复（嵌套层级）

- [ ] **4.4 发表回复**
  1. 在底部输入框输入回复内容
  2. 点击「发送」
  3. ✅ 验证：显示「评论已发布」，回复出现在列表中

- [ ] **4.5 点赞评论**
  1. 点击主评论的点赞图标
  2. ✅ 验证：图标变为填充状态，点赞数 +1

**截图位置**: `screenshots/comment-detail-screen.png`

---

## 🚀 Phase 2: 功能增强验证

### 5. 动态配图上传

#### 验证步骤：

- [ ] **5.1 图片选择**
  1. 点击「发布动态」
  2. 点击「图片」按钮
  3. 选择 1-3 张图片
  4. ✅ 验证：显示图片预览网格

- [ ] **5.2 图片预览**
  1. 查看预览网格
  2. ✅ 验证：显示 3 列布局，每张图片右上角有删除按钮

- [ ] **5.3 删除图片**
  1. 点击某张图片的删除按钮
  2. ✅ 验证：该图片从预览中移除

- [ ] **5.4 最多 9 张限制**
  1. 尝试选择超过 9 张图片
  2. ✅ 验证：显示「最多选择 9 张图片」提示

- [ ] **5.5 上传进度**
  1. 输入动态内容，点击「发布」
  2. ✅ 验证：显示每张图片的上传进度（0% → 100%）

- [ ] **5.6 上传成功**
  1. 等待上传完成
  2. ✅ 验证：显示「动态已发布」，返回时间流
  3. 验证动态显示正确的图片

- [ ] **5.7 上传失败重试**
  1. 模拟网络错误（飞行模式）
  2. 尝试上传图片
  3. ✅ 验证：显示上传失败，提供「重试」按钮

- [ ] **5.8 图片压缩**
  1. 选择一张 > 5MB 的大图
  2. 上传后检查文件大小
  3. ✅ 验证：自动压缩至 < 5MB

**截图位置**: `screenshots/image-upload.png`

---

### 6. 链接卡片预览

#### 验证步骤：

- [ ] **6.1 自动检测**
  1. 在发布动态输入框中粘贴链接
  2. 如：`https://kotlinlang.org`
  3. 等待 500ms
  4. ✅ 验证：自动显示链接预览卡片

- [ ] **6.2 预览内容**
  1. 查看预览卡片
  2. ✅ 验证：显示标题、描述、图片（如果有）

- [ ] **6.3 移除预览**
  1. 点击预览卡片的关闭按钮
  2. ✅ 验证：预览卡片消失，但链接文本保留

- [ ] **6.4 发布带预览的动态**
  1. 输入内容 + 链接，保留预览卡片
  2. 点击「发布」
  3. ✅ 验证：动态成功发布，时间流中显示预览卡片

- [ ] **6.5 预览失败处理**
  1. 输入无效链接（如 `http://invalid-url-12345.com`）
  2. ✅ 验证：显示「无法加载预览」或不显示预览卡片

- [ ] **6.6 缓存机制**
  1. 输入同一链接两次
  2. ✅ 验证：第二次加载速度明显更快（从缓存读取）

**截图位置**: `screenshots/link-preview.png`

---

### 7. 分享功能

#### 验证步骤：

- [ ] **7.1 分享按钮**
  1. 打开任意动态
  2. ✅ 验证：显示分享图标按钮

- [ ] **7.2 打开分享面板**
  1. 点击分享按钮
  2. ✅ 验证：打开 Android ShareSheet，显示可用应用

- [ ] **7.3 分享内容格式**
  1. 选择「复制链接」或「消息」应用
  2. ✅ 验证：分享文本包含：
     - 作者名
     - 动态内容（前 200 字）
     - 链接（如果有）
     - 「来自 ChainlessChain」标识

- [ ] **7.4 分享计数**
  1. 完成分享后返回
  2. ✅ 验证：动态的分享数 +1

- [ ] **7.5 分享通知**
  1. 使用第二个账号查看通知
  2. ✅ 验证：动态作者收到「有人分享了你的动态」通知

**截图位置**: `screenshots/share-feature.png`

---

### 8. 举报和屏蔽

#### 验证步骤：

- [ ] **8.1 举报动态**
  1. 打开他人动态，点击「更多」菜单
  2. 选择「举报」
  3. ✅ 验证：显示举报对话框

- [ ] **8.2 选择举报原因**
  1. 查看举报原因列表
  2. ✅ 验证：显示 6 种原因（垃圾信息、骚扰、不实信息等）
  3. 选择「垃圾信息」

- [ ] **8.3 填写描述**
  1. 在描述框输入详细信息
  2. ✅ 验证：可以输入多行文本

- [ ] **8.4 提交举报**
  1. 点击「提交」
  2. ✅ 验证：显示「举报已提交，感谢您的反馈」

- [ ] **8.5 屏蔽用户**
  1. 打开他人动态，点击「更多」菜单
  2. 选择「屏蔽该用户」
  3. 确认屏蔽
  4. ✅ 验证：显示「已屏蔽该用户」

- [ ] **8.6 内容过滤**
  1. 返回时间流
  2. ✅ 验证：被屏蔽用户的动态不再显示

- [ ] **8.7 屏蔽列表管理**
  1. 打开「设置」→「屏蔽用户」
  2. ✅ 验证：显示已屏蔽用户列表

- [ ] **8.8 取消屏蔽**
  1. 点击某个已屏蔽用户的「取消屏蔽」
  2. 返回时间流刷新
  3. ✅ 验证：该用户的动态重新显示

**截图位置**: `screenshots/report-block.png`

---

### 9. 好友备注编辑

#### 验证步骤：

- [ ] **9.1 打开备注对话框**
  1. 打开好友列表
  2. 长按某个好友
  3. 选择「设置备注」
  4. ✅ 验证：显示备注名对话框

- [ ] **9.2 对话框内容**
  1. 查看对话框
  2. ✅ 验证：显示原始昵称、备注输入框、提示文字

- [ ] **9.3 输入备注**
  1. 输入备注名（如「最好的朋友」）
  2. 点击「保存」
  3. ✅ 验证：显示「备注名已更新」

- [ ] **9.4 显示优先级**
  1. 查看好友列表
  2. ✅ 验证：显示备注名，原昵称显示在下方（小字）

- [ ] **9.5 搜索备注名**
  1. 打开搜索
  2. 输入备注名关键词
  3. ✅ 验证：可以搜索到该好友

- [ ] **9.6 清除备注**
  1. 再次打开备注编辑对话框
  2. 点击清除按钮或删除所有文字
  3. 点击「保存」
  4. ✅ 验证：恢复显示原昵称

**截图位置**: `screenshots/remark-name.png`

---

## 🧪 Phase 3: E2E 测试验证

### 自动化测试运行

#### 验证步骤：

- [ ] **3.1 环境准备**
  1. 确保安装 Android SDK
  2. 启动模拟器或连接真机
  3. ✅ 验证：`adb devices` 显示设备

- [ ] **3.2 运行知识库测试**
  ```bash
  cd android-app
  ./gradlew connectedDebugAndroidTest \
      -Pandroid.testInstrumentationRunnerArguments.class=com.chainlesschain.android.feature.knowledge.e2e.KnowledgeE2ETest
  ```
  - [ ] ✅ 验证：8/8 测试通过

- [ ] **3.3 运行 AI 对话测试**
  ```bash
  ./gradlew connectedDebugAndroidTest \
      -Pandroid.testInstrumentationRunnerArguments.class=com.chainlesschain.android.feature.ai.e2e.AIConversationE2ETest
  ```
  - [ ] ✅ 验证：10/10 测试通过

- [ ] **3.4 运行社交功能测试**
  ```bash
  ./gradlew connectedDebugAndroidTest \
      -Pandroid.testInstrumentationRunnerArguments.class=com.chainlesschain.android.feature.p2p.e2e.SocialE2ETest
  ```
  - [ ] ✅ 验证：12/12 测试通过

- [ ] **3.5 运行 P2P 通信测试**
  ```bash
  ./gradlew connectedDebugAndroidTest \
      -Pandroid.testInstrumentationRunnerArguments.class=com.chainlesschain.android.feature.p2p.e2e.P2PCommE2ETest
  ```
  - [ ] ✅ 验证：7/7 测试通过

- [ ] **3.6 运行项目管理测试**
  ```bash
  ./gradlew connectedDebugAndroidTest \
      -Pandroid.testInstrumentationRunnerArguments.class=com.chainlesschain.android.feature.project.e2e.ProjectE2ETest
  ```
  - [ ] ✅ 验证：5/5 测试通过

- [ ] **3.7 运行完整测试套件**
  ```bash
  ./gradlew connectedDebugAndroidTest \
      -Pandroid.testInstrumentationRunnerArguments.package=com.chainlesschain.android.e2e
  ```
  - [ ] ✅ 验证：42/42 测试全部通过

- [ ] **3.8 生成覆盖率报告**
  ```bash
  ./gradlew jacocoE2ETestReport
  ```
  - [ ] ✅ 验证：生成 HTML 报告
  - [ ] ✅ UI 覆盖率 ≥ 80%
  - [ ] ✅ 业务逻辑覆盖率 ≥ 90%
  - [ ] ✅ 关键路径覆盖率 = 100%

---

## 📊 验证结果记录

### 验证环境信息

| 项目 | 信息 |
|------|------|
| **设备型号** | ___________ |
| **Android 版本** | ___________ |
| **应用版本** | v0.30.0 |
| **验证日期** | ___________ |
| **验证人员** | ___________ |

### 问题记录

如果发现问题，请记录：

#### 问题 #1
- **功能**: __________
- **严重程度**: [ ] P0 (阻塞) [ ] P1 (严重) [ ] P2 (一般) [ ] P3 (轻微)
- **重现步骤**:
  1. __________
  2. __________
- **预期结果**: __________
- **实际结果**: __________
- **截图**: __________

#### 问题 #2
...

---

## ✅ 验证通过标准

### 必须通过项（零容忍）
- [ ] 所有 P0 功能正常工作
- [ ] E2E 测试通过率 100%
- [ ] 无应用崩溃
- [ ] 无数据丢失

### 建议通过项
- [ ] UI 响应流畅（无明显卡顿）
- [ ] 网络请求正常（5 秒内响应）
- [ ] 内存占用 < 200MB
- [ ] 电池消耗正常

### 最终签字

- [ ] **功能验证完成**: __________ (签名/日期)
- [ ] **质量审核通过**: __________ (签名/日期)
- [ ] **产品批准发布**: __________ (签名/日期)

---

## 📞 支持

遇到问题？
- 📖 查看 [E2E_TESTING_GUIDE.md](./E2E_TESTING_GUIDE.md)
- 🐛 提交 Issue: https://github.com/yourusername/chainlesschain/issues
- 💬 联系开发团队

---

**维护者**: ChainlessChain QA Team
**最后更新**: 2026-01-26
**版本**: v0.30.0
