# ChainlessChain Web Clipper - 用户使用指南

## 📖 目录

- [简介](#简介)
- [安装指南](#安装指南)
- [基础功能](#基础功能)
- [AI功能](#ai功能)
- [截图与标注](#截图与标注)
- [批量剪藏](#批量剪藏)
- [常见问题](#常见问题)
- [快捷键](#快捷键)

---

## 简介

ChainlessChain Web Clipper 是一款强大的网页剪藏浏览器扩展，可以将网页内容保存到您的本地知识库。它具有以下特点：

- 🧠 **智能内容提取**：使用 Mozilla Readability 技术，自动提取网页核心内容
- 🤖 **AI 增强**：自动生成标签和摘要
- 📸 **截图标注**：捕获页面截图并添加注释
- 📚 **批量剪藏**：一次保存多个标签页
- 🔒 **本地存储**：所有数据保存在本地桌面应用，保护隐私
- ⚡ **快捷键支持**：`Ctrl+Shift+C` (Windows/Linux) 或 `Command+Shift+C` (macOS)

---

## 安装指南

### 前置要求

1. **桌面应用**：必须先安装并运行 ChainlessChain 桌面应用
2. **浏览器**：Chrome、Edge、Firefox 或 Safari (暂未支持)

### 安装步骤

#### Chrome / Edge

1. **构建扩展**
   ```bash
   cd desktop-app-vue/browser-extension
   npm install
   npm run build:chrome
   ```

2. **加载扩展**
   - 打开浏览器，访问 `chrome://extensions/` (Chrome) 或 `edge://extensions/` (Edge)
   - 启用右上角的 "开发者模式"
   - 点击 "加载已解压的扩展程序"
   - 选择 `browser-extension/build/chrome` 目录

3. **验证安装**
   - 扩展图标应出现在工具栏
   - 点击图标，应显示 "已连接" 状态

#### Firefox

1. **构建扩展**
   ```bash
   npm run build:firefox
   ```

2. **临时加载**
   - 访问 `about:debugging#/runtime/this-firefox`
   - 点击 "临时载入附加组件"
   - 选择 `browser-extension/build/firefox/manifest.json`

3. **永久安装** (需签名)
   - 访问 [Firefox Add-ons](https://addons.mozilla.org/)
   - 提交扩展进行审核

### 配置桌面应用

确保桌面应用的 HTTP API 服务已启动（默认端口：23456）：

```javascript
// 在桌面应用中，HTTP 服务会自动启动
// 检查日志：[NativeMessagingHTTPServer] 服务器已启动: http://localhost:23456
```

---

## 基础功能

### 剪藏当前页面

1. **打开扩展**
   - 点击工具栏图标
   - 或使用快捷键 `Ctrl+Shift+C`

2. **检查连接状态**
   - 🟢 "已连接"：可以正常使用
   - 🔴 "连接失败"：请检查桌面应用是否运行

3. **编辑信息**
   - **标题**：自动填充，可修改
   - **类型**：选择内容类型
     - `网页剪藏`：普通网页
     - `文章`：博客文章、新闻
     - `笔记`：个人笔记
     - `文档`：技术文档
   - **标签**：用逗号分隔，如 "技术, React, 教程"
   - **Readability**：推荐勾选，自动提取正文

4. **保存**
   - 点击 "剪藏到知识库" 按钮
   - 等待成功提示
   - 内容已保存到桌面应用的 SQLite 数据库

### 内容提取原理

扩展使用 Mozilla Readability 库智能提取网页内容：

```
原始网页 → 去除广告/导航/侧边栏 → 提取正文 → 保留格式 → 存储
```

**支持的元素**：
- 文本段落
- 标题（H1-H6）
- 列表（有序/无序）
- 代码块
- 引用块
- 图片（保留URL）

---

## AI功能

### AI 标签生成

自动为网页内容生成相关标签，节省手动输入时间。

**使用方法**：
1. 在标签输入框右侧，点击 "🤖 AI生成" 按钮
2. 等待 2-3 秒（根据LLM响应速度）
3. 标签自动填充到输入框

**示例**：
```
网页：《React Hooks 完全指南》
生成标签：React, Hooks, 前端开发, 教程, JavaScript
```

**技术细节**：
- 使用桌面应用的 LLM 服务（Ollama 或云端 API）
- 分析标题、内容摘要、URL
- 生成 3-5 个最相关的标签
- **Fallback**：如果 LLM 不可用，使用关键词提取

### AI 摘要生成

为长文章生成简洁摘要（100-200字）。

**使用方法**：
1. 点击 "📝 生成摘要" 按钮
2. 等待 3-5 秒
3. 摘要显示在文本框中（只读）

**示例**：
```
原文：3000字技术博客
摘要：本文介绍了 React Hooks 的核心概念，包括 useState、useEffect
等常用 Hook 的使用方法，并通过实战案例展示了如何在项目中应用 Hooks
优化代码结构和性能。
```

**技术细节**：
- 输入限制：最多 3000 字符（避免 token 超限）
- 使用 LLM 的摘要能力
- **Fallback**：如果 LLM 不可用，返回前 200 字

### LLM 配置

在桌面应用中配置 LLM 提供商：

**本地模型（推荐）**：
```bash
# 启动 Ollama
docker-compose up -d ollama

# 拉取模型
docker exec chainlesschain-ollama ollama pull qwen2:7b
```

**云端 API**（可选）：
- 阿里云 通义千问
- 智谱 GLM
- 百度 千帆
- OpenAI
- DeepSeek

在桌面应用设置中配置 API Key。

---

## 截图与标注

### 捕获截图

1. 点击 "📸 截图标注" 按钮
2. 扩展自动捕获当前可见区域
3. 打开标注编辑器窗口（1200x800）

### 标注工具

标注编辑器提供 7 种工具：

| 工具 | 图标 | 功能 | 使用方法 |
|------|------|------|----------|
| **选择** | ↖️ | 选择/移动/调整标注 | 点击图标 → 点击标注对象 |
| **画笔** | ✏️ | 自由绘制 | 点击图标 → 在画布上拖动 |
| **高亮** | 🖍️ | 半透明高亮笔 | 点击图标 → 拖动绘制 |
| **文本** | T | 添加文本注释 | 点击图标 → 点击位置 → 输入文字 |
| **箭头** | ➡️ | 绘制箭头指示 | 点击图标 → 拖动绘制 |
| **矩形** | ▭ | 绘制矩形框 | 点击图标 → 拖动绘制 |
| **撤销** | ↶ | 撤销上一步操作 | 点击图标 |
| **清除** | 🗑️ | 清除所有标注 | 点击图标 → 确认 |

### 颜色选择

- 点击调色板图标选择颜色
- 默认颜色：红色 (#FF0000)
- 支持所有标准 HTML 颜色

### 保存截图

1. 完成标注后，点击 "💾 保存" 按钮
2. 截图保存为 PNG 格式
3. 标注元数据保存为 JSON
4. 文件位置：`{用户数据目录}/screenshots/screenshot-{时间戳}.png`
5. 数据库记录：`screenshots` 表

### 取消操作

点击 "❌ 取消" 按钮关闭编辑器，不保存。

---

## 批量剪藏

一次性保存多个标签页，提高效率。

### 打开批量剪藏

点击 "📚 批量剪藏" 按钮，打开批量剪藏窗口。

### 选择标签页

**方法 1：逐个勾选**
- 点击标签页项左侧的复选框
- 或点击整行切换选中状态

**方法 2：批量选择**
- "☑️ 全选"：选中所有标签页
- "☐ 取消全选"：清除所有选择
- "👆 仅当前窗口"：只选择当前浏览器窗口的标签页

**方法 3：搜索过滤**
- 在搜索框输入关键词
- 实时过滤标题或 URL 匹配的标签页
- 选择过滤后的结果

### 开始剪藏

1. 确认选中的标签页数量（右下角显示）
2. 点击 "开始剪藏 🚀" 按钮
3. 观察进度条和状态

### 处理进度

**进度面板显示**：
- 进度条：0% → 100%
- 统计：已保存 X / 总计 Y
- 当前处理：正在处理 [页面标题]
- 失败列表：自动记录失败的页面

**标签页状态**：
- 🔄 处理中：黄色背景，"处理中..." 标签
- ✓ 成功：绿色背景，"✓ 成功" 标签
- ✗ 失败：红色背景，"✗ 失败" 标签

### 停止处理

点击 "⏹ 停止" 按钮，当前任务完成后停止。

### 完成结果

**成功面板显示**：
- ✅ 图标动画
- 成功数量统计
- 失败数量统计（如有）
- "查看失败列表" 按钮（如有失败）

**查看失败详情**：
```
以下页面剪藏失败:

1. React 官方文档
   错误: 无法获取页面信息
   URL: https://react.dev/

2. GitHub - 项目仓库
   错误: 剪藏失败
   URL: https://github.com/...
```

### 性能优化

- **并发限制**：最多 3 个标签页同时处理
- **延迟控制**：每次处理后延迟 200ms
- **智能降级**：content script 不可用时使用基础信息
- **容错机制**：单个失败不影响其他

---

## 常见问题

### Q1: 扩展显示 "连接失败"

**解决方法**：
1. 确认桌面应用正在运行
2. 检查 HTTP API 服务（端口 23456）
   ```bash
   # 测试连接
   curl http://localhost:23456/api/ping
   # 应返回: {"success":true,"data":{"message":"pong"}}
   ```
3. 检查防火墙设置
4. 重启桌面应用和浏览器

### Q2: AI 功能不可用

**可能原因**：
- LLM 服务未启动
- API Key 未配置
- 网络连接问题

**解决方法**：
1. 检查桌面应用 LLM 设置
2. 测试 Ollama 连接：`curl http://localhost:11434/api/tags`
3. 检查云端 API 配额
4. 使用 Fallback 功能（自动降级）

### Q3: 批量剪藏部分失败

**常见原因**：
- 某些标签页未加载完成
- Content script 未注入
- 页面结构特殊（SPA、动态加载）

**建议**：
- 确保标签页已完全加载
- 刷新失败的页面后重试
- 单独剪藏失败的页面

### Q4: 截图功能不工作

**解决方法**：
1. 检查浏览器权限（`tabs` 权限）
2. 确认不是特殊页面（chrome://、about:）
3. 重新加载扩展
4. 检查浏览器版本（需要较新版本）

### Q5: 标签页列表为空

**可能原因**：
- 所有标签页都是特殊页面
- 浏览器权限不足

**解决方法**：
- 打开一些普通网页
- 检查扩展权限设置
- 重新安装扩展

---

## 快捷键

| 操作 | Windows/Linux | macOS |
|------|---------------|-------|
| 打开扩展 | `Ctrl + Shift + C` | `Command + Shift + C` |
| 剪藏当前页 | `Alt + C` | `Option + C` |

**自定义快捷键**（Chrome/Edge）：
1. 访问 `chrome://extensions/shortcuts`
2. 找到 "ChainlessChain Web Clipper"
3. 点击编辑图标修改快捷键

---

## 数据存储

### 本地数据库

所有剪藏内容保存在桌面应用的 SQLite 数据库：

**位置**：`{用户数据目录}/data/chainlesschain.db`

**表结构**：
- `knowledge_items`：知识库条目
- `screenshots`：截图记录
- `tags`：标签索引

### 文件存储

**截图文件**：`{用户数据目录}/screenshots/`

### 数据安全

- 🔒 SQLCipher 加密（如果启用 U-Key）
- 🔐 AES-256 加密算法
- 📦 定期备份建议

---

## 隐私声明

ChainlessChain Web Clipper 尊重您的隐私：

- ✅ 所有数据存储在本地
- ✅ 不上传任何内容到服务器（除非使用云端 LLM）
- ✅ 不收集用户行为数据
- ✅ 不包含追踪代码
- ✅ 开源透明

**云端 LLM 使用**：
- 仅在启用 AI 功能时发送数据
- 仅发送标题、摘要（不包含完整内容）
- 遵循各 API 提供商的隐私政策

---

## 反馈与支持

### 问题反馈

- GitHub Issues: https://github.com/your-repo/chainlesschain/issues
- 邮箱: support@chainlesschain.com

### 功能建议

欢迎在 GitHub Discussions 提出新功能建议。

### 版本更新

当前版本：**v2.0.0**

**更新日志**：
- ✨ 新增 AI 标签生成
- ✨ 新增 AI 摘要生成
- ✨ 新增截图标注功能
- ✨ 新增批量剪藏功能
- 🔧 优化跨浏览器兼容性
- 🐛 修复已知问题

---

## 许可证

MIT License - 自由使用、修改、分发

---

**感谢使用 ChainlessChain Web Clipper！** 🎉
