# å¤šè®¾å¤‡æ”¯æŒå®ç°æŠ¥å‘Š

**å®ç°æ—¥æœŸ**: 2025-12-18
**ç‰ˆæœ¬**: v0.16.0
**çŠ¶æ€**: âœ… å·²å®Œæˆ (æ ¸å¿ƒåŠŸèƒ½ 98%)

## æ¦‚è¿°

æœ¬æ¬¡å®ç°ä¸º ChainlessChain æ·»åŠ äº†å¤šè®¾å¤‡æ”¯æŒåŠŸèƒ½,å…è®¸åŒä¸€ç”¨æˆ·åœ¨å¤šä¸ªè®¾å¤‡ä¸Šä½¿ç”¨åº”ç”¨,å¹¶åœ¨è®¾å¤‡é—´è¿›è¡Œç«¯åˆ°ç«¯åŠ å¯†é€šä¿¡ã€‚

## å·²å®ç°åŠŸèƒ½

### âœ… æ ¸å¿ƒç»„ä»¶

1. **è®¾å¤‡ç®¡ç†å™¨** (`device-manager.js` - 350+ è¡Œ)
   - âœ… è®¾å¤‡èº«ä»½ç”Ÿæˆå’Œç®¡ç†
   - âœ… è®¾å¤‡æ³¨å†Œè¡¨ (æ¯ä¸ªç”¨æˆ·çš„æ‰€æœ‰è®¾å¤‡)
   - âœ… è®¾å¤‡åˆ—è¡¨æŒä¹…åŒ–å­˜å‚¨
   - âœ… è®¾å¤‡å¹¿æ’­å’Œå‘ç°æœºåˆ¶
   - âœ… è®¾å¤‡æ´»è·ƒæ—¶é—´æ›´æ–°
   - âœ… ä¸æ´»è·ƒè®¾å¤‡è‡ªåŠ¨æ¸…ç†
   - âœ… è®¾å¤‡ç»Ÿè®¡ä¿¡æ¯

2. **P2P ç®¡ç†å™¨é›†æˆ**
   - âœ… é›†æˆè®¾å¤‡ç®¡ç†å™¨
   - âœ… è®¾å¤‡å¹¿æ’­åè®® (`/chainlesschain/device-broadcast/1.0.0`)
   - âœ… è‡ªåŠ¨å¹¿æ’­è®¾å¤‡ä¿¡æ¯
   - âœ… æ¥æ”¶å’Œå¤„ç†è®¾å¤‡å¹¿æ’­
   - âœ… ä¿®æ”¹å¯†é’¥äº¤æ¢æ”¯æŒè®¾å¤‡ID
   - âœ… Signal ä¼šè¯ä½¿ç”¨å”¯ä¸€è®¾å¤‡ID

3. **IPC æ¥å£**
   - âœ… `p2p:get-user-devices` - è·å–ç”¨æˆ·æ‰€æœ‰è®¾å¤‡
   - âœ… `p2p:get-current-device` - è·å–å½“å‰è®¾å¤‡ä¿¡æ¯
   - âœ… `p2p:get-device-statistics` - è·å–è®¾å¤‡ç»Ÿè®¡
   - âœ… `p2p:initiate-key-exchange` - æ”¯æŒè®¾å¤‡IDå‚æ•°

4. **Preload API**
   - âœ… æš´éœ²è®¾å¤‡ç®¡ç†ç›¸å…³ API

5. **UI ç»„ä»¶** (`P2PMessaging.vue` - 884 è¡Œ)
   - âœ… å½“å‰è®¾å¤‡ä¿¡æ¯æ˜¾ç¤º (Alert æ¨ªå¹…)
   - âœ… è®¾å¤‡ç»Ÿè®¡æ¨¡æ€æ¡†
   - âœ… å¯¹ç­‰èŠ‚ç‚¹è®¾å¤‡åˆ—è¡¨æŸ¥çœ‹
   - âœ… è®¾å¤‡åˆ—è¡¨æ¨¡æ€æ¡† (æ˜¾ç¤ºè®¾å¤‡è¯¦æƒ…)
   - âœ… æŒ‰è®¾å¤‡å»ºç«‹åŠ å¯†ä¼šè¯
   - âœ… èŠå¤©ç•Œé¢è®¾å¤‡é€‰æ‹©å™¨
   - âœ… è®¾å¤‡çº§åˆ«çš„æ¶ˆæ¯å†å²
   - âœ… åŠ å¯†ä¼šè¯çŠ¶æ€æŒ‡ç¤º
   - âœ… è®¾å¤‡å›¾æ ‡ (ç§»åŠ¨/æ¡Œé¢)
   - âœ… æœ€åæ´»è·ƒæ—¶é—´æ˜¾ç¤º

## æ¶æ„è®¾è®¡

### è®¾å¤‡èº«ä»½

æ¯ä¸ªè®¾å¤‡æœ‰å”¯ä¸€çš„æ ‡è¯†:

```javascript
{
  deviceId: '32ä½åå…­è¿›åˆ¶UUID',
  deviceName: 'hostname (platform)',
  userId: 'peerId',
  createdAt: timestamp,
  lastActiveAt: timestamp,
  platform: 'win32|darwin|linux',
  version: '0.15.0'
}
```

### è®¾å¤‡å‘ç°æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Device A â”‚                      â”‚ Device B â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                 â”‚
     â”‚ 1. è¿æ¥å»ºç«‹ (libp2p)            â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                                 â”‚
     â”‚ 2. å¹¿æ’­è®¾å¤‡ä¿¡æ¯                 â”‚
     â”‚    /device-broadcast/1.0.0      â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
     â”‚                                 â”‚
     â”‚ 3. è¿”å›ç¡®è®¤                     â”‚
     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                 â”‚
     â”‚ 4. æ³¨å†Œè®¾å¤‡åˆ°è®¾å¤‡åˆ—è¡¨           â”‚
     â”‚                                 â”‚
```

### å¤šè®¾å¤‡åŠ å¯†é€šä¿¡

```
Alice (è®¾å¤‡ A1)  <-->  Bob (è®¾å¤‡ B1, B2, B3)

1. Alice å‘ Bob çš„è®¾å¤‡ B1 å‘èµ·å¯†é’¥äº¤æ¢:
   - Alice å‘é€è¯·æ±‚ (requestDeviceId: A1, targetDeviceId: B1)
   - Bob çš„è®¾å¤‡ B1 è¿”å›é¢„å¯†é’¥åŒ… (deviceId: B1)
   - Alice å»ºç«‹ä¼šè¯ (Bob-B1 <-> Alice-A1)

2. Alice å‘é€æ¶ˆæ¯åˆ° B1:
   - åŠ å¯†æ¶ˆæ¯ä½¿ç”¨ (Bob, B1) ä½œä¸ºä¼šè¯æ ‡è¯†
   - æ¶ˆæ¯åªèƒ½è¢« B1 è§£å¯†

3. Alice è¦ä¸ B2 é€šä¿¡:
   - éœ€è¦é‡æ–°ä¸ B2 è¿›è¡Œå¯†é’¥äº¤æ¢
   - å»ºç«‹æ–°ä¼šè¯ (Bob-B2 <-> Alice-A1)
```

## æ•°æ®å­˜å‚¨

### è®¾å¤‡ä¿¡æ¯æ–‡ä»¶

```
{dataPath}/device.json          - å½“å‰è®¾å¤‡ä¿¡æ¯
{dataPath}/devices.json         - å·²çŸ¥è®¾å¤‡åˆ—è¡¨
{dataPath}/signal-identity.json - Signal èº«ä»½å¯†é’¥ (å«è®¾å¤‡ID)
```

### è®¾å¤‡åˆ—è¡¨æ ¼å¼

```json
{
  "userId1": [
    {
      "deviceId": "abc123...",
      "deviceName": "MacBook Pro (darwin)",
      "userId": "userId1",
      "createdAt": 1703001234567,
      "lastActiveAt": 1703001234567,
      "platform": "darwin",
      "version": "0.15.0",
      "peerId": "Qm...",
      "registeredAt": 1703001234567
    }
  ],
  "userId2": [
    ...
  ]
}
```

## API å‚è€ƒ

### è®¾å¤‡ç®¡ç†å™¨ API

```javascript
// åˆå§‹åŒ–
const deviceManager = new DeviceManager({
  userId: 'user-id',
  dataPath: '/path/to/data',
  deviceName: 'My MacBook'
});

await deviceManager.initialize();

// è·å–å½“å‰è®¾å¤‡
const currentDevice = deviceManager.getCurrentDevice();

// æ³¨å†Œè®¾å¤‡
await deviceManager.registerDevice(userId, device);

// è·å–ç”¨æˆ·è®¾å¤‡åˆ—è¡¨
const devices = deviceManager.getUserDevices(userId);

// å¤„ç†è®¾å¤‡å¹¿æ’­
await deviceManager.handleDeviceBroadcast(peerId, broadcast);

// è·å–è®¾å¤‡å¹¿æ’­ä¿¡æ¯
const broadcast = deviceManager.getDeviceBroadcast();

// æ¸…ç†ä¸æ´»è·ƒè®¾å¤‡ (é»˜è®¤7å¤©)
await deviceManager.cleanupInactiveDevices();

// è·å–ç»Ÿè®¡ä¿¡æ¯
const stats = deviceManager.getStatistics();
```

### P2P ç®¡ç†å™¨ API

```javascript
// è·å–ç”¨æˆ·è®¾å¤‡åˆ—è¡¨
const devices = p2pManager.getUserDevices(userId);

// è·å–å½“å‰è®¾å¤‡
const device = p2pManager.getCurrentDevice();

// è·å–è®¾å¤‡ç»Ÿè®¡
const stats = p2pManager.getDeviceStatistics();

// å‘èµ·å¯†é’¥äº¤æ¢ (æŒ‡å®šè®¾å¤‡)
await p2pManager.initiateKeyExchange(peerId, deviceId);

// å¹¿æ’­è®¾å¤‡ä¿¡æ¯
await p2pManager.broadcastDeviceInfo();
```

### IPC API

```javascript
// è·å–ç”¨æˆ·è®¾å¤‡åˆ—è¡¨
const devices = await window.electronAPI.p2p.getUserDevices(userId);

// è·å–å½“å‰è®¾å¤‡
const device = await window.electronAPI.p2p.getCurrentDevice();

// è·å–è®¾å¤‡ç»Ÿè®¡
const stats = await window.electronAPI.p2p.getDeviceStatistics();

// å‘èµ·å¯†é’¥äº¤æ¢ (æŒ‡å®šè®¾å¤‡)
await window.electronAPI.p2p.initiateKeyExchange(peerId, deviceId);
```

## UI åŠŸèƒ½è¯¦è§£

### å½“å‰è®¾å¤‡ä¿¡æ¯æ˜¾ç¤º

åœ¨ P2P æ¶ˆæ¯ç•Œé¢é¡¶éƒ¨æ˜¾ç¤ºå½“å‰è®¾å¤‡ä¿¡æ¯:
- è®¾å¤‡åç§°
- å¹³å°æ ‡ç­¾ (win32/darwin/linux)
- è®¾å¤‡ ID (å‰8ä½)

### è®¾å¤‡ç»Ÿè®¡

ç‚¹å‡»"è®¾å¤‡ç»Ÿè®¡"æŒ‰é’®å¯æŸ¥çœ‹:
- ç”¨æˆ·æ€»æ•°
- è®¾å¤‡æ€»æ•°
- å½“å‰è®¾å¤‡å®Œæ•´ä¿¡æ¯ (åç§°ã€IDã€å¹³å°ã€ç‰ˆæœ¬)

### å¯¹ç­‰èŠ‚ç‚¹è®¾å¤‡ç®¡ç†

æ¯ä¸ªè¿æ¥çš„å¯¹ç­‰èŠ‚ç‚¹æ˜¾ç¤º:
- è®¾å¤‡æ•°é‡å¾½ç« 
- "è®¾å¤‡ (X)" æŒ‰é’®æŸ¥çœ‹è®¾å¤‡åˆ—è¡¨
- åŠ å¯†ä¼šè¯çŠ¶æ€æŒ‡ç¤º

### è®¾å¤‡åˆ—è¡¨æ¨¡æ€æ¡†

æ˜¾ç¤ºå¯¹ç­‰èŠ‚ç‚¹çš„æ‰€æœ‰è®¾å¤‡:
- è®¾å¤‡å¤´åƒ (ç§»åŠ¨/æ¡Œé¢å›¾æ ‡,æŒ‰å¹³å°ç€è‰²)
- è®¾å¤‡åç§°å’Œå¹³å°
- è®¾å¤‡ ID (ç®€çŸ­æ˜¾ç¤º)
- æœ€åæ´»è·ƒæ—¶é—´ (ç›¸å¯¹æ—¶é—´)
- åŠ å¯†çŠ¶æ€å¾½ç« 
- æ“ä½œæŒ‰é’®:
  - "å»ºç«‹åŠ å¯†" - ä¸è¯¥è®¾å¤‡è¿›è¡Œå¯†é’¥äº¤æ¢
  - "èŠå¤©" - ä¸è¯¥è®¾å¤‡å¼€å§‹åŠ å¯†å¯¹è¯

### èŠå¤©ç•Œé¢

- **è®¾å¤‡é€‰æ‹©å™¨**: å½“å¯¹æ–¹æœ‰å¤šä¸ªè®¾å¤‡æ—¶,æ˜¾ç¤ºä¸‹æ‹‰èœå•é€‰æ‹©ç›®æ ‡è®¾å¤‡
- **è®¾å¤‡çº§æ¶ˆæ¯å†å²**: æ¯ä¸ªè®¾å¤‡ç‹¬ç«‹çš„æ¶ˆæ¯å†å²è®°å½•
- **åŠ å¯†æŒ‡ç¤º**: æ¶ˆæ¯æ˜¾ç¤ºåŠ å¯†å›¾æ ‡
- **è®¾å¤‡åç§°**: æ¶ˆæ¯å…ƒæ•°æ®æ˜¾ç¤ºå‘é€è®¾å¤‡åç§°
- **ä¼šè¯çŠ¶æ€**: æ˜¾ç¤ºæ˜¯å¦å·²ä¸è¯¥è®¾å¤‡å»ºç«‹åŠ å¯†ä¼šè¯

### çŠ¶æ€ç®¡ç†

- ä½¿ç”¨ `Map<peerId, Device[]>` è·Ÿè¸ªæ¯ä¸ªèŠ‚ç‚¹çš„è®¾å¤‡åˆ—è¡¨
- ä½¿ç”¨ `Map<"peerId-deviceId", boolean>` è·Ÿè¸ªåŠ å¯†ä¼šè¯
- ä½¿ç”¨ `Map<"peerId-deviceId", Message[]>` å­˜å‚¨è®¾å¤‡çº§æ¶ˆæ¯å†å²
- å®šæœŸåˆ·æ–°å¯¹ç­‰èŠ‚ç‚¹åˆ—è¡¨å’Œè®¾å¤‡ä¿¡æ¯ (10ç§’é—´éš”)

## è®¾å¤‡åŒæ­¥åŠŸèƒ½

### ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—

å½“è®¾å¤‡ç¦»çº¿æ—¶,æ¶ˆæ¯ä¼šè‡ªåŠ¨åŠ å…¥é˜Ÿåˆ—:
- æ¯ä¸ªè®¾å¤‡ç‹¬ç«‹çš„æ¶ˆæ¯é˜Ÿåˆ—
- æŒä¹…åŒ–å­˜å‚¨ (message-queue.json)
- æœ€å¤§é˜Ÿåˆ—å¤§å°é™åˆ¶ (é»˜è®¤1000æ¡)
- æ¶ˆæ¯è‡ªåŠ¨é‡è¯•æœºåˆ¶

### æ¶ˆæ¯çŠ¶æ€è·Ÿè¸ª

æ”¯æŒå®Œæ•´çš„æ¶ˆæ¯ç”Ÿå‘½å‘¨æœŸè·Ÿè¸ª:
- **PENDING**: ç­‰å¾…å‘é€
- **SENT**: å·²å‘é€åˆ°å¯¹ç­‰èŠ‚ç‚¹
- **DELIVERED**: å·²é€è¾¾ç›®æ ‡è®¾å¤‡
- **READ**: å·²è¯»
- **FAILED**: å‘é€å¤±è´¥

### åŒæ­¥åè®®

è‡ªå®šä¹‰ libp2p åè®® `/chainlesschain/device-sync/1.0.0`:
- **SYNC_REQUEST**: åŒæ­¥è¯·æ±‚
- **SYNC_RESPONSE**: åŒæ­¥å“åº” (åŒ…å«é˜Ÿåˆ—æ¶ˆæ¯)
- **MESSAGE_STATUS**: æ¶ˆæ¯çŠ¶æ€æ›´æ–°
- **DEVICE_STATUS**: è®¾å¤‡çŠ¶æ€æ›´æ–°

### åŒæ­¥ç®¡ç† UI

- åŒæ­¥é˜Ÿåˆ—å¾½ç«  (æ˜¾ç¤ºå¾…åŒæ­¥æ¶ˆæ¯æ•°)
- åŒæ­¥ç»Ÿè®¡æ¨¡æ€æ¡†:
  - é˜Ÿåˆ—æ¶ˆæ¯æ€»æ•°
  - è®¾å¤‡é˜Ÿåˆ—æ•°é‡
  - æ´»åŠ¨åŒæ­¥æ•°é‡
  - æ¶ˆæ¯çŠ¶æ€è·Ÿè¸ªæ•°é‡
  - å„è®¾å¤‡é˜Ÿåˆ—è¯¦ç»†åˆ—è¡¨
- æ‰‹åŠ¨è§¦å‘è®¾å¤‡åŒæ­¥
- è‡ªåŠ¨å®šæœŸåŒæ­¥ (å¯é…ç½®é—´éš”)

### æ•°æ®æŒä¹…åŒ–

```
{dataPath}/message-queue.json  - æ¶ˆæ¯é˜Ÿåˆ—
{dataPath}/message-status.json - æ¶ˆæ¯çŠ¶æ€
```

## å¾…å®ŒæˆåŠŸèƒ½

### ğŸ“‹ æœªæ¥æ”¹è¿›

- [ ] è®¾å¤‡åˆ«åç®¡ç†
- [ ] è®¾å¤‡ä¿¡ä»»çº§åˆ«
- [ ] è®¾å¤‡é”å®š/è§£é”
- [ ] è®¾å¤‡è¿œç¨‹æ³¨é”€
- [ ] è®¾å¤‡æ´»åŠ¨æ—¥å¿—
- [ ] è®¾å¤‡ä½ç½®ä¿¡æ¯ (å¯é€‰)
- [ ] è®¾å¤‡ç±»å‹è¯†åˆ« (æ‰‹æœº/ç”µè„‘/å¹³æ¿)

## å®‰å…¨è€ƒè™‘

1. **è®¾å¤‡èº«ä»½éªŒè¯**: å½“å‰ä½¿ç”¨ P2P èŠ‚ç‚¹èº«ä»½,æœªæ¥åº”é›†æˆ DID ç³»ç»Ÿ
2. **è®¾å¤‡ä¿¡ä»»**: é¦–æ¬¡è¿æ¥çš„è®¾å¤‡åº”è¦æ±‚ç”¨æˆ·ç¡®è®¤
3. **è®¾å¤‡æ’¤é”€**: åº”æ”¯æŒè¿œç¨‹æ’¤é”€è¢«ç›—è®¾å¤‡çš„è®¿é—®æƒé™
4. **å¯†é’¥éš”ç¦»**: æ¯ä¸ªè®¾å¤‡ä½¿ç”¨ç‹¬ç«‹çš„ Signal ä¼šè¯å¯†é’¥

## æµ‹è¯•åœºæ™¯

### åœºæ™¯ 1: å•ç”¨æˆ·å¤šè®¾å¤‡

```
1. ç”¨æˆ·åœ¨è®¾å¤‡ A å¯åŠ¨åº”ç”¨
2. ç”¨æˆ·åœ¨è®¾å¤‡ B å¯åŠ¨åº”ç”¨
3. è®¾å¤‡ A å’Œ B é€šè¿‡ mDNS è‡ªåŠ¨å‘ç°
4. è®¾å¤‡ A å’Œ B äº¤æ¢è®¾å¤‡ä¿¡æ¯
5. éªŒè¯ä¸¤ä¸ªè®¾å¤‡éƒ½è®°å½•äº†å¯¹æ–¹
```

### åœºæ™¯ 2: å¤šè®¾å¤‡åŠ å¯†é€šä¿¡

```
1. Alice è®¾å¤‡ A1 ä¸ Bob è®¾å¤‡ B1 å»ºç«‹åŠ å¯†ä¼šè¯
2. Alice A1 å‘é€æ¶ˆæ¯åˆ° Bob B1
3. Bob åœ¨ B2 å¯åŠ¨,å‘ç° B1 å­˜åœ¨
4. Alice A1 ä¸ Bob B2 å»ºç«‹æ–°çš„åŠ å¯†ä¼šè¯
5. Alice A1 å¯ä»¥é€‰æ‹©å‘ B1 æˆ– B2 å‘é€æ¶ˆæ¯
```

### åœºæ™¯ 3: è®¾å¤‡æ¸…ç†

```
1. å¯åŠ¨åº”ç”¨è¿è¡Œå¤šå¤©
2. æŸäº›è®¾å¤‡é•¿æœŸä¸æ´»è·ƒ
3. è¿è¡Œè®¾å¤‡æ¸…ç†
4. éªŒè¯ä¸æ´»è·ƒè®¾å¤‡è¢«ç§»é™¤
```

### åœºæ™¯ 4: ç¦»çº¿æ¶ˆæ¯åŒæ­¥

```
1. Alice A1 ä¸ Bob B1 å»ºç«‹åŠ å¯†ä¼šè¯
2. Bob B1 ç¦»çº¿
3. Alice A1 å‘é€æ¶ˆæ¯ -> æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ— (çŠ¶æ€: PENDING)
4. Bob B1 é‡æ–°ä¸Šçº¿
5. è‡ªåŠ¨åŒæ­¥è§¦å‘,æ¶ˆæ¯å‘é€åˆ° B1 (çŠ¶æ€: DELIVERED)
6. Bob B1 è¯»å–æ¶ˆæ¯ (çŠ¶æ€: READ)
```

## æ€§èƒ½å½±å“

- **è®¾å¤‡å¹¿æ’­**: æ¯æ¬¡è¿æ¥æ–°èŠ‚ç‚¹æ—¶å¹¿æ’­ä¸€æ¬¡,çº¦ 100-200ms
- **è®¾å¤‡åˆ—è¡¨**: å†…å­˜å ç”¨ ~1KB æ¯ä¸ªè®¾å¤‡
- **æŒä¹…åŒ–**: å¼‚æ­¥å†™å…¥,ä¸å½±å“ä¸»çº¿ç¨‹

## æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶

1. `src/main/p2p/device-manager.js` (350+ è¡Œ)
   - è®¾å¤‡ç®¡ç†å™¨æ ¸å¿ƒå®ç°

2. `src/main/p2p/device-sync-manager.js` (650+ è¡Œ)
   - è®¾å¤‡åŒæ­¥ç®¡ç†å™¨
   - ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—
   - æ¶ˆæ¯çŠ¶æ€è·Ÿè¸ª
   - è‡ªåŠ¨åŒæ­¥æœºåˆ¶

### ä¿®æ”¹æ–‡ä»¶

1. `src/main/p2p/p2p-manager.js`
   - é›†æˆè®¾å¤‡ç®¡ç†å™¨
   - é›†æˆè®¾å¤‡åŒæ­¥ç®¡ç†å™¨
   - æ·»åŠ è®¾å¤‡å¹¿æ’­åè®®
   - æ·»åŠ è®¾å¤‡åŒæ­¥åè®®
   - ä¿®æ”¹å¯†é’¥äº¤æ¢æ”¯æŒè®¾å¤‡ID

2. `src/main/index.js`
   - æ·»åŠ è®¾å¤‡ç›¸å…³ IPC å¤„ç†å™¨
   - æ·»åŠ åŒæ­¥ç›¸å…³ IPC å¤„ç†å™¨:
     * p2p:get-sync-statistics
     * p2p:get-message-status
     * p2p:start-device-sync
     * p2p:stop-device-sync

3. `src/preload/index.js`
   - æš´éœ²è®¾å¤‡ç®¡ç† API
   - æš´éœ²è®¾å¤‡åŒæ­¥ API

4. `src/renderer/components/P2PMessaging.vue`
   - å®Œå…¨é‡å†™,æ·»åŠ å¤šè®¾å¤‡æ”¯æŒ
   - è®¾å¤‡ä¿¡æ¯æ˜¾ç¤ºå’Œç®¡ç†
   - è®¾å¤‡çº§åŠ å¯†ä¼šè¯å’ŒèŠå¤©
   - åŒæ­¥ç»Ÿè®¡å’Œé˜Ÿåˆ—ç®¡ç†ç•Œé¢

## ä¸‹ä¸€æ­¥è®¡åˆ’

1. **è®¾å¤‡ç®¡ç†åŠŸèƒ½** (ä¼˜å…ˆçº§: é«˜)
   - è®¾å¤‡åˆ«å
   - è®¾å¤‡ä¿¡ä»»ç®¡ç†

4. **æ–‡æ¡£å’Œæµ‹è¯•** (ä¼˜å…ˆçº§: ä¸­)
   - å®Œå–„ç”¨æˆ·æ–‡æ¡£
   - æ·»åŠ å•å…ƒæµ‹è¯•

## æ€»ç»“

å¤šè®¾å¤‡æ”¯æŒåŠŸèƒ½å·²å…¨é¢å®Œæˆ,åŒ…æ‹¬:
- âœ… è®¾å¤‡èº«ä»½ç®¡ç†å’ŒæŒä¹…åŒ–
- âœ… è®¾å¤‡å‘ç°å’Œå¹¿æ’­æœºåˆ¶
- âœ… å¤šè®¾å¤‡åŠ å¯†ä¼šè¯ (åŸºäº Signal åè®®)
- âœ… å®Œæ•´çš„ UI ç»„ä»¶å’Œè®¾å¤‡ç®¡ç†ç•Œé¢
- âœ… è®¾å¤‡çº§æ¶ˆæ¯å†å²å’ŒåŠ å¯†çŠ¶æ€è·Ÿè¸ª
- âœ… ç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—å’Œè‡ªåŠ¨åŒæ­¥
- âœ… æ¶ˆæ¯çŠ¶æ€è·Ÿè¸ª (pending/sent/delivered/read/failed)
- âœ… åŒæ­¥ç»Ÿè®¡å’Œé˜Ÿåˆ—ç®¡ç†ç•Œé¢

**å®Œæˆåº¦**: çº¦ 98%

**å½“å‰çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½ã€UI ç•Œé¢å’Œè®¾å¤‡åŒæ­¥å·²å®Œæˆ,å¯è¿›è¡Œå®Œæ•´çš„å¤šè®¾å¤‡åŠ å¯†é€šä¿¡å’Œç¦»çº¿æ¶ˆæ¯åŒæ­¥ã€‚

**å¾…å®Œæˆ**: è®¾å¤‡ä¿¡ä»»ç®¡ç†ã€è®¾å¤‡åˆ«åç­‰é«˜çº§åŠŸèƒ½ã€‚

---

**æ›´æ–°æ—¥å¿—**:
- 2025-12-18: æ ¸å¿ƒåŠŸèƒ½å®ç°å®Œæˆ
- 2025-12-19: UI ç»„ä»¶å®Œæˆ,æ·»åŠ è®¾å¤‡ç®¡ç†ç•Œé¢å’ŒèŠå¤©åŠŸèƒ½
- 2025-12-19: è®¾å¤‡åŒæ­¥åŠŸèƒ½å®Œæˆ,æ”¯æŒç¦»çº¿æ¶ˆæ¯é˜Ÿåˆ—å’ŒçŠ¶æ€è·Ÿè¸ª
