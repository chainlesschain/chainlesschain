# 新增功能使用指南

**版本**: v0.20.0
**生成时间**: 2025-12-23
**作者**: ChainlessChain Team

---

## 📖 目录

1. [功能概览](#功能概览)
2. [视频处理引擎](#视频处理引擎)
3. [图像设计引擎](#图像设计引擎)
4. [AI代码助手](#ai代码助手)
5. [项目自动化规则](#项目自动化规则)
6. [项目RAG增强](#项目rag增强)
7. [系统配置](#系统配置)
8. [常见问题](#常见问题)

---

## 功能概览

v0.20.0版本新增了以下高级功能，让项目管理更加智能和高效：

| 功能模块 | 主要能力 | 使用场景 |
|---------|---------|---------|
| 视频处理引擎 | 格式转换、剪辑、字幕生成 | 视频内容创作、教学视频制作 |
| 图像设计引擎 | AI文生图、图片编辑、批量处理 | 设计素材生成、图片优化 |
| AI代码助手 | 代码生成、审查、重构、修复 | 软件开发、代码质量提升 |
| 项目自动化 | 定时任务、文件监听、自动化流程 | 提高工作效率、自动化运维 |
| 项目RAG增强 | 智能检索、上下文增强 | 项目AI对话质量提升 |

---

## 视频处理引擎

### 功能介绍

视频处理引擎提供专业的视频编辑能力，支持格式转换、剪辑、字幕生成等功能。

### 主要功能

#### 1. 视频格式转换

**支持格式**:
- 输入: MP4, AVI, MOV, MKV, FLV, WebM, WMV
- 输出: MP4, AVI, MOV, MKV, WebM

**使用步骤**:
1. 在项目详情页点击"工具"标签
2. 选择"视频处理"
3. 切换到"格式转换"标签
4. 选择输入视频文件
5. 选择目标格式和质量
6. 点击"开始转换"

**参数说明**:
- **质量**: 1-10，数值越高质量越好但文件越大
- **比特率**: 自动根据质量计算（1=500k, 10=5000k）

#### 2. 视频剪辑

**功能说明**:
- 精确到秒的时间控制
- 保留原始视频质量
- 支持大文件处理

**使用步骤**:
1. 选择输入视频
2. 设置开始时间（秒）
3. 设置剪辑时长（秒）
4. 点击"开始剪辑"

#### 3. AI字幕生成

**功能说明**:
- 自动语音识别
- 支持中英文
- 生成SRT格式字幕

**使用步骤**:
1. 选择视频文件
2. 选择语言（中文/英文）
3. 点击"生成字幕"
4. 生成的字幕文件与视频同目录

**注意事项**:
- 需要较长处理时间
- 当前为基础版本，准确率约80%
- 可手动编辑生成的SRT文件

---

## 图像设计引擎

### 功能介绍

图像设计引擎集成AI图像生成和专业图片编辑功能。

### 主要功能

#### 1. AI文生图

**功能说明**:
- 文本描述生成图片
- 多种尺寸和风格
- 基于Stable Diffusion或DALL-E

**使用步骤**:
1. 切换到"AI文生图"标签
2. 输入图片描述（中英文均可）
3. 选择尺寸:
   - 512x512 (小)
   - 1024x1024 (中)
   - 1024x768 (横向)
   - 768x1024 (纵向)
4. 选择风格:
   - 写实
   - 动漫
   - 油画
   - 素描
5. 点击"生成图片"

**提示词技巧**:
```
好的提示词: "一只橘色的可爱猫咪在阳光下的草地上玩耍, 摄影作品, 高清, 细节丰富"
避免: "猫" (太简单)
```

#### 2. 图片编辑

**支持操作**:

##### 移除背景
- 自动识别主体
- 生成透明背景PNG
- 适用于产品图、人像

##### 超分辨率 (2x)
- 图片放大2倍
- 使用Lanczos3算法
- 保持清晰度

##### 图片增强
- 自动调整亮度、对比度
- 智能锐化
- 提升整体质量

##### 调整大小
- 自定义宽高
- 保持比例或拉伸
- 批量处理支持

#### 3. 批量处理

**功能说明**:
- 一次处理多张图片
- 统一应用相同操作
- 自动保存到指定目录

**使用步骤**:
1. 点击"选择多个图片"
2. 选择要处理的图片（可多选）
3. 选择批量操作类型
4. 设置参数（如调整大小的目标尺寸）
5. 点击"批量处理"

---

## AI代码助手

### 功能介绍

AI代码助手是强大的编程辅助工具，支持多种编程语言的代码生成、审查和优化。

### 主要功能

#### 1. 代码生成

**支持语言**:
- JavaScript / TypeScript
- Python
- Java
- C++
- Go
- Rust
- C#

**使用步骤**:
1. 输入功能描述，例如:
   ```
   实现一个二分查找算法，要求:
   - 输入: 有序数组和目标值
   - 输出: 目标值的索引，不存在返回-1
   - 使用递归实现
   ```
2. 选择编程语言
3. （可选）指定框架
4. 勾选"生成单元测试"（如需要）
5. 勾选"添加详细注释"
6. 点击"生成代码"

**生成结果**:
- 完整的代码实现
- （可选）单元测试代码
- 详细的代码注释

#### 2. 代码审查

**审查维度**:
1. **代码质量**: 可读性、可维护性、命名规范
2. **性能问题**: 算法复杂度、资源使用
3. **安全隐患**: 潜在的安全漏洞
4. **潜在bug**: 逻辑错误、边界情况
5. **最佳实践**: 是否遵循语言规范

**使用步骤**:
1. 粘贴需要审查的代码
2. 选择编程语言
3. 点击"开始审查"
4. 查看审查结果:
   - 评分（1-10分）
   - 优点列表
   - 改进建议（按优先级分类）
   - 改进后的代码

**审查报告示例**:
```
## 总体评分
7/10

## 优点
1. 代码逻辑清晰
2. 变量命名规范

## 需要改进的地方
1. [高优先级] 缺少输入验证
   - 建议: 添加参数类型和范围检查

2. [中优先级] 可以优化性能
   - 建议: 使用Set代替Array进行查找

## 改进后的代码
[...]
```

#### 3. 代码重构

**重构类型**:
- **提取函数**: 将重复代码抽取为独立函数
- **改进命名**: 优化变量和函数命名
- **简化逻辑**: 简化复杂的if-else和循环
- **性能优化**: 改进算法和数据结构
- **现代化**: 使用语言的现代特性重写

**使用步骤**:
1. 粘贴需要重构的代码
2. 选择编程语言
3. 选择重构类型
4. 点击"开始重构"
5. 对比原始代码和重构后代码
6. 查看重构说明

#### 4. Bug修复

**功能说明**:
- 自动分析代码问题
- 提供修复方案
- 说明修复原理

**使用步骤**:
1. 粘贴有问题的代码
2. （可选）粘贴错误信息
3. 选择编程语言
4. 点击"修复Bug"
5. 查看:
   - 问题分析
   - 修复后的代码
   - 修复说明

---

## 项目自动化规则

### 功能介绍

项目自动化规则让你可以设置自动化任务，提高工作效率。

### 触发类型

#### 1. 定时触发

**使用场景**:
- 每天定时生成项目报告
- 定期备份项目文件
- 定时执行Git提交

**Cron表达式说明**:
```
格式: 分 时 日 月 周
示例:
- 0 9 * * *     每天9点
- 0 */2 * * *   每2小时
- 0 0 * * 0     每周日0点
- 0 0 1 * *     每月1号0点
```

**在线工具**: [https://crontab.guru/](https://crontab.guru/)

#### 2. 文件变化触发

**使用场景**:
- 代码文件修改后自动运行测试
- 配置文件更新后发送通知
- 文档修改后自动生成PDF

**配置参数**:
- **监听路径**: 文件或目录的完整路径
- **文件模式**: 通配符模式，如`**/*.js`匹配所有JS文件
- **监听事件**:
  - 新增 (add)
  - 修改 (change)
  - 删除 (unlink)

#### 3. 任务完成触发

**使用场景**:
- AI任务完成后发送通知
- 构建完成后自动部署

#### 4. 手动触发

**使用场景**:
- 需要人工判断时机的任务
- 临时性任务

### 动作类型

#### 1. 运行AI任务

**功能**: 调用AI引擎处理指定任务

**配置**:
- 任务描述: 详细描述要执行的任务

**示例**:
```
任务描述: "分析项目中的TODO注释，生成待办事项列表"
```

#### 2. 生成报告

**功能**: 自动生成项目报告

**报告类型**:
- 每日报告: 总结当天的工作进展
- 周报: 汇总一周的项目情况
- 数据分析: 生成数据统计报告

#### 3. 发送通知

**功能**: 发送提醒消息

**通知渠道**:
- 桌面通知: 系统原生通知
- 邮件: 发送邮件提醒（需配置）
- Webhook: 发送到自定义URL（需配置）

**示例**:
```
标题: "项目构建完成"
内容: "项目已成功构建，耗时3分钟"
渠道: 桌面通知
```

#### 4. Git提交

**功能**: 自动执行Git操作

**配置**:
- 项目路径: Git仓库路径
- 提交信息: commit message
- 自动推送: 是否推送到远程仓库

**注意事项**:
- 确保Git仓库已正确配置
- 建议先手动验证Git操作正常

#### 5. 导出文件

**功能**: 自动导出项目文件为指定格式

**配置**:
- 源文件路径
- 目标格式（PDF, Word, HTML等）
- 输出路径

#### 6. 运行脚本

**功能**: 执行自定义脚本

**配置**:
- 脚本路径: 脚本文件的完整路径
- 脚本参数: 空格分隔的参数列表

**支持的脚本**:
- Bash脚本 (.sh)
- Python脚本 (.py)
- Node.js脚本 (.js)
- PowerShell脚本 (.ps1)

### 创建规则示例

#### 示例1: 每日自动生成项目报告

```
规则名称: 每日项目报告
描述: 每天晚上生成项目进度报告
触发类型: 定时触发
Cron表达式: 0 20 * * *  (每天20点)
动作类型: 生成报告
报告类型: 每日报告
```

#### 示例2: 代码修改后自动测试

```
规则名称: 自动运行测试
描述: 代码文件修改后自动执行测试
触发类型: 文件变化
监听路径: /path/to/project/src
文件模式: **/*.js
监听事件: 修改
动作类型: 运行脚本
脚本路径: /path/to/project/run-tests.sh
```

#### 示例3: 定期Git提交

```
规则名称: 自动保存
描述: 每2小时自动提交代码
触发类型: 定时触发
Cron表达式: 0 */2 * * *  (每2小时)
动作类型: Git提交
项目路径: /path/to/project
提交信息: "Auto commit: $(date)"
自动推送: 否
```

---

## 项目RAG增强

### 功能介绍

项目RAG（Retrieval-Augmented Generation）增强功能让AI对话更加智能，能够准确理解项目上下文。

### 工作原理

```
用户提问 → RAG检索 → 构建上下文 → AI生成回答
              ↓
    ┌─────────┴─────────┐
    ↓         ↓         ↓
  项目文件  知识库  对话历史
```

### 使用方法

#### 1. 索引项目文件

**何时需要索引**:
- 新创建的项目
- 添加或修改了大量文件
- 感觉AI对项目理解不准确时

**操作步骤**:
1. 进入项目详情页
2. 点击右上角"设置"
3. 找到"RAG索引"部分
4. 点击"重新索引项目文件"
5. 等待索引完成

**索引内容**:
- 文本文件（.md, .txt, .js, .py等）
- 代码文件
- 文档文件

**不会索引**:
- 二进制文件
- 媒体文件
- 大于1MB的文件

#### 2. 查看索引状态

**指标说明**:
- **总文件数**: 项目中的文件总数
- **已索引文件**: 已完成向量化的文件数
- **索引进度**: 索引完成百分比

**示例**:
```
总文件数: 150
已索引文件: 145
索引进度: 96.67%
```

#### 3. RAG增强对话

**使用方式**:
- 直接在项目对话中提问
- RAG会自动检索相关内容
- AI回答会基于项目实际内容

**示例对话**:
```
用户: 这个项目的登录功能是怎么实现的?

AI: 根据项目代码,登录功能实现在 src/auth/login.js 中。
主要流程:
1. 用户输入用户名和密码
2. 调用 validateCredentials() 验证
3. 生成JWT token
4. 存储到localStorage

相关文件:
- src/auth/login.js (主要实现)
- src/utils/jwt.js (token生成)
- src/api/auth.js (API调用)
```

### RAG优化建议

1. **保持文件更新**:
   - 修改重要文件后重新索引
   - 定期（每周）重建索引

2. **提问技巧**:
   - 提供上下文: "在用户认证模块中..."
   - 引用具体文件: "login.js文件中..."
   - 询问关联: "哪些文件使用了这个函数?"

3. **项目结构清晰**:
   - 良好的目录组织
   - 有意义的文件命名
   - 添加README说明

---

## 系统配置

### FFmpeg配置（视频处理必需）

#### Windows安装

1. 下载FFmpeg:
   - 访问 [https://ffmpeg.org/download.html](https://ffmpeg.org/download.html)
   - 选择Windows版本
   - 下载完整版（带GPL许可）

2. 安装:
   ```bash
   # 解压到 C:\ffmpeg
   # 或其他路径
   ```

3. 配置环境变量:
   - 打开"系统属性" → "高级" → "环境变量"
   - 编辑PATH变量
   - 添加: `C:\ffmpeg\bin`
   - 确定并重启应用

4. 验证安装:
   ```bash
   ffmpeg -version
   ```

#### macOS安装

```bash
# 使用Homebrew
brew install ffmpeg
```

#### Linux安装

```bash
# Ubuntu/Debian
sudo apt update
sudo apt install ffmpeg

# CentOS/RHEL
sudo yum install ffmpeg
```

### AI图像生成服务配置

#### 方案1: 本地Stable Diffusion

1. 安装Stable Diffusion WebUI:
   ```bash
   git clone https://github.com/AUTOMATIC1111/stable-diffusion-webui.git
   cd stable-diffusion-webui
   ./webui.sh  # Linux/Mac
   # 或 webui.bat  # Windows
   ```

2. 启动服务:
   - 默认地址: `http://localhost:7860`
   - 应用会自动连接

3. （可选）配置环境变量:
   ```bash
   SD_API_ENDPOINT=http://localhost:7860
   ```

#### 方案2: DALL-E API

1. 获取OpenAI API密钥:
   - 访问 [https://platform.openai.com/](https://platform.openai.com/)
   - 创建API密钥

2. 配置环境变量:
   ```bash
   OPENAI_API_KEY=your_api_key_here
   ```

3. 在应用中选择"DALL-E"服务

### 依赖安装

首次使用或更新后，需要安装新依赖:

```bash
cd desktop-app-vue
npm install
```

新增的依赖包括:
- `fluent-ffmpeg`: 视频处理库
- `node-cron`: 定时任务调度

已有依赖（无需额外安装）:
- `sharp`: 图片处理
- `chokidar`: 文件监听

---

## 常见问题

### Q1: 视频转换失败提示"ffmpeg not found"

**原因**: 未安装FFmpeg或未配置环境变量

**解决方案**:
1. 按照[FFmpeg配置](#ffmpeg配置)章节安装
2. 确保ffmpeg在系统PATH中
3. 重启应用

### Q2: AI文生图生成失败或返回占位图

**原因**: 未配置或无法连接AI图像生成服务

**解决方案**:
- 方案1: 安装本地Stable Diffusion（推荐）
- 方案2: 配置DALL-E API密钥
- 临时: 应用会生成占位图，不影响其他功能

### Q3: 代码生成质量不理想

**原因**: 提示词不够清晰或语言模型能力限制

**改进建议**:
1. 提供更详细的功能描述
2. 明确输入输出格式
3. 指定特殊要求（如错误处理）
4. 可以多次生成并选择最佳结果

**示例**:
```
不够详细: "写一个排序函数"

更好的描述:
"用Python实现快速排序算法
输入: 整数列表
输出: 排序后的列表
要求: 1. 使用原地排序 2. 添加时间复杂度注释"
```

### Q4: 自动化规则未触发

**检查清单**:
1. 规则是否已启用（绿色标签）
2. Cron表达式是否正确
3. 文件路径是否存在
4. 查看应用日志

**调试方法**:
1. 先用"手动触发"测试动作是否正常
2. 检查触发条件配置
3. 查看规则详情中的"最后执行时间"

### Q5: 项目RAG检索不准确

**原因**: 文件未索引或索引过时

**解决方案**:
1. 重新索引项目文件
2. 确保相关文件是文本格式
3. 检查索引进度是否100%
4. 尝试更具体的提问

### Q6: 视频处理速度慢

**原因**: 视频文件较大或配置较高质量

**优化建议**:
1. 降低输出质量设置
2. 先剪辑后转换（减少处理文件大小）
3. 使用较低分辨率
4. 关闭其他占用CPU的程序

### Q7: 图片批量处理部分失败

**原因**: 部分图片格式不支持或文件损坏

**解决方案**:
1. 查看错误列表，排除问题文件
2. 确保图片格式在支持列表中
3. 单独处理失败的文件

---

## 使用技巧

### 1. 工作流自动化建议

**场景1: 内容创作者**
```
1. 使用AI文生图生成素材
2. 批量处理图片（调整大小、添加水印）
3. 编辑视频
4. AI生成字幕
5. 设置自动化规则备份项目
```

**场景2: 软件开发者**
```
1. 使用代码生成快速原型
2. 代码审查提升质量
3. 设置文件监听自动运行测试
4. 定时Git提交保存进度
5. RAG增强理解代码库
```

### 2. 提高AI对话质量

1. **提供充分上下文**:
   ```
   好: "在项目的用户认证模块中,JWT token是如何生成的?"
   差: "JWT怎么用?"
   ```

2. **引用具体文件**:
   ```
   好: "src/utils/validator.js中的emailValidator函数有什么问题?"
   差: "邮箱验证有问题"
   ```

3. **分步骤提问**:
   ```
   第1步: "列出项目中所有API路由"
   第2步: "auth相关的路由如何实现权限验证?"
   第3步: "能否优化这个验证逻辑?"
   ```

### 3. 性能优化建议

1. **索引策略**:
   - 不要索引node_modules等依赖目录
   - 排除大文件和二进制文件
   - 定期清理无用索引

2. **自动化规则**:
   - 避免设置过于频繁的定时任务
   - 文件监听使用具体的文件模式
   - 合理设置规则优先级

3. **资源管理**:
   - 视频处理时关闭其他重型任务
   - AI图像生成使用本地服务更快
   - 批量处理时控制并发数量

---

## 联系支持

如有问题或建议,请通过以下方式联系:

- 📧 Email: support@chainlesschain.com
- 🐛 GitHub Issues: [https://github.com/chainlesschain/issues](https://github.com/chainlesschain/issues)
- 📚 文档: [https://docs.chainlesschain.com](https://docs.chainlesschain.com)

---

**祝使用愉快！** 🎉
