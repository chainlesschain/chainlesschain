# 新菜单布局方案与实施计划

## 一、新菜单布局设计方案

### 1.1 设计原则

基于项目管理模块为系统核心的定位，新菜单布局遵循以下原则：

1. **核心优先**：项目管理功能置于最显眼位置
2. **用户导向**：按照用户使用频率和价值排序
3. **模块清晰**：保持原有的模块划分，但调整优先级
4. **渐进增强**：菜单先上线，页面逐步开发

### 1.2 PC端菜单结构（桌面应用）

```
侧边栏菜单
├── 🎯 项目管理 ⭐核心模块 (一级菜单)
│   ├── 📁 我的项目 (项目列表)
│   ├── ➕ 新建项目 (快速创建)
│   ├── 📑 项目模板 (模板库)
│   ├── 🏪 项目市场 (浏览购买项目)
│   ├── 🤝 协作项目 (多人协作的项目)
│   └── 📦 已归档项目 (历史项目)
│
├── 📚 知识与AI (一级菜单)
│   ├── 🏠 知识首页 (知识库概览)
│   ├── 📝 我的知识 (知识条目列表)
│   ├── 📤 文件导入 (批量导入)
│   ├── 🖼️ 图片上传 (图片管理)
│   ├── 💡 提示词模板 (AI提示词库)
│   ├── 🤖 AI对话 (独立AI助手)
│   ├── 🛒 知识付费 (知识商店)
│   └── 🎁 我的购买 (已购知识)
│
├── 👥 身份与社交 (一级菜单)
│   ├── 🆔 DID身份 (身份管理)
│   ├── 🎫 可验证凭证 (VC管理)
│   ├── 📇 联系人 (通讯录)
│   ├── 👫 好友管理 (社交关系)
│   ├── 📢 动态广场 (社交内容)
│   └── 💬 P2P消息 (加密聊天)
│
├── 💰 交易系统 (一级菜单)
│   ├── 🏪 交易市场 (商品浏览)
│   ├── 📜 智能合约 (合约管理)
│   ├── ⭐ 信用评分 (信誉系统)
│   ├── 📊 我的订单 (交易记录)
│   └── 💎 我的资产 (资产管理)
│
└── ⚙️ 系统设置 (一级菜单)
    ├── 🔧 通用设置 (基础配置)
    ├── 🤖 LLM配置 (AI模型设置)
    ├── 🔄 Git同步 (版本控制)
    ├── 🗄️ RAG配置 (检索增强)
    ├── 🔐 UKey安全 (硬件安全)
    └── 💾 数据备份 (备份恢复)
```

**顶部工具栏**（全局快捷操作）：
- 🔍 全局搜索 (搜索项目/知识/联系人)
- ➕ 快速创建 (下拉菜单：新建项目/新建知识)
- 🔔 通知中心 (协作通知、系统消息)
- 👤 用户头像 (个人信息、退出登录)

### 1.3 移动端菜单结构（UniApp）

**底部 TabBar**（主导航）：
```
┌─────────┬─────────┬─────────┬─────────┬─────────┐
│  🏠首页  │ 🎯项目  │ 💬消息  │ 📚知识  │ 👤我的  │
└─────────┴─────────┴─────────┴─────────┴─────────┘
```

#### Tab 1: 首页
- 用户信息卡片
- 快速操作入口（创建项目、AI对话、扫一扫、语音）
- 各模块快捷卡片（项目、知识、社交、交易）
- 最近访问/推荐内容

#### Tab 2: 项目 ⭐核心
```
项目页面
├── 顶部搜索栏
├── 快速创建按钮 (悬浮按钮)
├── 项目分类 Tab
│   ├── 全部项目
│   ├── 进行中
│   ├── 已完成
│   └── 协作项目
├── 项目列表 (卡片式)
│   ├── 项目缩略图
│   ├── 项目名称/类型
│   ├── 进度条
│   └── 快速操作 (继续/分享/更多)
└── 底部菜单
    ├── 项目模板
    ├── 项目市场
    └── 已归档
```

#### Tab 3: 消息
```
消息页面
├── P2P消息列表
├── 协作通知
├── 系统通知
└── 交易消息
```

#### Tab 4: 知识
```
知识页面
├── 知识搜索
├── 知识分类
├── 知识列表
├── AI对话入口
└── 知识导入/导出
```

#### Tab 5: 我的
```
个人中心
├── 用户信息
├── 我的项目 (统计)
├── 我的知识 (统计)
├── 我的资产
├── 系统设置
└── 关于应用
```

### 1.4 菜单配置数据结构

#### PC端菜单配置（MainLayout.vue）

```javascript
const menuConfig = {
  // 项目管理模块 ⭐
  'projects': {
    path: '/projects',
    title: '我的项目',
    icon: 'FolderOutlined',
    parent: 'project-management'
  },
  'project-new': {
    path: '/projects/new',
    title: '新建项目',
    icon: 'PlusCircleOutlined',
    parent: 'project-management'
  },
  'project-templates': {
    path: '/projects/templates',
    title: '项目模板',
    icon: 'FileTextOutlined',
    parent: 'project-management'
  },
  'project-market': {
    path: '/projects/market',
    title: '项目市场',
    icon: 'ShopOutlined',
    parent: 'project-management'
  },
  'project-collaboration': {
    path: '/projects/collaboration',
    title: '协作项目',
    icon: 'TeamOutlined',
    parent: 'project-management'
  },
  'project-archived': {
    path: '/projects/archived',
    title: '已归档项目',
    icon: 'InboxOutlined',
    parent: 'project-management'
  },

  // 知识与AI模块
  'knowledge-home': {
    path: '/knowledge/home',
    title: '知识首页',
    icon: 'HomeOutlined',
    parent: 'knowledge'
  },
  'knowledge-list': {
    path: '/knowledge/list',
    title: '我的知识',
    icon: 'FileTextOutlined',
    parent: 'knowledge'
  },
  'file-import': {
    path: '/knowledge/import',
    title: '文件导入',
    icon: 'CloudUploadOutlined',
    parent: 'knowledge'
  },
  'ai-chat': {
    path: '/ai/chat',
    title: 'AI对话',
    icon: 'RobotOutlined',
    parent: 'knowledge'
  },

  // ... 其他模块配置
}
```

#### 移动端路由配置（pages.json）

```json
{
  "pages": [
    {
      "path": "pages/index/index",
      "style": { "navigationBarTitleText": "首页" }
    },
    {
      "path": "pages/projects/list",
      "style": { "navigationBarTitleText": "我的项目" }
    },
    {
      "path": "pages/projects/detail",
      "style": { "navigationBarTitleText": "项目详情" }
    },
    {
      "path": "pages/projects/create",
      "style": { "navigationBarTitleText": "新建项目" }
    },
    {
      "path": "pages/projects/chat",
      "style": { "navigationBarTitleText": "项目AI助手" }
    }
  ],
  "tabBar": {
    "list": [
      {
        "pagePath": "pages/index/index",
        "text": "首页",
        "iconPath": "static/icons/home.png",
        "selectedIconPath": "static/icons/home-active.png"
      },
      {
        "pagePath": "pages/projects/list",
        "text": "项目",
        "iconPath": "static/icons/project.png",
        "selectedIconPath": "static/icons/project-active.png"
      },
      {
        "pagePath": "pages/messages/index",
        "text": "消息",
        "iconPath": "static/icons/message.png",
        "selectedIconPath": "static/icons/message-active.png"
      },
      {
        "pagePath": "pages/knowledge/list",
        "text": "知识",
        "iconPath": "static/icons/knowledge.png",
        "selectedIconPath": "static/icons/knowledge-active.png"
      },
      {
        "pagePath": "pages/mine/mine",
        "text": "我的",
        "iconPath": "static/icons/mine.png",
        "selectedIconPath": "static/icons/mine-active.png"
      }
    ]
  }
}
```

---

## 二、实施计划

### 阶段一：菜单重构（Week 1-2）

#### 任务 1.1: PC端菜单重构
**时间**: 3天
**负责**: 前端开发
**交付物**:
- ✅ 更新 MainLayout.vue 菜单结构
- ✅ 添加项目管理一级菜单和子菜单
- ✅ 调整菜单图标和顺序
- ✅ 配置路由占位页面（显示"开发中"）

**详细任务**:
```
Day 1:
- 修改 MainLayout.vue 菜单配置
- 添加项目管理相关图标 icon
- 调整菜单项顺序（项目管理放第一）

Day 2:
- 创建占位页面组件 (PlaceholderPage.vue)
- 配置所有项目管理路由
- 测试菜单点击和路由跳转

Day 3:
- 优化菜单样式和交互
- 添加菜单项徽章（如"新"、"Beta"标识）
- 完成测试和文档
```

#### 任务 1.2: 移动端菜单重构
**时间**: 3天
**负责**: 前端开发
**交付物**:
- ✅ 更新 pages.json TabBar配置
- ✅ 创建项目列表页面框架
- ✅ 准备TabBar图标资源
- ✅ 配置路由占位页面

**详细任务**:
```
Day 1:
- 修改 pages.json TabBar配置
- 设计并导出 TabBar 图标 (5组，每组2张)
- 调整 TabBar 顺序

Day 2:
- 创建 pages/projects/list.vue 占位页面
- 创建 pages/knowledge/list.vue 占位页面
- 配置页面路由

Day 3:
- 优化移动端页面布局
- 添加"开发中"提示组件
- 测试 TabBar 切换
```

#### 任务 1.3: 图标资源准备
**时间**: 2天
**负责**: UI设计师
**交付物**:
- ✅ PC端菜单图标集 (SVG格式)
- ✅ 移动端TabBar图标 (PNG, 2x/3x)
- ✅ 项目类型图标（Web、文档、数据等）

### 阶段二：项目管理核心页面开发（Week 3-6）

#### 任务 2.1: 项目列表页面
**时间**: 1周
**功能**:
- 项目卡片列表（网格/列表视图切换）
- 项目搜索和筛选
- 项目分类（按类型、状态、标签）
- 快速操作（打开、分享、删除）
- 分页和加载更多

**技术要点**:
- PC端: Vue3 + Ant Design Vue
- 移动端: UniApp + uView UI
- 数据库: 查询 projects 表
- API: GET /api/projects

#### 任务 2.2: 项目详情页面
**时间**: 2周
**功能**:
- 项目基本信息展示
- 文件树和文件列表
- 项目统计信息（文件数、任务数、AI tokens）
- 项目设置（名称、描述、标签）
- 项目操作（归档、删除、导出）

**技术要点**:
- 文件树组件 (ant-design-vue tree)
- 文件预览（支持代码高亮）
- Git 提交历史展示
- API: GET /api/projects/:id

#### 任务 2.3: 项目AI对话界面
**时间**: 2周
**功能**:
- 对话输入框（支持多行、@知识条目）
- 对话历史列表（分组显示）
- AI响应流式显示
- 代码块语法高亮
- 文件预览和下载
- 任务状态跟踪

**技术要点**:
- WebSocket 流式响应
- Markdown渲染 (marked + highlight.js)
- 拖拽上传文件
- API: POST /api/projects/:id/chat

#### 任务 2.4: 新建项目向导
**时间**: 1周
**功能**:
- 多步骤表单（项目类型、模板选择、基本信息）
- 项目模板预览
- AI辅助设置（智能推荐模板）
- 快速创建（常用模板一键创建）

**技术要点**:
- 步骤条组件 (a-steps)
- 表单验证
- API: POST /api/projects

### 阶段三：项目文件处理引擎开发（Week 7-12）

#### 任务 3.1: Web开发引擎
**时间**: 2周
**功能**:
- HTML/CSS/JS 代码生成
- 实时预览（iframe沙箱）
- 响应式测试（多设备预览）
- 代码美化和验证

**技术实现**:
- 代码编辑器: Monaco Editor
- 预览: iframe + postMessage
- 模板: Jinja2 (Python后端)
- AI: GPT-4 代码生成

#### 任务 3.2: 文档处理引擎
**时间**: 2周
**功能**:
- Word文档生成和编辑
- PDF生成和查看
- Markdown编辑器
- 文档格式转换

**技术实现**:
- Word: python-docx (后端)
- PDF: ReportLab (后端)
- Markdown: markdown-it + vditor (前端)

#### 任务 3.3: 数据处理引擎
**时间**: 2周
**功能**:
- Excel/CSV 数据导入导出
- 数据清洗和转换
- 图表生成（echarts）
- 数据透视表

**技术实现**:
- 后端: pandas + openpyxl
- 前端: ag-grid + echarts
- AI: 自然语言查询 → SQL

#### 任务 3.4: 演示文稿引擎
**时间**: 1周
**功能**:
- PPT模板选择
- AI生成大纲和内容
- 图表和图片插入
- PPT预览和导出

**技术实现**:
- 后端: python-pptx
- AI: GPT-4 内容生成

#### 任务 3.5: 图像处理引擎
**时间**: 1周
**功能**:
- AI绘图 (文生图)
- 图片编辑（裁剪、滤镜）
- 批量处理

**技术实现**:
- AI: Stable Diffusion (本地) / DALL-E (API)
- 图片处理: Pillow (后端)

### 阶段四：项目协作功能（Week 13-15）

#### 任务 4.1: 项目分享和权限管理
**时间**: 1周
**功能**:
- 生成分享链接/二维码
- 权限设置（查看/编辑/管理）
- 协作者邀请
- 权限变更日志

#### 任务 4.2: 实时协同编辑
**时间**: 1.5周
**功能**:
- WebSocket实时同步
- 多人光标显示
- 冲突检测和解决
- 变更历史

**技术实现**:
- WebSocket: Socket.io
- OT算法: ShareDB
- 冲突解决: AI辅助合并

#### 任务 4.3: 评论和批注系统
**时间**: 0.5周
**功能**:
- 文件评论
- 行级批注（代码）
- @提醒功能
- 评论解决状态

### 阶段五：项目市场和交易（Week 16-18）

#### 任务 5.1: 项目模板市场
**时间**: 1周
**功能**:
- 模板浏览和搜索
- 模板预览
- 模板使用和收藏
- 用户上传模板

#### 任务 5.2: 项目商品化
**时间**: 1周
**功能**:
- 项目打包和定价
- 商品描述生成（AI）
- 演示内容生成
- 发布到市场

#### 任务 5.3: 项目交易流程
**时间**: 1周
**功能**:
- 项目购买和支付
- 智能合约托管
- 项目交付
- 评价系统

### 阶段六：与其他模块集成（Week 19-21）

#### 任务 6.1: 与知识库集成
**时间**: 1周
**功能**:
- 项目引用知识（@知识条目）
- RAG检索知识库
- 项目经验自动保存为知识
- 项目模板保存到知识库

#### 任务 6.2: 与社交模块集成
**时间**: 1周
**功能**:
- 项目分享到动态
- DID身份验证协作者
- P2P文件同步

#### 任务 6.3: 与交易模块集成
**时间**: 1周
**功能**:
- 项目作为商品
- 智能合约管理
- 信誉评分关联

### 阶段七：测试和优化（Week 22-24）

#### 任务 7.1: 功能测试
- 单元测试
- 集成测试
- 端到端测试
- 性能测试

#### 任务 7.2: 用户体验优化
- UI/UX优化
- 性能优化
- 错误处理优化
- 用户反馈收集

#### 任务 7.3: 文档编写
- API文档
- 用户手册
- 开发文档
- 部署文档

---

## 三、技术架构和技术栈

### 3.1 前端技术栈

#### PC端（Electron + Vue3）
```
框架: Vue 3 + TypeScript
UI库: Ant Design Vue 4.x
状态管理: Pinia
路由: Vue Router 4
代码编辑器: Monaco Editor
Markdown: marked + highlight.js
图表: ECharts 5
实时通信: Socket.io-client
构建工具: Vite
```

#### 移动端（UniApp）
```
框架: UniApp (Vue 3)
UI库: uView UI 2.0
状态管理: Pinia
图表: uCharts
工具库: lodash-es
```

### 3.2 后端技术栈

```
语言: Python 3.10+
Web框架: FastAPI
数据库: SQLCipher (加密SQLite)
向量数据库: ChromaDB
Git操作: GitPython
异步任务: Celery + Redis
实时通信: Socket.io

AI相关:
- LLM: GPT-4 / Claude-3 (API) + Ollama (本地)
- Embedding: bge-large-zh-v1.5
- RAG: LangChain
- Agent: AutoGPT

文件处理:
- Word: python-docx
- PDF: ReportLab, pdfplumber
- Excel: pandas, openpyxl
- PPT: python-pptx
- 图像: Pillow, Stable Diffusion
- 视频: moviepy, FFmpeg
```

### 3.3 数据库设计

**核心表**:
- `projects` - 项目表
- `project_files` - 项目文件表
- `project_tasks` - 任务记录表
- `project_conversations` - 对话历史表
- `project_collaborators` - 协作者表
- `project_templates` - 项目模板表
- `project_marketplace_listings` - 市场商品表
- `project_knowledge_links` - 知识关联表

（详见《系统设计_个人移动AI管理系统.md》 2.4.4节）

---

## 四、里程碑和验收标准

### Milestone 1: 菜单重构完成 (Week 2)
**验收标准**:
- ✅ PC端和移动端菜单全部更新
- ✅ 项目管理模块菜单置于首位
- ✅ 所有菜单项可点击，有占位页面
- ✅ 图标资源准备完毕

### Milestone 2: 项目基础功能 (Week 6)
**验收标准**:
- ✅ 可以创建项目（选择模板）
- ✅ 可以查看项目列表
- ✅ 可以打开项目详情
- ✅ 可以进行AI对话
- ✅ 文件可以保存到项目文件夹

### Milestone 3: 文件处理引擎 (Week 12)
**验收标准**:
- ✅ 支持Web开发（HTML/CSS/JS生成和预览）
- ✅ 支持文档处理（Word/PDF生成）
- ✅ 支持数据分析（Excel导入和图表生成）
- ✅ 支持PPT生成
- ✅ 至少一个完整的端到端案例演示

### Milestone 4: 协作和交易 (Week 18)
**验收标准**:
- ✅ 可以分享项目给好友
- ✅ 多人可以协作编辑
- ✅ 可以上传项目到市场
- ✅ 可以购买和下载项目

### Milestone 5: 全功能上线 (Week 24)
**验收标准**:
- ✅ 所有设计功能已实现
- ✅ 通过完整测试
- ✅ 性能达标（AI响应<5s，页面加载<2s）
- ✅ 文档齐全

---

## 五、风险和应对措施

### 5.1 技术风险

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| AI模型响应慢 | 用户体验差 | 1. 使用流式输出 2. 本地小模型预处理 3. 缓存常见结果 |
| 文件处理性能问题 | 大文件处理卡顿 | 1. 后台异步处理 2. 进度提示 3. 文件大小限制 |
| 实时协同冲突 | 数据不一致 | 1. OT算法 2. AI辅助合并 3. 版本历史回溯 |
| 跨平台兼容性 | 功能不一致 | 1. 优先保证PC端 2. 移动端精简功能 3. 充分测试 |

### 5.2 资源风险

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| 开发周期过长 | 延期上线 | 1. 采用敏捷开发 2. MVP优先 3. 阶段性发布 |
| AI API成本高 | 运营成本大 | 1. 优先使用本地模型 2. 实施Token限额 3. 缓存策略 |
| 人力不足 | 进度缓慢 | 1. 外包部分UI工作 2. 使用现成组件库 3. 降低部分功能优先级 |

### 5.3 产品风险

| 风险 | 影响 | 应对措施 |
|------|------|----------|
| 用户需求变化 | 功能不匹配 | 1. 早期用户测试 2. 快速迭代 3. 保持灵活性 |
| 竞品压力 | 市场份额 | 1. 突出去中心化特色 2. AI能力差异化 3. 社区运营 |

---

## 六、资源需求

### 6.1 人力需求

| 角色 | 人数 | 工作内容 |
|------|------|----------|
| 前端开发 (PC) | 2人 | Electron + Vue3 开发 |
| 前端开发 (移动) | 1人 | UniApp 开发 |
| 后端开发 | 2人 | FastAPI + AI集成 |
| UI/UX设计师 | 1人 | 界面设计、图标设计 |
| 测试工程师 | 1人 | 功能测试、自动化测试 |
| 项目经理 | 1人 | 进度管理、协调 |

### 6.2 硬件和服务

| 资源 | 规格 | 用途 |
|------|------|------|
| 开发服务器 | 16C 64G GPU | AI模型推理 |
| 数据库服务器 | 8C 32G | 数据存储 |
| 对象存储 | 1TB | 文件存储 |
| GPU服务器 | RTX 4090 | Stable Diffusion本地部署 |

### 6.3 第三方服务

| 服务 | 用途 | 预估成本 |
|------|------|----------|
| OpenAI API | GPT-4调用 | $1000/月 |
| Anthropic API | Claude-3调用 | $500/月 |
| Git托管 | 代码仓库 | 免费(GitHub) |

---

## 七、后续迭代方向

### V2.0 功能规划
- 视频处理引擎完整实现
- 高级AI Agent（自主完成复杂任务）
- 插件系统（用户自定义工具）
- 移动端完整功能同步

### V3.0 功能规划
- 多人实时协同白板
- AI代码审查和优化
- 自动化工作流（定时任务、触发器）
- 区块链集成增强

---

## 八、附录

### A. 参考文档
- 《系统设计_个人移动AI管理系统.md》
- Ant Design Vue 官方文档
- UniApp 官方文档
- LangChain 文档
- FastAPI 文档

### B. 相关链接
- 设计稿: [Figma链接]
- 项目管理: [Jira看板]
- 代码仓库: [GitHub仓库]
- API文档: [Swagger地址]

---

**文档版本**: v1.0
**创建日期**: 2025-12-21
**最后更新**: 2025-12-21
**负责人**: 项目组
