# P2P功能手动测试清单

## 测试前准备

### 环境检查
- [ ] 桌面应用已启动
- [ ] 信令服务器运行正常 (ws://localhost:9001)
- [ ] 至少有两个测试账号
- [ ] 麦克风和摄像头权限已授予
- [ ] 网络连接正常

### 测试账号
- 账号A: Alice (did:test:alice)
- 账号B: Bob (did:test:bob)

---

## 1. P2P连接测试

### 1.1 基础连接
- [ ] 打开社交页面
- [ ] 查看在线好友列表
- [ ] 点击好友头像查看详情
- [ ] 检查连接状态显示

### 1.2 连接建立
- [ ] 点击"发起通话"按钮
- [ ] 观察连接状态变化
- [ ] 确认连接成功提示
- [ ] 检查连接指示灯为绿色

### 1.3 连接断开
- [ ] 点击"挂断"按钮
- [ ] 确认连接断开提示
- [ ] 检查连接指示灯变灰
- [ ] 验证资源已释放

---

## 2. 语音通话测试

### 2.1 发起语音通话
- [ ] 选择好友
- [ ] 点击"语音通话"按钮
- [ ] 等待对方接听
- [ ] 确认通话界面显示正常

### 2.2 接听语音通话
- [ ] 收到来电通知
- [ ] 显示来电者信息
- [ ] 点击"接听"按钮
- [ ] 确认通话建立

### 2.3 语音通话功能
- [ ] 测试静音功能
  - [ ] 点击静音按钮
  - [ ] 确认对方听不到声音
  - [ ] 取消静音
  - [ ] 确认对方能听到声音

- [ ] 测试音量调节
  - [ ] 调整音量滑块
  - [ ] 确认音量变化

- [ ] 测试音频设备切换
  - [ ] 打开设备选择菜单
  - [ ] 切换到不同麦克风
  - [ ] 确认音频输入正常
  - [ ] 切换到不同扬声器
  - [ ] 确认音频输出正常

### 2.4 通话质量
- [ ] 检查音频清晰度
- [ ] 检查延迟（<200ms）
- [ ] 检查是否有杂音
- [ ] 检查是否有回音

### 2.5 通话结束
- [ ] 点击"挂断"按钮
- [ ] 确认通话结束提示
- [ ] 检查通话时长显示
- [ ] 验证通话记录已保存

---

## 3. 视频通话测试

### 3.1 发起视频通话
- [ ] 选择好友
- [ ] 点击"视频通话"按钮
- [ ] 等待对方接听
- [ ] 确认视频窗口显示

### 3.2 接听视频通话
- [ ] 收到视频来电通知
- [ ] 显示来电者信息
- [ ] 点击"接听"按钮
- [ ] 确认双方视频显示

### 3.3 视频通话功能
- [ ] 测试视频开关
  - [ ] 点击关闭视频
  - [ ] 确认对方看不到视频
  - [ ] 开启视频
  - [ ] 确认对方能看到视频

- [ ] 测试摄像头切换
  - [ ] 打开摄像头选择菜单
  - [ ] 切换到不同摄像头
  - [ ] 确认视频画面切换

- [ ] 测试画面调整
  - [ ] 切换大小画面
  - [ ] 调整画面比例
  - [ ] 全屏显示
  - [ ] 退出全屏

### 3.4 视频质量
- [ ] 检查画面清晰度
- [ ] 检查帧率（>15fps）
- [ ] 检查延迟（<300ms）
- [ ] 检查是否有卡顿

### 3.5 同时测试音频
- [ ] 确认音频正常
- [ ] 测试静音功能
- [ ] 测试音量调节

---

## 4. 屏幕共享测试

### 4.1 开始屏幕共享
- [ ] 在通话中点击"共享屏幕"
- [ ] 选择要共享的屏幕/窗口
- [ ] 确认共享开始
- [ ] 对方能看到共享内容

### 4.2 屏幕共享功能
- [ ] 测试全屏共享
  - [ ] 选择整个屏幕
  - [ ] 确认对方看到完整屏幕

- [ ] 测试窗口共享
  - [ ] 选择特定窗口
  - [ ] 确认对方只看到该窗口

- [ ] 测试共享控制
  - [ ] 暂停共享
  - [ ] 恢复共享
  - [ ] 停止共享

### 4.3 共享质量
- [ ] 检查画面清晰度
- [ ] 检查帧率（>10fps）
- [ ] 检查延迟
- [ ] 检查CPU使用率

### 4.4 结束共享
- [ ] 点击"停止共享"
- [ ] 确认共享结束
- [ ] 恢复正常视频

---

## 5. 通话历史测试

### 5.1 查看通话历史
- [ ] 打开通话历史页面
- [ ] 查看历史记录列表
- [ ] 确认记录信息完整
  - [ ] 通话对象
  - [ ] 通话类型（语音/视频）
  - [ ] 通话时长
  - [ ] 通话时间

### 5.2 历史记录操作
- [ ] 点击记录查看详情
- [ ] 从历史发起回拨
- [ ] 删除单条记录
- [ ] 搜索历史记录
- [ ] 筛选记录类型

### 5.3 统计信息
- [ ] 查看总通话次数
- [ ] 查看总通话时长
- [ ] 查看通话类型分布
- [ ] 查看通话趋势图

### 5.4 清空历史
- [ ] 点击"清空历史"
- [ ] 确认清空提示
- [ ] 验证历史已清空

---

## 6. 连接质量监控测试

### 6.1 质量指标显示
- [ ] 查看连接质量指示器
- [ ] 确认质量等级显示
  - [ ] 优秀（绿色）
  - [ ] 良好（黄色）
  - [ ] 一般（橙色）
  - [ ] 较差（红色）

### 6.2 网络统计
- [ ] 查看RTT（往返延迟）
- [ ] 查看丢包率
- [ ] 查看带宽使用
- [ ] 查看编解码信息

### 6.3 质量警告
- [ ] 模拟网络变差
- [ ] 确认质量警告提示
- [ ] 查看优化建议

---

## 7. 异常场景测试

### 7.1 网络异常
- [ ] 断开网络连接
- [ ] 确认断线提示
- [ ] 恢复网络连接
- [ ] 确认自动重连

### 7.2 设备异常
- [ ] 拔掉麦克风
- [ ] 确认设备丢失提示
- [ ] 插回麦克风
- [ ] 确认设备恢复

### 7.3 权限异常
- [ ] 拒绝麦克风权限
- [ ] 确认权限请求提示
- [ ] 授予权限
- [ ] 确认功能恢复

### 7.4 对方异常
- [ ] 对方强制关闭应用
- [ ] 确认通话结束提示
- [ ] 对方网络断开
- [ ] 确认重连或结束

---

## 8. 性能测试

### 8.1 资源使用
- [ ] 打开任务管理器
- [ ] 发起视频通话
- [ ] 检查CPU使用率（<30%）
- [ ] 检查内存使用（<200MB）
- [ ] 检查网络带宽

### 8.2 长时间通话
- [ ] 发起通话
- [ ] 保持通话30分钟
- [ ] 检查是否稳定
- [ ] 检查资源使用变化
- [ ] 检查是否有内存泄漏

### 8.3 多次通话
- [ ] 连续发起10次通话
- [ ] 每次通话1分钟
- [ ] 检查成功率
- [ ] 检查性能稳定性

---

## 9. 用户体验测试

### 9.1 界面响应
- [ ] 点击按钮响应速度（<100ms）
- [ ] 页面切换流畅度
- [ ] 动画效果流畅
- [ ] 无卡顿现象

### 9.2 操作便捷性
- [ ] 一键发起通话
- [ ] 快速接听/拒绝
- [ ] 设备切换方便
- [ ] 功能按钮易找

### 9.3 提示信息
- [ ] 错误提示清晰
- [ ] 状态反馈及时
- [ ] 帮助信息完整
- [ ] 确认对话框合理

---

## 10. 兼容性测试

### 10.1 不同操作系统
- [ ] macOS测试
- [ ] Windows测试
- [ ] Linux测试

### 10.2 不同网络环境
- [ ] WiFi网络
- [ ] 有线网络
- [ ] 移动热点
- [ ] VPN环境

### 10.3 不同设备
- [ ] 内置麦克风/摄像头
- [ ] USB麦克风/摄像头
- [ ] 蓝牙耳机
- [ ] 外接显示器

---

## 测试结果记录

### 通过的测试
```
记录通过的测试项目...
```

### 失败的测试
```
记录失败的测试项目和错误信息...
```

### 发现的问题
```
1. 问题描述
   - 重现步骤
   - 预期结果
   - 实际结果
   - 严重程度
   - 截图/日志
```

---

## 测试签名

**测试人员**: _______________
**测试日期**: _______________
**测试版本**: v0.21.0
**测试结果**: [ ] 通过 [ ] 不通过

---

**备注**:
- 所有测试项目必须完成
- 发现问题及时记录
- 严重问题立即报告
- 保存测试截图和日志
