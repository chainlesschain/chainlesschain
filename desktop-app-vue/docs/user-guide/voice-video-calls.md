# P2P语音/视频通话用户指南

## 概述

ChainlessChain支持完全去中心化的P2P语音和视频通话功能。所有通话都是点对点加密的，无需经过任何中心服务器，确保您的隐私和安全。

## 功能特性

### ✅ 支持的功能

- **语音通话**: 高质量的P2P语音通话
- **视频通话**: 支持720p/1080p高清视频通话
- **通话控制**: 静音/取消静音、开启/关闭视频
- **通话质量监控**: 实时显示网络质量和通话统计
- **多设备支持**: 支持PC端和移动端互通
- **设备选择**: 可选择麦克风、扬声器和摄像头
- **通话记录**: 自动记录通话历史

### 🔒 安全特性

- **端到端加密**: 所有通话数据都经过加密
- **P2P直连**: 无需中心服务器中转
- **NAT穿透**: 自动处理网络穿透问题
- **身份验证**: 基于DID的身份验证

## 快速开始

### 发起语音通话

1. 打开联系人列表或聊天窗口
2. 点击联系人头像旁的**电话图标** 📞
3. 等待对方接听
4. 开始通话

### 发起视频通话

1. 打开联系人列表或聊天窗口
2. 点击联系人头像旁的**视频图标** 📹
3. 等待对方接听
4. 开始视频通话

### 接听来电

当有来电时，会弹出来电通知窗口：

- **绿色按钮**: 接听通话
- **红色按钮**: 拒绝通话

## 通话控制

### 通话中的操作

在通话过程中，您可以使用以下控制按钮：

| 按钮 | 功能 | 说明 |
|------|------|------|
| 🔇 | 静音/取消静音 | 关闭/开启麦克风 |
| 📹 | 开启/关闭视频 | 仅视频通话可用 |
| 📞 | 挂断 | 结束当前通话 |
| ⚙️ | 设置 | 打开通话设置 |

### 通话设置

点击**设置按钮**可以：

- 选择麦克风设备
- 选择扬声器设备
- 选择摄像头设备（视频通话）
- 查看通话统计信息

## 通话质量

### 质量指示器

通话窗口左上角显示实时网络质量：

- 🟢 **良好**: 网络状况良好，通话质量优秀
- 🟡 **一般**: 网络有轻微波动，通话基本正常
- 🔴 **较差**: 网络状况不佳，可能出现卡顿

### 通话统计

在设置面板中可以查看详细的通话统计：

- **接收数据**: 接收的数据量
- **发送数据**: 发送的数据量
- **丢包数**: 网络丢包数量
- **延迟**: 网络往返延迟（RTT）

## 常见问题

### Q: 为什么对方听不到我的声音？

**A**: 请检查以下几点：
1. 确认麦克风未被静音
2. 检查麦克风设备是否正确选择
3. 确认浏览器/应用有麦克风权限
4. 尝试重新插拔麦克风设备

### Q: 为什么看不到视频画面？

**A**: 请检查以下几点：
1. 确认视频未被关闭
2. 检查摄像头设备是否正确选择
3. 确认浏览器/应用有摄像头权限
4. 检查摄像头是否被其他应用占用

### Q: 通话质量不好怎么办？

**A**: 可以尝试：
1. 检查网络连接是否稳定
2. 关闭其他占用带宽的应用
3. 切换到语音通话（降低带宽需求）
4. 更换网络环境

### Q: 无法连接到对方？

**A**: 可能的原因：
1. 对方不在线
2. 网络防火墙阻止了P2P连接
3. NAT类型不兼容（极少数情况）

**解决方法**:
- 确认对方在线
- 检查防火墙设置
- 尝试使用VPN或更换网络

### Q: 通话突然中断？

**A**: 可能的原因：
1. 网络连接中断
2. 对方主动挂断
3. 应用崩溃

**解决方法**:
- 检查网络连接
- 重新发起通话
- 重启应用

## 系统要求

### 最低配置

- **操作系统**: Windows 10+, macOS 10.14+, Linux
- **处理器**: Intel Core i3 或同等性能
- **内存**: 4GB RAM
- **网络**: 宽带互联网连接（上传/下载 ≥ 1Mbps）
- **摄像头**: 支持720p的摄像头（视频通话）
- **麦克风**: 任何标准麦克风

### 推荐配置

- **操作系统**: Windows 11, macOS 12+, Ubuntu 20.04+
- **处理器**: Intel Core i5 或更高
- **内存**: 8GB RAM
- **网络**: 宽带互联网连接（上传/下载 ≥ 5Mbps）
- **摄像头**: 支持1080p的摄像头
- **麦克风**: 带降噪功能的麦克风

### 网络要求

| 通话类型 | 最低带宽 | 推荐带宽 |
|---------|---------|---------|
| 语音通话 | 上传/下载 100Kbps | 上传/下载 500Kbps |
| 视频通话(720p) | 上传/下载 1Mbps | 上传/下载 2Mbps |
| 视频通话(1080p) | 上传/下载 2Mbps | 上传/下载 5Mbps |

## 隐私和安全

### 数据加密

- 所有通话数据使用**DTLS加密**
- 媒体流使用**SRTP加密**
- 信令消息通过**libp2p加密通道**传输

### 数据存储

- **不存储通话内容**: 所有通话内容都是实时传输，不会被存储
- **通话记录**: 仅存储通话时间、时长等元数据
- **本地存储**: 所有数据都存储在本地，不上传到云端

### 权限管理

应用需要以下权限：

- **麦克风权限**: 用于语音通话
- **摄像头权限**: 用于视频通话
- **网络权限**: 用于P2P连接

您可以随时在系统设置中撤销这些权限。

## 高级功能

### 通话录制（即将推出）

未来版本将支持：
- 本地通话录制
- 录制文件加密存储
- 录制权限管理

### 屏幕共享（即将推出）

未来版本将支持：
- 共享整个屏幕
- 共享特定窗口
- 共享特定应用

### 群组通话（即将推出）

未来版本将支持：
- 多人语音会议
- 多人视频会议
- 会议管理功能

## 快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl/Cmd + M` | 静音/取消静音 |
| `Ctrl/Cmd + E` | 挂断通话 |
| `Ctrl/Cmd + D` | 开启/关闭视频 |
| `Esc` | 退出全屏 |

## 故障排除

### 诊断工具

1. **网络诊断**: 设置 → P2P → 网络诊断
2. **设备测试**: 设置 → 音视频 → 设备测试
3. **日志查看**: 帮助 → 查看日志

### 重置设置

如果遇到持续性问题，可以尝试重置通话设置：

1. 打开设置
2. 进入"音视频"选项卡
3. 点击"重置为默认设置"
4. 重启应用

### 联系支持

如果问题仍未解决，请：

1. 收集日志文件（帮助 → 导出日志）
2. 访问 [GitHub Issues](https://github.com/chainlesschain/chainlesschain/issues)
3. 提交问题报告，附上日志文件

## 最佳实践

### 获得最佳通话质量

1. **使用有线网络**: 有线连接比WiFi更稳定
2. **关闭不必要的应用**: 释放系统资源
3. **选择合适的设备**: 使用质量好的麦克风和摄像头
4. **保持应用更新**: 及时更新到最新版本
5. **优化网络环境**: 避免网络拥堵时段

### 保护隐私

1. **验证身份**: 确认对方身份后再接听
2. **注意环境**: 注意通话环境的隐私
3. **定期检查权限**: 定期检查应用权限设置
4. **使用加密**: 确保端到端加密已启用

## 更新日志

### v0.17.0 (2026-01-11)

- ✨ 新增P2P语音通话功能
- ✨ 新增P2P视频通话功能
- ✨ 新增通话质量监控
- ✨ 新增设备选择功能
- 🐛 修复NAT穿透问题
- 📝 完善用户文档

## 反馈和建议

我们非常重视您的反馈！如果您有任何建议或问题，请通过以下方式联系我们：

- **GitHub Issues**: https://github.com/chainlesschain/chainlesschain/issues
- **邮箱**: support@chainlesschain.com
- **社区论坛**: https://forum.chainlesschain.com

感谢您使用ChainlessChain！
