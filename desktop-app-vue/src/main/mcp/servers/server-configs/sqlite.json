{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SQLite Server Configuration",
  "description": "Configuration schema for @modelcontextprotocol/server-sqlite",
  "type": "object",

  "properties": {
    "enabled": {
      "type": "boolean",
      "default": false,
      "description": "Enable or disable the SQLite server"
    },

    "command": {
      "type": "string",
      "default": "npx",
      "description": "Command to launch the server"
    },

    "args": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "default": ["-y", "@modelcontextprotocol/server-sqlite"],
      "description": "Arguments to pass to the command"
    },

    "databasePath": {
      "type": "string",
      "description": "Path to SQLite database file (absolute path)",
      "examples": [
        "D:\\code\\chainlesschain\\data\\chainlesschain.db",
        "/Users/username/chainlesschain/data/app.db"
      ]
    },

    "autoConnect": {
      "type": "boolean",
      "default": false,
      "description": "Automatically connect on application startup"
    },

    "permissions": {
      "type": "object",
      "description": "Permission configuration for database access",
      "properties": {
        "allowedTables": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": ["notes", "tags", "bookmarks"],
          "description": "Tables that are allowed for operations"
        },

        "forbiddenTables": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "default": ["users", "credentials", "private_keys"],
          "description": "Tables that are always blocked"
        },

        "readOnly": {
          "type": "boolean",
          "default": true,
          "description": "If true, only SELECT queries are allowed"
        },

        "maxResultRows": {
          "type": "integer",
          "default": 1000,
          "description": "Maximum number of rows to return"
        },

        "allowWrites": {
          "type": "boolean",
          "default": false,
          "description": "Allow INSERT, UPDATE, DELETE operations"
        },

        "allowSchemaChanges": {
          "type": "boolean",
          "default": false,
          "description": "Allow CREATE TABLE, ALTER TABLE, DROP TABLE"
        }
      },
      "required": ["readOnly"]
    },

    "features": {
      "type": "object",
      "description": "Feature flags for database operations",
      "properties": {
        "enableTransactions": {
          "type": "boolean",
          "default": false,
          "description": "Enable transaction support (BEGIN, COMMIT, ROLLBACK)"
        },

        "enableFTS": {
          "type": "boolean",
          "default": true,
          "description": "Enable full-text search capabilities"
        },

        "enableJSON": {
          "type": "boolean",
          "default": true,
          "description": "Enable JSON1 extension"
        },

        "enableExplainPlan": {
          "type": "boolean",
          "default": true,
          "description": "Enable EXPLAIN QUERY PLAN for optimization"
        }
      }
    },

    "performance": {
      "type": "object",
      "description": "Performance tuning options",
      "properties": {
        "timeout": {
          "type": "integer",
          "default": 30000,
          "description": "Query timeout in milliseconds"
        },

        "cacheSize": {
          "type": "integer",
          "default": 2000,
          "description": "SQLite cache size in pages (default: 2000 pages)"
        },

        "journalMode": {
          "type": "string",
          "enum": ["DELETE", "TRUNCATE", "PERSIST", "MEMORY", "WAL", "OFF"],
          "default": "WAL",
          "description": "SQLite journal mode"
        },

        "synchronous": {
          "type": "string",
          "enum": ["OFF", "NORMAL", "FULL", "EXTRA"],
          "default": "NORMAL",
          "description": "SQLite synchronous mode"
        }
      }
    },

    "logging": {
      "type": "object",
      "description": "Logging configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "default": true,
          "description": "Enable audit logging"
        },

        "logQueries": {
          "type": "boolean",
          "default": true,
          "description": "Log all SQL queries"
        },

        "logLevel": {
          "type": "string",
          "enum": ["debug", "info", "warn", "error"],
          "default": "info",
          "description": "Logging level"
        },

        "logPath": {
          "type": "string",
          "default": ".chainlesschain/logs/mcp-sqlite.log",
          "description": "Path to log file (relative to app root)"
        }
      }
    }
  },

  "required": ["databasePath"],

  "examples": [
    {
      "enabled": false,
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-sqlite",
        "D:\\code\\chainlesschain\\data\\chainlesschain.db"
      ],
      "databasePath": "D:\\code\\chainlesschain\\data\\chainlesschain.db",
      "autoConnect": false,
      "permissions": {
        "allowedTables": ["notes", "tags", "bookmarks"],
        "forbiddenTables": ["users", "credentials"],
        "readOnly": true,
        "maxResultRows": 1000
      },
      "features": {
        "enableTransactions": false,
        "enableFTS": true,
        "enableJSON": true
      },
      "performance": {
        "timeout": 30000,
        "journalMode": "WAL",
        "synchronous": "NORMAL"
      },
      "logging": {
        "enabled": true,
        "logQueries": true,
        "logLevel": "info"
      }
    }
  ]
}
