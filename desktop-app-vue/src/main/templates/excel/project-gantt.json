{
  "id": "tpl_excel_project_gantt_001",
  "name": "project_gantt_chart",
  "display_name": "施工项目甘特图",
  "description": "用于项目进度管理的甘特图表格，支持任务分解、时间规划、资源分配",
  "icon": "📊",
  "cover_image": "/templates/covers/gantt-chart.png",

  "category": "excel",
  "subcategory": "planning",
  "tags": ["项目管理", "甘特图", "进度", "规划"],

  "project_type": "data",

  "prompt_template": "请帮我生成一份{{projectName}}的项目甘特图Excel表格，要求：\n\n**项目信息：**\n- 项目名称：{{projectName}}\n- 项目周期：{{projectDuration}}天\n- 开始日期：{{startDate}}\n- 项目阶段数：{{phaseCount}}\n- 项目类型：{{projectType}}\n\n**Excel表格结构：**\n\n【工作表1：项目信息概览】\n- A1单元格：项目名称（{{projectName}}）\n- A2-A4：基本信息（负责人、开始日期{{startDate}}、结束日期自动计算）\n- A6-B15：项目里程碑列表（阶段名称、目标日期）\n- D1-E5：整体进度汇总（已完成任务数、进度百分比、剩余工期）\n\n【工作表2：甘特图主表】\n表头（第1行）：\n| A列：任务ID | B列：任务名称 | C列：负责人 | D列：开始日期 | E列：结束日期 | F列：工期（天） | G列：前置任务ID | H列：完成度(%) | I列：状态 | J-Z列：时间轴（每列代表一天）|\n\n数据行要求：\n- 根据{{phaseCount}}个阶段，生成{{taskCount}}个具体任务\n- F列工期公式：=DAYS(E2,D2)+1\n- H列完成度：0-100的数字\n- I列状态：使用数据验证（未开始/进行中/已完成/已逾期）\n\n时间轴甘特图（J-Z列）：\n- 第1行：日期序列（从{{startDate}}开始）\n- 使用条件格式规则：\n  规则1：如果当前日期在任务开始和结束之间，填充蓝色背景（RGB: 68, 114, 196）\n  规则2：如果是周末，填充浅灰色（RGB: 217, 217, 217）\n  规则3：如果任务已完成，填充绿色（RGB: 146, 208, 80）\n  规则4：如果任务逾期（结束日期<TODAY()且完成度<100），填充红色（RGB: 255, 0, 0）\n\n【工作表3：资源分配表】\n- A列：资源名称（人员/设备）\n- B列：资源类型\n- C-Z列：每日工作量分配（小时数）\n- 底部：每日资源利用率统计\n\n【工作表4：里程碑追踪】\n- 里程碑名称、计划日期、实际日期、状态、偏差天数\n\n**Excel公式和功能：**\n1. 工期自动计算：=DAYS(结束日期, 开始日期)+1\n2. 进度百分比：=COUNTIF(状态列,\"已完成\")/COUNTA(状态列)\n3. 条件格式：使用上述4条规则\n4. 数据验证：状态列使用下拉列表\n5. 图表：插入条形图展示各阶段进度对比\n\n**格式要求：**\n- 表头使用深蓝色背景（RGB: 68, 114, 196），白色粗体文字\n- 冻结首行和前3列\n- 所有列自动调整列宽\n- 添加边框线",

  "variables_schema": [
    {
      "name": "projectName",
      "label": "项目名称",
      "type": "string",
      "required": true,
      "placeholder": "例如：办公楼建设项目"
    },
    {
      "name": "projectType",
      "label": "项目类型",
      "type": "select",
      "required": false,
      "default": "软件开发",
      "options": [
        { "value": "软件开发", "label": "软件开发" },
        { "value": "工程建设", "label": "工程建设" },
        { "value": "产品研发", "label": "产品研发" },
        { "value": "营销活动", "label": "营销活动" },
        { "value": "咨询项目", "label": "咨询项目" }
      ]
    },
    {
      "name": "projectDuration",
      "label": "项目周期（天）",
      "type": "number",
      "required": false,
      "default": 90,
      "min": 7,
      "max": 365
    },
    {
      "name": "startDate",
      "label": "开始日期",
      "type": "string",
      "required": false,
      "default": "2025-01-01",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "placeholder": "格式：yyyy-MM-dd"
    },
    {
      "name": "phaseCount",
      "label": "项目阶段数",
      "type": "number",
      "required": false,
      "default": 5,
      "min": 3,
      "max": 20
    },
    {
      "name": "taskCount",
      "label": "预估任务数",
      "type": "number",
      "required": false,
      "default": 20,
      "min": 5,
      "max": 100,
      "placeholder": "整个项目的任务总数"
    }
  ],

  "file_structure": {
    "root": "{{projectName}}-甘特图",
    "files": [
      {
        "path": "{{projectName}}-项目甘特图.xlsx",
        "type": "spreadsheet"
      }
    ]
  },

  "default_files": [],

  "is_builtin": true,
  "author": "ChainlessChain Team",
  "version": "1.0.0",
  "usage_count": 0,
  "rating": 0,
  "rating_count": 0
}
