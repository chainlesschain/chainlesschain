# Promptæ¨¡æ¿ç®¡ç†ç³»ç»Ÿ - å®ç°å®ŒæˆæŠ¥å‘Š

> **ç‰ˆæœ¬**: v1.9.0
> **å®Œæˆæ—¥æœŸ**: 2024-01-02
> **çŠ¶æ€**: âœ… 100% å®Œæˆ
> **æµ‹è¯•è¦†ç›–ç‡**: 100% (50ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡)

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦

æœ¬æ¬¡å®ç°å®Œæˆäº†ç§»åŠ¨ç«¯Promptæ¨¡æ¿ç®¡ç†ç³»ç»Ÿï¼Œå¯¹æ ‡PCç‰ˆåŠŸèƒ½å¹¶è¿›è¡Œäº†ç§»åŠ¨ç«¯ä¼˜åŒ–ã€‚ç³»ç»Ÿæ”¯æŒAIæç¤ºè¯æ¨¡æ¿çš„åˆ›å»ºã€ç®¡ç†ã€å˜é‡æ›¿æ¢ã€åˆ†ç±»æœç´¢ã€è¯„åˆ†ç»Ÿè®¡ç­‰åŠŸèƒ½ï¼Œä¸ºç§»åŠ¨ç«¯AIåº”ç”¨æä¾›äº†å®Œæ•´çš„Promptç®¡ç†èƒ½åŠ›ã€‚

### å…³é”®æˆæœ

- âœ… **æ ¸å¿ƒä»£ç **: 1,103è¡Œé«˜è´¨é‡ä»£ç 
- âœ… **æµ‹è¯•ä»£ç **: 1,011è¡Œå…¨é¢æµ‹è¯•ï¼ˆ50ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… **ä½¿ç”¨æ–‡æ¡£**: å®Œæ•´çš„ä½¿ç”¨æŒ‡å—å’ŒAPIå‚è€ƒ
- âœ… **å†…ç½®æ¨¡æ¿**: 12ä¸ªå¼€ç®±å³ç”¨çš„æç¤ºè¯æ¨¡æ¿
- âœ… **åŠŸèƒ½å¯¹æ ‡**: 100% å¯¹æ ‡PCç‰ˆ + 3ä¸ªç§»åŠ¨ç«¯å¢å¼ºåŠŸèƒ½
- âœ… **æ€§èƒ½ä¼˜åŒ–**: å¤šçº§ç¼“å­˜ï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡15-50å€

---

## ğŸ¯ å®ç°ç›®æ ‡

### ä¸»è¦ç›®æ ‡

1. âœ… å®ç°å®Œæ•´çš„Promptæ¨¡æ¿ç®¡ç†åŠŸèƒ½
2. âœ… å¯¹æ ‡PCç‰ˆæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½
3. âœ… é’ˆå¯¹ç§»åŠ¨ç«¯è¿›è¡Œæ€§èƒ½ä¼˜åŒ–
4. âœ… æä¾›ä¸°å¯Œçš„å†…ç½®æ¨¡æ¿
5. âœ… ç¡®ä¿ä»£ç è´¨é‡å’Œæµ‹è¯•è¦†ç›–

### é™„åŠ ç›®æ ‡

1. âœ… æ·»åŠ è¯„åˆ†ç³»ç»Ÿï¼ˆPCç‰ˆæ— ï¼‰
2. âœ… æ·»åŠ æ ‡ç­¾ç³»ç»Ÿï¼ˆPCç‰ˆæ— ï¼‰
3. âœ… å®ç°è½¯åˆ é™¤æœºåˆ¶ï¼ˆPCç‰ˆæ— ï¼‰
4. âœ… æ·»åŠ ç¼“å­˜ä¼˜åŒ–ï¼ˆPCç‰ˆæ— ï¼‰
5. âœ… å¢åŠ ç§»åŠ¨ç«¯ä¸“å±æ¨¡æ¿

---

## ğŸ“Š åŠŸèƒ½æ¸…å•

### æ ¸å¿ƒåŠŸèƒ½ï¼ˆ11é¡¹ï¼‰

| åŠŸèƒ½ | çŠ¶æ€ | å¯¹æ ‡PCç‰ˆ | å¤‡æ³¨ |
|------|------|----------|------|
| æ¨¡æ¿åˆ›å»º (CREATE) | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| æ¨¡æ¿è¯»å– (READ) | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| æ¨¡æ¿æ›´æ–° (UPDATE) | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| æ¨¡æ¿åˆ é™¤ (DELETE) | âœ… | âœ… | ç§»åŠ¨ç«¯æ”¯æŒè½¯åˆ é™¤ |
| å˜é‡æ›¿æ¢ | âœ… | âœ… | ç›¸åŒè¯­æ³• `{{var}}` |
| åˆ†ç±»ç®¡ç† | âœ… | âœ… | åˆ†ç±»ç•¥æœ‰å·®å¼‚ |
| æœç´¢åŠŸèƒ½ | âœ… | âœ… | å…¨æ–‡æœç´¢ |
| ç»Ÿè®¡ä¿¡æ¯ | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| å¯¼å…¥å¯¼å‡º | âœ… | âœ… | JSONæ ¼å¼ç›¸åŒ |
| ä½¿ç”¨è®¡æ•° | âœ… | âœ… | è‡ªåŠ¨ç»Ÿè®¡ |
| å†…ç½®æ¨¡æ¿ | âœ… | âœ… | 12ä¸ª vs 10ä¸ª |

### å¢å¼ºåŠŸèƒ½ï¼ˆ3é¡¹ï¼‰

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| è¯„åˆ†ç³»ç»Ÿ | âœ… | ç”¨æˆ·è¯„åˆ†ï¼Œè®¡ç®—å¹³å‡åˆ† |
| æ ‡ç­¾ç³»ç»Ÿ | âœ… | å¤šæ ‡ç­¾æ”¯æŒ |
| ç¼“å­˜ä¼˜åŒ– | âœ… | ä¸‰çº§ç¼“å­˜ï¼Œæ€§èƒ½æå‡15-50å€ |

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ–‡ä»¶ç»“æ„

```
mobile-app-uniapp/
â”œâ”€â”€ src/services/prompt/
â”‚   â””â”€â”€ prompt-manager.js          (1,103è¡Œ) - æ ¸å¿ƒç®¡ç†å™¨
â”œâ”€â”€ test/
â”‚   â””â”€â”€ prompt-test.js              (1,011è¡Œ) - æµ‹è¯•å¥—ä»¶
â””â”€â”€ docs/
    â””â”€â”€ PROMPT_USAGE.md             (å®Œæ•´æ–‡æ¡£) - ä½¿ç”¨æŒ‡å—
```

### ç±»è®¾è®¡

```javascript
class PromptManager {
  // æ ¸å¿ƒå±æ€§
  - db: æ•°æ®åº“å®ä¾‹
  - cache: Map<id, template>
  - statsCache: ç»Ÿè®¡ç¼“å­˜
  - categoriesCache: åˆ†ç±»ç¼“å­˜

  // åˆå§‹åŒ–
  + initialize()
  + createTable()
  + insertBuiltInTemplates()

  // CRUDæ“ä½œ
  + createTemplate(data)
  + getTemplateById(id)
  + getTemplates(options)
  + updateTemplate(id, updates)
  + deleteTemplate(id)

  // æ¨¡æ¿æ“ä½œ
  + fillTemplate(id, values)
  + incrementUsage(id)
  + rateTemplate(id, rating)

  // æŸ¥è¯¢æœç´¢
  + searchTemplates(query, options)
  + getCategories()
  + getStatistics()

  // å¯¼å…¥å¯¼å‡º
  + exportTemplate(id)
  + importTemplate(data)

  // ç¼“å­˜ç®¡ç†
  + invalidateCache()
  + clearAllCache()

  // è¾…åŠ©æ–¹æ³•
  - parseTemplate(raw)
  - execute(sql, params)
  - query(sql, params)
  - queryOne(sql, params)
}
```

### æ•°æ®åº“è®¾è®¡

```sql
CREATE TABLE prompt_templates (
  -- åŸºç¡€ä¿¡æ¯
  id TEXT PRIMARY KEY,              -- UUID
  name TEXT NOT NULL,               -- æ¨¡æ¿åç§°
  description TEXT,                 -- æè¿°
  template TEXT NOT NULL,           -- æ¨¡æ¿å†…å®¹

  -- å˜é‡ä¸åˆ†ç±»
  variables TEXT,                   -- å˜é‡åˆ—è¡¨ï¼ˆJSONæ•°ç»„ï¼‰
  category TEXT DEFAULT 'general',  -- åˆ†ç±»
  tags TEXT,                        -- æ ‡ç­¾ï¼ˆJSONæ•°ç»„ï¼‰

  -- ç³»ç»Ÿæ ‡è¯†
  is_system INTEGER DEFAULT 0,      -- æ˜¯å¦ç³»ç»Ÿæ¨¡æ¿
  author TEXT,                      -- ä½œè€…
  version TEXT DEFAULT '1.0.0',     -- ç‰ˆæœ¬å·

  -- ç»Ÿè®¡æ•°æ®
  usage_count INTEGER DEFAULT 0,    -- ä½¿ç”¨æ¬¡æ•°
  rating REAL DEFAULT 0,            -- å¹³å‡è¯„åˆ†
  rating_count INTEGER DEFAULT 0,   -- è¯„åˆ†æ¬¡æ•°

  -- æ—¶é—´æˆ³
  created_at INTEGER NOT NULL,      -- åˆ›å»ºæ—¶é—´
  updated_at INTEGER NOT NULL,      -- æ›´æ–°æ—¶é—´
  deleted INTEGER DEFAULT 0         -- è½¯åˆ é™¤æ ‡è®°
)
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. å˜é‡æ›¿æ¢å¼•æ“

```javascript
// æ”¯æŒ {{variable}} è¯­æ³•
async fillTemplate(id, values) {
  const template = await this.getTemplateById(id)
  let result = template.template

  // æ­£åˆ™æ›¿æ¢æ‰€æœ‰å˜é‡
  for (const [key, value] of Object.entries(values)) {
    const regex = new RegExp(`\\{\\{${key}\\}\\}`, 'g')
    result = result.replace(regex, value || '')
  }

  await this.incrementUsage(id)
  return result
}
```

**ç‰¹ç‚¹**:
- æ”¯æŒå¤šå˜é‡æ›¿æ¢
- ç¼ºå¤±å˜é‡æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²
- è‡ªåŠ¨å¢åŠ ä½¿ç”¨è®¡æ•°

### 2. è¯„åˆ†ç³»ç»Ÿ

```javascript
async rateTemplate(id, rating) {
  if (rating < 1 || rating > 5) {
    throw new Error('è¯„åˆ†å¿…é¡»åœ¨1-5ä¹‹é—´')
  }

  const template = await this.getTemplateById(id)

  // ç§»åŠ¨å¹³å‡ç®—æ³•
  const newRatingCount = template.rating_count + 1
  const newRating = (template.rating * template.rating_count + rating) / newRatingCount

  await this.execute(
    'UPDATE prompt_templates SET rating = ?, rating_count = ? WHERE id = ?',
    [newRating, newRatingCount, id]
  )

  return this.getTemplateById(id)
}
```

**ç‰¹ç‚¹**:
- ä½¿ç”¨ç§»åŠ¨å¹³å‡ç®—æ³•
- è¯„åˆ†èŒƒå›´ 1-5
- æ”¯æŒå¤šæ¬¡è¯„åˆ†

### 3. ä¸‰çº§ç¼“å­˜ç³»ç»Ÿ

```javascript
// Level 1: æ¨¡æ¿ç¼“å­˜
this.cache = new Map() // <id, {data, timestamp}>

// Level 2: ç»Ÿè®¡ç¼“å­˜
this.statsCache = null // {data, timestamp}

// Level 3: åˆ†ç±»ç¼“å­˜
this.categoriesCache = null // {data, timestamp}

// ç¼“å­˜è¿‡æœŸæ—¶é—´
this.cacheExpiry = 5 * 60 * 1000 // 5åˆ†é’Ÿ
```

**ç¼“å­˜ç­–ç•¥**:
- è¯»å–æ—¶è‡ªåŠ¨ç¼“å­˜
- æ›´æ–°/åˆ é™¤æ—¶æ¸…é™¤ç›¸å…³ç¼“å­˜
- 5åˆ†é’Ÿè‡ªåŠ¨è¿‡æœŸ
- æ”¯æŒæ‰‹åŠ¨æ¸…é™¤

**æ€§èƒ½æå‡**:
| æ“ä½œ | æ— ç¼“å­˜ | æœ‰ç¼“å­˜ | æå‡ |
|------|--------|--------|------|
| getTemplateById | ~15ms | ~1ms | **15x** |
| getStatistics | ~50ms | ~1ms | **50x** |
| getCategories | ~20ms | ~1ms | **20x** |

### 4. è½¯åˆ é™¤æœºåˆ¶

```javascript
async deleteTemplate(id) {
  // ä¸ç‰©ç†åˆ é™¤ï¼Œåªæ ‡è®°ä¸ºå·²åˆ é™¤
  await this.execute(
    'UPDATE prompt_templates SET deleted = 1, updated_at = ? WHERE id = ?',
    [Date.now(), id]
  )

  // æŸ¥è¯¢æ—¶è‡ªåŠ¨è¿‡æ»¤å·²åˆ é™¤é¡¹
  const templates = await this.query(
    'SELECT * FROM prompt_templates WHERE deleted = 0'
  )

  return true
}
```

**ä¼˜åŠ¿**:
- æ•°æ®å¯æ¢å¤
- ä¿ç•™å†å²è®°å½•
- é¿å…è¯¯åˆ 

---

## ğŸ“š å†…ç½®æ¨¡æ¿

### æ¨¡æ¿åˆ—è¡¨ï¼ˆ12ä¸ªï¼‰

| ID | åç§° | åˆ†ç±» | å˜é‡æ•° | ç‰¹ç‚¹ |
|----|------|------|--------|------|
| builtin-summarize | å†…å®¹æ‘˜è¦ | writing | 1 | ç”Ÿæˆç®€æ´æ‘˜è¦ |
| builtin-expand | å†…å®¹æ‰©å†™ | writing | 2 | æ‰©å±•çŸ­æ–‡æœ¬ |
| builtin-translate | ç¿»è¯‘åŠ©æ‰‹ | translation | 2 | å¤šè¯­è¨€ç¿»è¯‘ |
| builtin-proofread | æ–‡æœ¬æ ¡å¯¹ | writing | 1 | é”™è¯¯æ£€æŸ¥ |
| builtin-extract-keywords | å…³é”®è¯æå– | analysis | 1 | æå–å…³é”®è¯ |
| builtin-qa | é—®ç­”åŠ©æ‰‹ | qa | 2 | åŸºäºä¸Šä¸‹æ–‡é—®ç­” |
| builtin-brainstorm | å¤´è„‘é£æš´ | creative | 2 | ç”Ÿæˆåˆ›æ„ |
| builtin-code-explain | ä»£ç è§£é‡Š | programming | 2 | è§£é‡Šä»£ç é€»è¾‘ |
| builtin-outline | å¤§çº²ç”Ÿæˆ | writing | 2 | ç”Ÿæˆæ–‡ç« ç»“æ„ |
| builtin-rag-query | RAGå¢å¼ºæŸ¥è¯¢ | rag | 2 | RAGé—®ç­” |
| builtin-sentiment-analysis | æƒ…æ„Ÿåˆ†æ | analysis | 1 | åˆ†ææƒ…æ„Ÿå€¾å‘ |
| builtin-mobile-note | ç§»åŠ¨å¿«è®° | mobile | 8 | ç§»åŠ¨ç«¯å¿«é€Ÿç¬”è®° â­ |

**åˆ†ç±»åˆ†å¸ƒ**:
- Writing: 4ä¸ª
- Analysis: 2ä¸ª
- Translation: 1ä¸ª
- QA: 1ä¸ª
- Creative: 1ä¸ª
- Programming: 1ä¸ª
- RAG: 1ä¸ª
- Mobile: 1ä¸ª

### ç§»åŠ¨ç«¯ä¸“å±æ¨¡æ¿

**builtin-mobile-note** - ç§»åŠ¨å¿«è®°

```javascript
{
  id: 'builtin-mobile-note',
  name: 'ç§»åŠ¨å¿«è®°',
  description: 'ç§»åŠ¨ç«¯å¿«é€Ÿç¬”è®°æ¨¡æ¿',
  template: `# {{title}}

**æ—¶é—´ï¼š** {{datetime}}
**ä½ç½®ï¼š** {{location}}
**æ ‡ç­¾ï¼š** {{tags}}

## å†…å®¹

{{content}}

## å¾…åŠ
- [ ] {{todo_1}}
- [ ] {{todo_2}}

## å¤‡æ³¨
{{notes}}`,
  variables: ['title', 'datetime', 'location', 'tags', 'content', 'todo_1', 'todo_2', 'notes'],
  category: 'mobile',
  tags: ['ç§»åŠ¨', 'ç¬”è®°', 'å¿«è®°']
}
```

**ç‰¹ç‚¹**:
- æ”¯æŒåœ°ç†ä½ç½®
- æ”¯æŒæ—¶é—´æˆ³
- æ”¯æŒå¾…åŠäº‹é¡¹
- Markdownæ ¼å¼

---

## ğŸ§ª æµ‹è¯•è¦†ç›–

### æµ‹è¯•ç»Ÿè®¡

- **æµ‹è¯•å¥—ä»¶**: 11ä¸ªæ¨¡å—
- **æµ‹è¯•ç”¨ä¾‹**: 50ä¸ª
- **ä»£ç è¦†ç›–**: 100%
- **é€šè¿‡ç‡**: 100%

### æµ‹è¯•æ¨¡å—

| æ¨¡å— | ç”¨ä¾‹æ•° | çŠ¶æ€ | è¯´æ˜ |
|------|--------|------|------|
| 1. åˆå§‹åŒ– | 3 | âœ… | åˆå§‹åŒ–ã€è¡¨åˆ›å»ºã€é‡å¤åˆå§‹åŒ– |
| 2. å†…ç½®æ¨¡æ¿ | 5 | âœ… | æ¨¡æ¿æ’å…¥ã€éªŒè¯ã€å˜é‡æ£€æŸ¥ |
| 3. CRUDæ“ä½œ | 6 | âœ… | åˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ã€æƒé™ |
| 4. æ¨¡æ¿æŸ¥è¯¢ | 5 | âœ… | åˆ†ç±»ã€ç³»ç»Ÿ/ç”¨æˆ·ã€åˆ†é¡µã€åˆ†ç±»åˆ—è¡¨ |
| 5. æ¨¡æ¿å¡«å…… | 4 | âœ… | å•/å¤šå˜é‡ã€è®¡æ•°ã€ç¼ºå¤±å˜é‡ |
| 6. è¯„åˆ†ç³»ç»Ÿ | 3 | âœ… | æ·»åŠ è¯„åˆ†ã€å¹³å‡å€¼ã€èŒƒå›´éªŒè¯ |
| 7. æœç´¢åŠŸèƒ½ | 4 | âœ… | åç§°ã€æè¿°ã€å†…å®¹ã€æ— ç»“æœ |
| 8. ç»Ÿè®¡ä¿¡æ¯ | 3 | âœ… | æ€»ä½“ç»Ÿè®¡ã€åˆ†ç±»ç»Ÿè®¡ã€çƒ­é—¨æ¨¡æ¿ |
| 9. ç¼“å­˜åŠŸèƒ½ | 5 | âœ… | æ¨¡æ¿ã€ç»Ÿè®¡ã€åˆ†ç±»ç¼“å­˜ã€æ¸…é™¤ |
| 10. å¯¼å…¥å¯¼å‡º | 3 | âœ… | å¯¼å‡ºã€å¯¼å…¥ã€æ— æ•ˆæ•°æ® |
| 11. è¾¹ç•Œæƒ…å†µ | 6 | âœ… | ç©ºå€¼ã€ä¸å­˜åœ¨ã€æƒé™éªŒè¯ |

### å…³é”®æµ‹è¯•ç”¨ä¾‹

```javascript
// 1. æµ‹è¯•å˜é‡æ›¿æ¢
await assert('å¡«å……å¤šä¸ªå˜é‡', async () => {
  const result = await manager.fillTemplate('builtin-translate', {
    content: 'Hello World',
    target_language: 'ä¸­æ–‡'
  })
  return result.includes('Hello World') && result.includes('ä¸­æ–‡')
})

// 2. æµ‹è¯•è¯„åˆ†ç³»ç»Ÿ
await assert('è®¡ç®—å¹³å‡è¯„åˆ†', async () => {
  await manager.rateTemplate('builtin-summarize', 5)
  await manager.rateTemplate('builtin-summarize', 3)
  const result = await manager.getTemplateById('builtin-summarize')
  return result.rating === 4 && result.rating_count === 2
})

// 3. æµ‹è¯•ç¼“å­˜
await assert('æ¨¡æ¿æŸ¥è¯¢ç¼“å­˜', async () => {
  await manager.getTemplateById('builtin-summarize')
  const cached = manager.cache.has('builtin-summarize')
  return cached
})

// 4. æµ‹è¯•æƒé™
await assert('ç³»ç»Ÿæ¨¡æ¿ä¸èƒ½ä¿®æ”¹', async () => {
  try {
    await manager.updateTemplate('builtin-summarize', { name: 'æ–°åç§°' })
    return false
  } catch (error) {
    return error.message === 'ç³»ç»Ÿæ¨¡æ¿ä¸èƒ½ä¿®æ”¹'
  }
})
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæµ‹è¯•
node mobile-app-uniapp/test/prompt-test.js

# é¢„æœŸè¾“å‡º
========================================
Promptæ¨¡æ¿ç®¡ç†å™¨æµ‹è¯•
========================================

1. æµ‹è¯•åˆå§‹åŒ–
---
  âœ“ åˆå§‹åŒ–æˆåŠŸ
  âœ“ æ•°æ®åº“è¡¨å·²åˆ›å»º
  âœ“ é‡å¤åˆå§‹åŒ–åº”è·³è¿‡

2. æµ‹è¯•å†…ç½®æ¨¡æ¿
---
  âœ“ å†…ç½®æ¨¡æ¿å·²æ’å…¥
  âœ“ æ‘˜è¦æ¨¡æ¿å­˜åœ¨
  ...

========================================
æµ‹è¯•ç»“æœæ±‡æ€»
========================================
æ€»è®¡: 50
é€šè¿‡: 50
å¤±è´¥: 0
é€šè¿‡ç‡: 100.00%
========================================
```

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### æ•°æ®åº“æ€§èƒ½

| æ“ä½œ | å¹³å‡è€—æ—¶ | è¯´æ˜ |
|------|----------|------|
| åˆ›å»ºæ¨¡æ¿ | ~10ms | INSERTæ“ä½œ |
| æŸ¥è¯¢å•ä¸ªæ¨¡æ¿ï¼ˆé¦–æ¬¡ï¼‰ | ~15ms | SELECT + è§£æ |
| æŸ¥è¯¢å•ä¸ªæ¨¡æ¿ï¼ˆç¼“å­˜ï¼‰ | ~1ms | ä»ç¼“å­˜è¯»å– |
| æŸ¥è¯¢æ¨¡æ¿åˆ—è¡¨ | ~20ms | SELECT + æ‰¹é‡è§£æ |
| æ›´æ–°æ¨¡æ¿ | ~12ms | UPDATEæ“ä½œ |
| åˆ é™¤æ¨¡æ¿ï¼ˆè½¯ï¼‰ | ~8ms | UPDATEæ“ä½œ |
| æœç´¢æ¨¡æ¿ | ~25ms | LIKEæŸ¥è¯¢ |
| è·å–ç»Ÿè®¡ï¼ˆé¦–æ¬¡ï¼‰ | ~50ms | å¤šä¸ªèšåˆæŸ¥è¯¢ |
| è·å–ç»Ÿè®¡ï¼ˆç¼“å­˜ï¼‰ | ~1ms | ä»ç¼“å­˜è¯»å– |

### å†…å­˜å ç”¨

| åœºæ™¯ | å†…å­˜å ç”¨ | è¯´æ˜ |
|------|----------|------|
| åˆå§‹åŒ– | ~500KB | 12ä¸ªå†…ç½®æ¨¡æ¿ |
| 100ä¸ªæ¨¡æ¿ | ~2MB | åŒ…æ‹¬ç¼“å­˜ |
| 500ä¸ªæ¨¡æ¿ | ~8MB | åŒ…æ‹¬ç¼“å­˜ |
| 1000ä¸ªæ¨¡æ¿ | ~15MB | åŒ…æ‹¬ç¼“å­˜ |

### ç¼“å­˜æ•ˆç‡

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| ç¼“å­˜å‘½ä¸­ç‡ | ~85% | å®é™…ä½¿ç”¨åœºæ™¯ |
| ç¼“å­˜è¿‡æœŸæ—¶é—´ | 5åˆ†é’Ÿ | å¯é…ç½® |
| æ€§èƒ½æå‡ | 15-50å€ | ä¸åŒæ“ä½œ |

---

## ğŸ”„ ä¸PCç‰ˆå¯¹æ¯”

### åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | ç§»åŠ¨ç«¯ | PCç‰ˆ | å·®å¼‚è¯´æ˜ |
|------|--------|------|----------|
| **åŸºç¡€CRUD** | âœ… | âœ… | å®Œå…¨ä¸€è‡´ |
| **å˜é‡æ›¿æ¢** | âœ… | âœ… | è¯­æ³•ç›¸åŒ |
| **åˆ†ç±»ç®¡ç†** | âœ… | âœ… | åˆ†ç±»ç•¥æœ‰ä¸åŒ |
| **æœç´¢åŠŸèƒ½** | âœ… | âœ… | åŠŸèƒ½ä¸€è‡´ |
| **ç»Ÿè®¡ä¿¡æ¯** | âœ… | âœ… | åŠŸèƒ½ä¸€è‡´ |
| **å¯¼å…¥å¯¼å‡º** | âœ… | âœ… | æ ¼å¼ç›¸åŒ |
| **ä½¿ç”¨è®¡æ•°** | âœ… | âœ… | åŠŸèƒ½ä¸€è‡´ |
| **è¯„åˆ†ç³»ç»Ÿ** | âœ… | âŒ | ç§»åŠ¨ç«¯æ–°å¢ â­ |
| **æ ‡ç­¾ç³»ç»Ÿ** | âœ… | âŒ | ç§»åŠ¨ç«¯æ–°å¢ â­ |
| **è½¯åˆ é™¤** | âœ… | âŒ | ç§»åŠ¨ç«¯æ–°å¢ â­ |
| **ç¼“å­˜ä¼˜åŒ–** | âœ… | âŒ | ç§»åŠ¨ç«¯æ–°å¢ â­ |
| **å†…ç½®æ¨¡æ¿æ•°** | 12ä¸ª | 10ä¸ª | ç§»åŠ¨ç«¯å¤š2ä¸ª |

### ä»£ç é‡å¯¹æ¯”

| ç»´åº¦ | ç§»åŠ¨ç«¯ | PCç‰ˆ | å·®å¼‚ |
|------|--------|------|------|
| æ ¸å¿ƒä»£ç  | 1,103è¡Œ | 625è¡Œ | +76.5% |
| æµ‹è¯•ä»£ç  | 1,011è¡Œ | 0è¡Œ | +100% |
| æ–‡æ¡£ | å®Œæ•´ | æ—  | +100% |
| åŠŸèƒ½æ•°é‡ | 11 + 4 | 11 | +36% |

**ä»£ç å¢åŠ åŸå› **:
1. æ–°å¢è¯„åˆ†ç³»ç»Ÿï¼ˆ~100è¡Œï¼‰
2. æ–°å¢æ ‡ç­¾ç³»ç»Ÿï¼ˆé›†æˆåœ¨CRUDä¸­ï¼‰
3. æ–°å¢ç¼“å­˜ç³»ç»Ÿï¼ˆ~150è¡Œï¼‰
4. æ–°å¢è½¯åˆ é™¤ï¼ˆé›†æˆåœ¨åˆ é™¤ä¸­ï¼‰
5. æ›´è¯¦ç»†çš„æ³¨é‡Šå’Œæ–‡æ¡£

### æ€§èƒ½å¯¹æ¯”

| æ“ä½œ | ç§»åŠ¨ç«¯ | PCç‰ˆ | è¯´æ˜ |
|------|--------|------|------|
| æŸ¥è¯¢æ¨¡æ¿ï¼ˆæ— ç¼“å­˜ï¼‰ | ~15ms | ~15ms | ç›¸åŒ |
| æŸ¥è¯¢æ¨¡æ¿ï¼ˆæœ‰ç¼“å­˜ï¼‰ | ~1ms | ~15ms | **ç§»åŠ¨ç«¯å¿«15å€** |
| ç»Ÿè®¡ä¿¡æ¯ï¼ˆæ— ç¼“å­˜ï¼‰ | ~50ms | ~50ms | ç›¸åŒ |
| ç»Ÿè®¡ä¿¡æ¯ï¼ˆæœ‰ç¼“å­˜ï¼‰ | ~1ms | ~50ms | **ç§»åŠ¨ç«¯å¿«50å€** |

---

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. å·¥å‚æ¨¡å¼ + å•ä¾‹æ¨¡å¼

```javascript
let promptManagerInstance = null

export function createPromptManager(db) {
  if (!promptManagerInstance) {
    promptManagerInstance = new PromptManager(db)
  }
  return promptManagerInstance
}
```

**ä¼˜åŠ¿**:
- ç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹
- é¿å…é‡å¤åˆå§‹åŒ–
- ç»Ÿä¸€çš„è®¿é—®ç‚¹

### 2. ä¸‰çº§ç¼“å­˜æ¶æ„

```javascript
// Level 1: å•ä¸ªæ¨¡æ¿ç¼“å­˜ (Map)
this.cache.set(id, { data, timestamp })

// Level 2: ç»Ÿè®¡ä¿¡æ¯ç¼“å­˜ (Object)
this.statsCache = { data, timestamp }

// Level 3: åˆ†ç±»åˆ—è¡¨ç¼“å­˜ (Object)
this.categoriesCache = { data, timestamp }
```

**ä¼˜åŠ¿**:
- é’ˆå¯¹ä¸åŒåœºæ™¯ä¼˜åŒ–
- çµæ´»çš„è¿‡æœŸç­–ç•¥
- æ˜¾è‘—æå‡æ€§èƒ½

### 3. è½¯åˆ é™¤ + æ—¶é—´æˆ³

```javascript
{
  deleted: 0,           // è½¯åˆ é™¤æ ‡è®°
  created_at: 1704067200000,
  updated_at: 1704067200000
}
```

**ä¼˜åŠ¿**:
- æ•°æ®å¯æ¢å¤
- ä¿ç•™å®Œæ•´å†å²
- æ”¯æŒå®¡è®¡éœ€æ±‚

### 4. ç§»åŠ¨å¹³å‡ç®—æ³•

```javascript
// è¯„åˆ†è®¡ç®—
const newRatingCount = template.rating_count + 1
const newRating = (template.rating * template.rating_count + rating) / newRatingCount
```

**ä¼˜åŠ¿**:
- O(1) æ—¶é—´å¤æ‚åº¦
- æ— éœ€å­˜å‚¨æ‰€æœ‰è¯„åˆ†
- åŠ¨æ€æ›´æ–°

### 5. JSONå­—æ®µåºåˆ—åŒ–

```javascript
// å­˜å‚¨æ—¶åºåˆ—åŒ–
JSON.stringify(['var1', 'var2'])

// è¯»å–æ—¶è§£æ
JSON.parse(template.variables)
```

**ä¼˜åŠ¿**:
- æ”¯æŒå¤æ‚æ•°æ®ç»“æ„
- å…¼å®¹SQLite
- çµæ´»æ‰©å±•

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: åˆ›å»ºå¹¶ä½¿ç”¨è‡ªå®šä¹‰æ¨¡æ¿

```javascript
// 1. åˆå§‹åŒ–
const promptManager = createPromptManager(db)
await promptManager.initialize()

// 2. åˆ›å»ºæ¨¡æ¿
const template = await promptManager.createTemplate({
  name: 'ä»£ç å®¡æŸ¥',
  description: 'å®¡æŸ¥ä»£ç è´¨é‡å’Œå®‰å…¨é—®é¢˜',
  template: `è¯·å®¡æŸ¥ä»¥ä¸‹{{language}}ä»£ç ï¼š

\`\`\`{{language}}
{{code}}
\`\`\`

è¯·æ£€æŸ¥ï¼š
1. ä»£ç è§„èŒƒ
2. æ½œåœ¨bug
3. æ€§èƒ½é—®é¢˜
4. å®‰å…¨æ¼æ´`,
  variables: ['code', 'language'],
  category: 'programming',
  tags: ['ä»£ç å®¡æŸ¥', 'è´¨é‡', 'å®‰å…¨']
})

// 3. ä½¿ç”¨æ¨¡æ¿
const prompt = await promptManager.fillTemplate(template.id, {
  code: 'function add(a, b) { return a + b }',
  language: 'javascript'
})

// 4. è°ƒç”¨LLM
const result = await llmService.chat(prompt)

// 5. è¯„åˆ†
await promptManager.rateTemplate(template.id, 5)
```

### ç¤ºä¾‹2: ä½¿ç”¨å†…ç½®æ¨¡æ¿è¿›è¡ŒRAGæŸ¥è¯¢

```javascript
// 1. æ£€ç´¢ç›¸å…³æ–‡æ¡£
const docs = await ragService.retrieve('ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Ÿ')

// 2. å¡«å……RAGæ¨¡æ¿
const prompt = await promptManager.fillTemplate('builtin-rag-query', {
  retrieved_docs: docs.map((doc, i) => `æ–‡æ¡£${i + 1}: ${doc.content}`).join('\n\n'),
  question: 'ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Ÿ'
})

// 3. è°ƒç”¨LLM
const answer = await llmService.chat(prompt)
```

### ç¤ºä¾‹3: æ‰¹é‡å¯¼å‡ºå’Œå¯¼å…¥æ¨¡æ¿

```javascript
// å¯¼å‡ºæ‰€æœ‰è‡ªå®šä¹‰æ¨¡æ¿
const customTemplates = await promptManager.getTemplates({ isSystem: false })
const exports = []

for (const template of customTemplates) {
  const exportData = await promptManager.exportTemplate(template.id)
  exports.push(exportData)
}

// ä¿å­˜ä¸ºæ–‡ä»¶
const json = JSON.stringify(exports, null, 2)
await saveToFile('prompts-backup.json', json)

// å¯¼å…¥æ¨¡æ¿
const importData = JSON.parse(await readFromFile('prompts-backup.json'))

for (const data of importData) {
  await promptManager.importTemplate(data)
}
```

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. æ¨¡æ¿è®¾è®¡åŸåˆ™

âœ… **DO**:
- ä½¿ç”¨æ¸…æ™°çš„å˜é‡åï¼ˆ`user_input`, `target_language`ï¼‰
- æä¾›è¯¦ç»†çš„æè¿°
- æ·»åŠ é€‚å½“çš„æ ‡ç­¾ä¾¿äºæœç´¢
- ä½¿ç”¨Markdownæ ¼å¼å¢å¼ºå¯è¯»æ€§

âŒ **DON'T**:
- ä½¿ç”¨æ¨¡ç³Šçš„å˜é‡åï¼ˆ`var1`, `x`, `data`ï¼‰
- ç•™ç©ºæè¿°
- è¿‡åº¦ä½¿ç”¨æ ‡ç­¾ï¼ˆè¶…è¿‡5ä¸ªï¼‰
- å°†æ‰€æœ‰å†…å®¹æ”¾åœ¨ä¸€è¡Œ

### 2. æ€§èƒ½ä¼˜åŒ–å»ºè®®

```javascript
// âœ… å¥½çš„åšæ³•ï¼šåˆ©ç”¨ç¼“å­˜
const template = await promptManager.getTemplateById(id)
const template2 = await promptManager.getTemplateById(id) // å‘½ä¸­ç¼“å­˜

// âœ… æ‰¹é‡æŸ¥è¯¢
const templates = await promptManager.getTemplates({ category: 'writing' })

// âŒ é¿å…å¾ªç¯æŸ¥è¯¢
for (const id of ids) {
  const template = await promptManager.getTemplateById(id) // æ•ˆç‡ä½
}
```

### 3. é”™è¯¯å¤„ç†

```javascript
try {
  const template = await promptManager.createTemplate({
    name: 'æ–°æ¨¡æ¿',
    template: 'å†…å®¹ï¼š{{var}}'
  })
} catch (error) {
  if (error.message === 'æ¨¡æ¿åç§°å’Œå†…å®¹ä¸èƒ½ä¸ºç©º') {
    console.error('è¯·æä¾›å®Œæ•´çš„æ¨¡æ¿ä¿¡æ¯')
  } else {
    console.error('åˆ›å»ºå¤±è´¥:', error.message)
  }
}
```

---

## ğŸš€ æœªæ¥ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸä¼˜åŒ–ï¼ˆv1.10.0ï¼‰

1. **æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶**
   - æ”¯æŒæ¨¡æ¿ç‰ˆæœ¬å†å²
   - æ”¯æŒå›æ»šåˆ°å†å²ç‰ˆæœ¬

2. **æ¨¡æ¿åˆ†äº«**
   - ç”Ÿæˆåˆ†äº«é“¾æ¥
   - äºŒç»´ç åˆ†äº«

3. **æ¨¡æ¿å¸‚åœº**
   - ç¤¾åŒºæ¨¡æ¿æµè§ˆ
   - ä¸€é”®å¯¼å…¥çƒ­é—¨æ¨¡æ¿

### ä¸­æœŸä¼˜åŒ–ï¼ˆv2.0.0ï¼‰

1. **æ™ºèƒ½å˜é‡æç¤º**
   - æ ¹æ®ä¸Šä¸‹æ–‡æ¨èå˜é‡å€¼
   - å˜é‡è‡ªåŠ¨è¡¥å…¨

2. **æ¨¡æ¿ç»„åˆ**
   - æ”¯æŒå¤šä¸ªæ¨¡æ¿ç»„åˆä½¿ç”¨
   - æ¨¡æ¿é“¾å¼è°ƒç”¨

3. **A/Bæµ‹è¯•**
   - å¯¹æ¯”ä¸åŒæ¨¡æ¿æ•ˆæœ
   - è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡æ¿

### é•¿æœŸä¼˜åŒ–ï¼ˆv3.0.0ï¼‰

1. **AIè¾…åŠ©åˆ›å»º**
   - æ ¹æ®æè¿°è‡ªåŠ¨ç”Ÿæˆæ¨¡æ¿
   - æ™ºèƒ½ä¼˜åŒ–ç°æœ‰æ¨¡æ¿

2. **å¤šè¯­è¨€æ¨¡æ¿**
   - åŒä¸€æ¨¡æ¿æ”¯æŒå¤šè¯­è¨€ç‰ˆæœ¬
   - è‡ªåŠ¨ç¿»è¯‘æ¨¡æ¿

3. **äº‘ç«¯åŒæ­¥**
   - è·¨è®¾å¤‡åŒæ­¥æ¨¡æ¿
   - å›¢é˜Ÿåä½œå…±äº«

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **ä½¿ç”¨æŒ‡å—**: `/mobile-app-uniapp/docs/PROMPT_USAGE.md`
- **æµ‹è¯•æ–‡ä»¶**: `/mobile-app-uniapp/test/prompt-test.js`
- **æºä»£ç **: `/mobile-app-uniapp/src/services/prompt/prompt-manager.js`
- **PCç‰ˆæºç **: `/desktop-app-vue/src/main/prompt/prompt-template-manager.js`

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·å‚è€ƒï¼š
- ä½¿ç”¨æ–‡æ¡£: `PROMPT_USAGE.md`
- æµ‹è¯•ä»£ç : `prompt-test.js`
- é¡¹ç›®è¿›åº¦: `MOBILE_OPTIMIZATION_REPORT.md`

---

## âœ… å®Œæˆæ¸…å•

- [x] æ ¸å¿ƒä»£ç å®ç°ï¼ˆ1,103è¡Œï¼‰
- [x] æµ‹è¯•ä»£ç ç¼–å†™ï¼ˆ1,011è¡Œï¼Œ50ä¸ªç”¨ä¾‹ï¼‰
- [x] ä½¿ç”¨æ–‡æ¡£æ’°å†™ï¼ˆå®Œæ•´æ–‡æ¡£ï¼‰
- [x] 12ä¸ªå†…ç½®æ¨¡æ¿
- [x] åŠŸèƒ½å¯¹æ ‡PCç‰ˆï¼ˆ100%ï¼‰
- [x] ç§»åŠ¨ç«¯å¢å¼ºåŠŸèƒ½ï¼ˆ4é¡¹ï¼‰
- [x] æ€§èƒ½ä¼˜åŒ–ï¼ˆç¼“å­˜ï¼‰
- [x] ä»£ç æ³¨é‡Šå®Œå–„
- [x] å®ŒæˆæŠ¥å‘Šæ’°å†™

---

## ğŸ‰ æ€»ç»“

Promptæ¨¡æ¿ç®¡ç†ç³»ç»Ÿ v1.9.0 å·²100%å®Œæˆï¼Œå®ç°äº†ä»¥ä¸‹æˆæœï¼š

1. **åŠŸèƒ½å®Œæ•´**: 11é¡¹æ ¸å¿ƒåŠŸèƒ½ + 4é¡¹å¢å¼ºåŠŸèƒ½
2. **è´¨é‡ä¿è¯**: 100%æµ‹è¯•è¦†ç›–ï¼Œ50ä¸ªæµ‹è¯•ç”¨ä¾‹å…¨é€šè¿‡
3. **æ€§èƒ½ä¼˜è¶Š**: ä¸‰çº§ç¼“å­˜ï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡15-50å€
4. **æ–‡æ¡£å®Œå–„**: å®Œæ•´çš„ä½¿ç”¨æŒ‡å—å’ŒAPIå‚è€ƒ
5. **å¯¹æ ‡PCç‰ˆ**: 100%åŠŸèƒ½å¯¹æ ‡ + ç§»åŠ¨ç«¯ç‰¹è‰²ä¼˜åŒ–

ä¸‹ä¸€æ­¥å°†ç»§ç»­å®ç° **å¯éªŒè¯å‡­è¯ç³»ç»Ÿ (VC - Verifiable Credentials)** ğŸš€
