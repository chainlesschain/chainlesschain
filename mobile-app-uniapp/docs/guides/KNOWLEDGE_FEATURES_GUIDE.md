# 移动端知识库功能使用指南

## 🎯 新功能概览

本次更新为移动端知识库模块带来了以下重要功能:

1. ✅ **Markdown渲染** - 支持完整的Markdown语法和代码高亮
2. ✅ **图片预览** - 点击图片全屏查看,支持多图浏览
3. ✅ **Markdown工具栏** - 16种快捷操作,提升编辑效率
4. ✅ **实时预览** - 编辑/预览模式一键切换
5. ✅ **图片上传** - 支持相册和相机,自动插入Markdown
6. ✅ **自动保存草稿** - 3秒防抖保存,7天自动过期

---

## 📱 功能使用说明

### 1. 查看知识详情

**路径**: 知识库列表 → 点击条目 → 详情页

**功能特性**:
- Markdown格式自动渲染
- 代码块语法高亮
- 点击图片全屏预览
- 点击链接跳转或打开

**支持的Markdown语法**:
```markdown
# 标题1
## 标题2
### 标题3

**粗体** *斜体* ~~删除线~~

`行内代码`

\`\`\`javascript
// 代码块
console.log('Hello World')
\`\`\`

> 引用块

- 无序列表
1. 有序列表

[链接](https://example.com)
![图片](image.jpg)

| 表格 | 列1 | 列2 |
|------|-----|-----|
| 行1  | 数据 | 数据 |
```

---

### 2. 编辑知识

**路径**: 详情页 → 编辑按钮 / 知识库列表 → 新建按钮

#### 2.1 使用Markdown工具栏

工具栏提供16种快捷操作:

| 按钮 | 功能 | 快捷语法 |
|------|------|----------|
| H1/H2/H3 | 标题 | `# ` `## ` `### ` |
| B | 粗体 | `**文本**` |
| I | 斜体 | `*文本*` |
| S | 删除线 | `~~文本~~` |
| </> | 行内代码 | `` `代码` `` |
| { } | 代码块 | ` ```\n代码\n``` ` |
| ❝ | 引用 | `> ` |
| • | 无序列表 | `- ` |
| 1. | 有序列表 | `1. ` |
| ☑ | 任务列表 | `- [ ] ` |
| 🔗 | 链接 | `[文本](url)` |
| 🖼 | 图片 | `![描述](url)` |
| ⊞ | 表格 | 自动生成表格模板 |
| — | 分割线 | `---` |

**使用方法**:
1. 将光标移动到要插入的位置
2. 点击工具栏对应按钮
3. Markdown语法自动插入

#### 2.2 实时预览

**切换方法**:
- 点击右上角 "👁 预览" 按钮进入预览模式
- 点击 "📝 编辑" 按钮返回编辑模式

**预览特性**:
- 与详情页一致的渲染效果
- 所见即所得
- 保持编辑状态

#### 2.3 上传图片

**方法1: 使用工具栏**
1. 点击工具栏的 "🖼 图片" 按钮
2. 选择图片来源 (相册/相机)
3. 图片自动上传并插入Markdown语法

**方法2: 手动输入**
```markdown
![图片描述](图片路径)
```

**支持的图片来源**:
- 📱 相册选择
- 📷 相机拍摄
- 🗜️ 自动压缩

**存储方式**:
- H5环境: Base64编码
- App环境: 本地文件系统

#### 2.4 自动保存草稿

**工作原理**:
- 编辑内容时自动触发保存
- 3秒防抖延迟 (避免频繁保存)
- 保存到本地存储
- 7天自动过期

**草稿恢复**:
1. 退出编辑页面 (未保存)
2. 重新进入新建页面
3. 系统提示 "发现草稿"
4. 选择 "恢复" 或 "放弃"

**草稿包含的内容**:
- 标题
- 类型
- 内容
- 文件夹
- 加密状态
- 已选标签

---

## 🎨 界面说明

### 详情页布局

```
┌─────────────────────────┐
│  标题                    │
│  [类型标签] 更新时间      │
├─────────────────────────┤
│                         │
│  Markdown渲染内容        │
│  (支持图片、代码等)       │
│                         │
├─────────────────────────┤
│  🔗 关联知识             │
│  [AI推荐] [手动添加]     │
├─────────────────────────┤
│ [📤分享] [✏️编辑] [🗑️删除]│
└─────────────────────────┘
```

### 编辑页布局

```
┌─────────────────────────┐
│  标题: [输入框]          │
│  类型: [选择器]          │
│  文件夹: [选择器]        │
│  标签: [已选标签]        │
├─────────────────────────┤
│  内容: [👁预览] [🤖AI]   │
│  ┌───────────────────┐  │
│  │ H1 H2 H3 B I ... │  │ ← 工具栏
│  └───────────────────┘  │
│  ┌───────────────────┐  │
│  │                   │  │
│  │  编辑区域/预览区域 │  │
│  │                   │  │
│  └───────────────────┘  │
├─────────────────────────┤
│  [取消]        [保存]    │
└─────────────────────────┘
```

---

## 💡 使用技巧

### 1. 快速插入代码块

**方法1**: 使用工具栏
1. 点击 "{ }" 按钮
2. 自动插入代码块模板
3. 在第一行指定语言 (如 `javascript`)

**方法2**: 手动输入
```markdown
\`\`\`javascript
console.log('Hello World')
\`\`\`
```

### 2. 创建表格

**使用工具栏**:
1. 点击 "⊞" 按钮
2. 自动生成3列2行表格模板
3. 修改表头和内容

**模板示例**:
```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 内容 | 内容 | 内容 |
| 内容 | 内容 | 内容 |
```

### 3. 插入任务列表

**使用工具栏**:
1. 点击 "☑" 按钮
2. 自动插入 `- [ ] `
3. 输入任务内容

**示例**:
```markdown
- [ ] 未完成任务
- [x] 已完成任务
```

### 4. 批量插入图片

**步骤**:
1. 多次点击 "🖼" 按钮
2. 依次选择图片
3. 每张图片自动插入

### 5. 利用草稿功能

**场景1: 临时中断**
- 正在编辑时需要离开
- 直接退出,内容自动保存
- 下次进入自动提示恢复

**场景2: 多设备编辑**
- 在手机上开始编辑
- 保存草稿
- 在平板上继续编辑 (需要同步功能)

---

## 🔧 常见问题

### Q1: 为什么图片无法显示?

**A**: 检查以下几点:
1. 图片路径是否正确
2. H5环境是否使用Base64
3. App环境是否有文件访问权限

### Q2: 代码高亮不生效?

**A**: 确保:
1. 代码块使用三个反引号包裹
2. 第一行指定语言 (如 `javascript`)
3. 语言名称正确 (支持的语言见highlight.js文档)

### Q3: 草稿为什么没有恢复?

**A**: 可能原因:
1. 草稿已过期 (超过7天)
2. 用户选择了 "放弃"
3. 本地存储被清空

### Q4: 工具栏按钮太多,如何快速找到?

**A**:
- 工具栏支持横向滑动
- 常用按钮在前面 (标题、粗体、斜体等)
- 记住常用按钮的位置

### Q5: 如何清除草稿?

**A**:
- 保存知识后自动清除
- 或在恢复提示时选择 "放弃"

---

## 📚 Markdown语法参考

### 基础语法

```markdown
# 一级标题
## 二级标题
### 三级标题

**粗体文本**
*斜体文本*
~~删除线文本~~

`行内代码`

> 引用文本
> 可以多行

- 无序列表项1
- 无序列表项2

1. 有序列表项1
2. 有序列表项2

[链接文本](https://example.com)
![图片描述](image.jpg)

---
```

### 高级语法

```markdown
\`\`\`javascript
// 代码块
function hello() {
  console.log('Hello World')
}
\`\`\`

| 表头1 | 表头2 | 表头3 |
|-------|-------|-------|
| 单元格 | 单元格 | 单元格 |

- [ ] 待办事项
- [x] 已完成事项

***粗斜体***
```

---

## 🚀 性能优化建议

### 1. 图片优化
- 上传前压缩图片
- 避免上传过大的图片 (建议<2MB)
- 使用适当的图片格式 (JPG/PNG)

### 2. 内容优化
- 避免单个知识条目过长 (建议<10000字)
- 合理使用标题分段
- 代码块不要过长

### 3. 草稿管理
- 定期清理过期草稿
- 重要内容及时保存
- 不要依赖草稿作为备份

---

## 📞 反馈与支持

如遇到问题或有改进建议:

- **GitHub Issues**: [chainlesschain/issues](https://github.com/chainlesschain/chainlesschain/issues)
- **邮箱**: support@chainlesschain.com
- **文档**: 查看 `MOBILE_ADAPTATION_PROGRESS_2026-01-12.md`

---

**版本**: v0.2.0
**更新日期**: 2026-01-12
**适用平台**: iOS / Android / H5
